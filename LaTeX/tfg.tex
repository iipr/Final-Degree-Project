\documentclass[11pt, a4paper, english, twoside, notitlepage, openright]{report}

\usepackage[a4paper, total={15cm, 22cm}]{geometry}
\usepackage{iipr}
\fancyhead[RO, LE]{ }
\fancyhead[LO]{\nouppercase \leftmark}	% Heading on odd pages: Chapter name on the left
\fancyhead[RE]{\nouppercase \rightmark} % Heading on even pages: Section on the right
\fancyfoot[LE,RO]{\thepage} % Roman numbering, foot left on even, foot right on odd pages
\fancyfoot[CE]{Double Degree in Mathematics and Computer Science} %Foot: Center, even pages
\fancyfoot[CO]{Complutense University of Madrid (UCM)} %Foot: Center, odd pages
\renewcommand{\footrulewidth}{0.4pt} % Rule on top of foot
\renewcommand{\headrulewidth}{0.4pt} % Rule below headings
\pagestyle{fancy}


\begin{document}

\pagenumbering{roman}
\begin{titlepage}

\title{\Huge{\textsc{Complexity Analysis of\\
Polynomial Algorithms}} \\
\vspace{0.5cm}
\Large{\textsc{Final Degree Project}}\\
\vspace{1.5cm}
\protect\includegraphics[scale=0.6]{escudo_ucm.pdf}
\vspace{1.5cm}}
\author{\textbf{Ignacio Iker Prado Rujas} \\
Complutense University of Madrid (UCM) \\
Double Degree in Mathematics and Computer Science}
\date{\today}
\maketitle
\thispagestyle{empty}

\vspace{1cm}
\begin{center}
\textbf{Tutors:} \\
\textbf{Juan R. Delgado, Jos\'e F. Fernando \textit{\&} Jos\'e M. Gamboa} \\
\vspace{0.1cm}
Algebra Department, Mathematics Faculty
\end{center}

\end{titlepage}

\mbox{}
\thispagestyle{empty}
\newpage	
\thispagestyle{empty}
\begin{abstract} This work is about different proofs of the same fact and a computational comparison between them, looking for the most efficient one.

Let $R$ be a real closed field and $n\geq 2$. Then: 
	
(1) For every finite subset $F$ of $R^n$, the semialgebraic set $R^n\setminus F$ is a polynomial image of $R^n$. 
	
(2) Given linearly independent linear forms $h_1,\dots,h_r$ of $R^n$, the semialgebraic set $\{h_1>0,\dots,h_r>0\}\subset R^n$ is a polynomial image of $R^n$.
	
The key result here is that $\Qu:=\{x>0,y>0\}\subset R^2$ is a polynomial image of $R^2$. This assert is proved in three different ways: a first approach using some basic results in real algebraic geometry (such as Sturm's theorem and the Curve Selection Lemma) and the aid of a computer; a second and shorter one, using the composition of three rather simple polynomial maps; and a third one that applies arguments of algebraic topology, without the aid of computer computations.

Lastly, we perform a computational comparison (using SageMath) between the three polynomial maps that are used in the previous chapters, on the search for the most efficient and the quickest one.

\vspace{0.2cm}
\textit{Keywords.} Polynomial map, polynomial image, semialgebraic set, open quadrant, complexity, optimal algebraic structure, optimal multiplicative complexity.

\vspace{0.3cm}
\begin{center}
\textbf{Resumen}
\end{center}

Este trabajo contiene distintas pruebas del mismo hecho y pretende hacer una comparaci\'on computacional entre ellas, tratando de encontrar la m\'as eficiente.

Sean $R$ un cuerpo real cerrado y $n\geq 2$. Entonces: 
	
(1) Para cada subconjunto finito $F$ de $R^n$, el conjunto semialgebraico $R^n\setminus F$ es imagen polin\'omica de $R^n$. 
	
(2) Dadas formas linealmente independientes $h_1,\dots,h_r$ de $R^n$, el conjunto semialgebraico $\{h_1>0,\dots,h_r>0\}\subset R^n$ es imagen polin\'omica de $R^n$.
	
El resultado clave aqu\'i es que $\Qu:=\{x>0,y>0\}\subset R^2$ es imagen polin\'omica de $R^2$. Esta afirmaci\'on es probada de tres maneras diferentes: una primera usando algunos resultados b\'asicos de geometr\'ia algebraica real (como son el teorema de Sturm y el Lema de Selecci\'on de Curvas) y la ayuda de un ordenador; una segunda forma m\'as breve, empleando la composici\'on de tres aplicaciones polinomiales bastante sencillas; y una tercera y \'ultima en la que se utilizan  argumentos de topolog\'ia algebraica, que evitan efectuar c\'alculos en un ordenador. 

Por \'ultimo, realizamos una comparaci\'on computacional (usando SageMath) entre las tres aplicaciones polinomiales que son utilizadas en los cap\'itulos anteriores, tratando de encontrar la m\'as eficiente y la m\'as r\'apida.

\vspace{0.2cm}
\textit{Palabras clave.} Aplicaci\'on polinomial, imagen polinomial, conjunto semialgebraico, quadrante abierto, complejidad, estructura algebraica \'optima, complejidad multiplicativa \'optima.
\end{abstract}

\tableofcontents
\thispagestyle{empty}

\listoffigures
\thispagestyle{empty}

\listoftables
\thispagestyle{empty}

\begin{chapter}{Introduction to polynomial images of $R^n$}
\pagenumbering{arabic}    % Numbering from 1

\section{General background and structure of the memoir}

Although it is usually said that the first work in Real Geometry is due to Harnack \cite{h}, who obtained an upper bound for the number of connected components of a non-singular real algebraic curve in terms of its genus, modern Real Algebraic Geometry was born with Tarski's article \cite{ta}, where it is proved that the image of a semialgebraic set under a polynomial map is a semialgebraic set. In the last decade J.F. Fernando, J.M Gamboa and C. Ueno have intensively studied  what might be called the `inverse problem'. In the 1990 \em Oberwolfach Reelle algebraische Geometrie \em week \cite{g} Gamboa proposed to characterize the subsets of $\R^m$ that are polynomial images of some $\R^n$. 

Open semialgebraic sets deserve a special attention in connection with the real Jacobian Conjecture \cite{p}. In addition it can be easily seen that they constitute a not at all trivial challenge. Observe for instance that the closed half-line $[0,+\infty)$ is the image of $\R$ under the polynmial map $f:\R\to\R, x\mapsto x^2$ but the open half-line $(0,+\infty)$ is not the image of any polynomial map $\R\to\R$, although it is the image of 
$$
f:\R^2\to\R,\, (x,y)\to (xy-1)^2+y^2.
$$ 
As open sets with piecewise linear boundary seem to be friendly it is natural to begin by studying them. Indeed it is easily seen that the open upper half-plane $\H:=\set{y>0}\subset\R^2$ is the image of the polynomial map 
$$
\R^2\to\R^2,\, (x,y)\mapsto (y(xy-1),(xy-1)^2+x^2).
$$
This examples explain why in \cite{g} the so called `open quadrant problem' was proposed, that is, to determine whether the open quadrant $\Qu:=\{x>0,y>0\}\subset\R^2$ is a polynomial image of $\R^2$.

This problem stimulated the interest of many specialists in the field. However, only after twelve years a first solution was found in \cite{fg} and presented by the first author in the 2002 \em Oberwolfach Reelle algebraische Geometrie \em week \cite{fe}.

The open quadrant problem was the germ of a more systematic study of `Polynomial images of Euclidean spaces' developed  during the last decade, and was the topic of the Ph.D. Thesis of C. Ueno \cite{u} supervised by J.F. Fernando. It is worthwhile mentioning that the work on polynomial and regular images constitutes the germ of the recent proof by Fernando of the so called ``Shiota's conjecture''. The result is the following.  \em A subset $\Ss\subset\R^n$ is the image of a Nash map $f:\R^m\to\R^n$ if and only if $\Ss$ is semialgebraic, pure dimensional of dimension $d\leq m$ and there exists an analytic path $\alpha:[0,1]\to\Ss$ whose image meets all the connected components of the set of regular points of $\Ss$\em. 

Coming back to polynomial and regular maps of euclidean spaces a lot of work has been done after the discovery that $\Qu$ is a polynomial image of $\R^2$, with two main objectives: 
\begin{itemize}
\item Finding obstructions to be an either polynomial or regular image of an euclidean space. 
\item Proving (constructively) that large families of semialgebraic sets with piecewise linear boundary (convex polyhedra, their interiors, complements and the interiors of their complements) are either polynomial or regular images of some Euclidean space. The positive answer to the open quadrant problem has been a recurrent starting point for this approach.
\end{itemize}
This is the main reason to search the ``best" polynomial map $\R^2\to\R^2$ whose image is $\Qu$. As easy such a map is, as easy they would be those polynomial or regular maps $\R^n\to\R^m$ whose image is a prescribed convex polyhedron, its interior or their complements. 

\subsection{Structure of this memoir}
This memoir is organized as follows. In this first chapter we collect some examples of polynomial images of euclidean spaces and present some obstructions to be such an image. In Chapters 2, 3 and 4 we present very detailed proofs of the main results in, respectively, \cite{fg}, \cite{fu} and \cite{fgu}. The first one has an strong computational character, the second one is purely algebraic whereas the third one involves algebraic topology arguments. It must be pointed out that concerning the proof in Chapter 2 we have complemented the use of Sturm sequences in the original work \cite{fg} by the use of Laguerre's algorithm to approximate the roots of an univariate polynomial with complex coefficients.

The most original part of the work is Chapter 5, where we compare from distinct view points the complexity of the maps presented in the precedent chapters having $\Qu$ as image. We have found two ways to compare the effectiveness of two such maps. Namely, the execution time needed to fill the quadrant, and the density in $\Qu$ of the image of a thick enough grid. To perform the corresponding computations we have used Sage. To finish we present without proof simpler maps $f:\R^2\to\R^2$ that, maybe, satisfy the equality $f(\R^2)=\Qu$. If this were so one of them would probably be the map with smallest topological degree among those having the open quadrant as image.

\begin{section}{Statement of the problem and main results}
\begin{definition}\label{polyMap} Given a \hyperref[realCField]{real closed field} $R$ and positive integers $m,n$ it is said that $f:=(f_1,\dots,f_n):R^m\to R^n$ is a \em polynomial map \em if $f_i\in R[{\tt x}_1,\dots,{\tt x}_m]$ for $i=1,\dots,n$. 
\end{definition}

An important example of real closed field (and the only one with the Archimedean property) if the field $\R$ of real numbers. There are several concepts, like the one of real closed field, that appear in the Introduction but that we do not recall until Appendix \ref{AA} in order to lighten the presentation and soften the reading.
	
A very famous theorem by Tarski and Seidenberg states the following:
\begin{theorem}[\em Tarski-Seidenberg\em]\label{tarskiSeidenberg} \em The image of every polynomial map $f: R^m \longrightarrow R^n$ is a \hyperref[semialgSet]{semialgebraic subset} of $R^n$. \em
\end{theorem}

As we have commented above, in this work we study a sort of converse of this statement proposed by  J.M. Gamboa \cite{g} in the 1990 \emph{Oberwolfach Reelle algebraische Geometrie} week:
\begin{problem}
Characterize the semialgebraic subsets of $R^n$ that are polynomial images of some $R^m$.
\end{problem}
	
We need to mention to which topology we refer to when we talk about closures, boundaries, etc. More specifically, the \em exterior boundary \em of a subset $S\subset R^n$ is $\delta S:=\overline{S}\setminus S$, with $\overline{S}$ being the \em closure \em of $S$ in the usual topology of $R^n$. In addition we will denote by $\overline{S}^{\text{zar}}$ the closure of $S$ with respect to the \hyperref[zariski]{Zariski topology} of $R^n$. We will say that a semialgebraic subset $A\subset R^n$ is \em Zariski-irreducible \em if its Zariski closure $\overline{A}^{\text{zar}}$ is an irreducible algebraic set.
	
\begin{subsection}{Necessary conditions and examples} To begin working on this idea, we provide some necessary conditions for a set $S\subset R^n$ to be a polynomial image of $R^m$. 
	
If $m=n=1$, that is, for a polynomial function $f:R\to R$, its image $f(R)$ is either a \em singleton, \em that is, a set with a unique point if the function $f$ is constant, or an unbounded closed interval. For example if $f({\tt x})={\tt x}^2$ we have $f(R)=[0,+\infty)$, and $f(R)=R$ if $f$ is a polynomial of odd degree.
	
In the general case, by \hyperref[tarskiSeidenberg]{Tarski-Seidenberg}, $S$ must be a semialgebraic set and, as $R^n$ is semialgebraically connected, $S$ is semialgebraically connected too. In addition, by the identity principle for polynomials, $S$ is Zariski-irreducible and \hyperref[pureDim]{pure dimensional}.
	
	% Añadir el teorema de Shiota y la definición de Nash map? NO
	
But to be a polynomial image of some $R^m$ is a restrictive condition, and there are more constrains than those quoted above. 
	
\begin{definition} A polynomial map $f:R^m\to R^n$ is said to be \em semialgebraically proper at a point $p\in R^n$ \em if there exists an open neighbourhood $K$ of $p$ such that the restriction $f|_{f^{-1}(K)}:f^{-1}(K)\to K$ is a \hyperref[properMap]{semialgebraically proper map}.
\end{definition}
	
\begin{definition} A \em parametric semiline \em of $R^n$ is the image of $R$ under a non-constant polynomial map $R\to R^n$.
\end{definition}
	
It is clear that every parametric semiline is semialgebraically closed, since every polynomial map from $R$ to $R^n$ is semialgebraically proper. Let $\S_f$ denote the set of points $p\in R^n$ at which $f$ is \textbf{not} semialgebraically proper.
	
\begin{theorem}[\em Jelonek\em]\label{jelonek}\em Let $f:R^2\to R^2$ be a \hyperref[dominant]{dominant} polynomial map. Then $\S_f$ is a finite union of parametric semilines.\em
\end{theorem}
	
With these ideas in mind, we present in the following proposition some obstructions for a semialgebraic set to be a polynomial image of $R^n$. 
\begin{proposition}\label{propIntro} Let $f: R^m\to R^n$ be a polynomial map and $S:=f(R^m)$.
\begin{enumerate}[\em(1)\em]
\item $\delta S \subset\S_f$.
\begin{Proof} Suppose $p\in\delta S\setminus \S_f$. Since $p\notin\S_f$, there exists an open neighbourhood $K$ of $p$ such that the restriction $f|_{f^{-1}(K)}:f^{-1}(K)\to K$ of $f$ is proper. Thus its image $K\cap S$ is a closed subset of $K$. Hence, $p\in K\cap\overline{S}=K\cap(\overline{K\cap S})=K\cap S$, which yields in a contradiction.
\end{Proof}
\item Let $m=n=2$ and $\Gamma$ be a $1$-dimensional irreducible component of $\overline{\delta S}^{\text{zar}}$. Then $\Gamma$ is the Zariski closure of a parametric semiline of $R^2$.
\begin{Proof} As $f$ is a dominant map, $\S_f$ is, by Theorem \ref{jelonek}, a finite union of parametric semilines, say $M_1,\dots, M_s$ in $R^2$. Using (1) we get: $\Gamma\subset\overline{\delta S}^{\text{zar}}\subset \overline{\S_f}^{\text{zar}}=\bigcup_{i=1}^s\overline{M_i}^{\text{zar}}$. Lastly, using that both $\Gamma$ and the $\overline{M_i}^{\text{zar}}$'s are irreducible, $\Gamma=\overline{M_i}^{\text{zar}}$ for some index $i=1,\dots,s$.
\end{Proof}
\item Let $p:R^n\to R$ be a polynomial map which is non-constant on $S$. Then $p(S)$ is unbounded.
\begin{Proof} For each $a \in R^m$ let $\varphi_a:R\to R$ defined as $\varphi_a(t):=p(f(ta))$. Then $p(S)$ would contain the image $\varphi_a(R)$ for all $a\in R^m$. Suppose now that $\varphi_a(R)$ is bounded. Then $\varphi_a(R)$ would be a point $r_a$, and given two points $a,b\in R^m$ we would have
$$ 
\varphi_a(1)=p(f(a))=r_a=\varphi_a(0)=\varphi_b(0)=r_b=p(f(b))=\varphi_b(1).
$$ 
Then $p$ would be constant on $S$, which is a contradiction.
\end{Proof}
\end{enumerate}
\end{proposition}	
\begin{corollary} Because of statement \em (3) \em in Proposition \em \ref{propIntro}, \em all linear projections of a polynomial image $S=f(R^m)$ are either a point or unbounded. Thus, $S$ is also unbounded or a point.
\end{corollary}
	
\begin{examples}\label{introExample}
\
\begin{enumerate}[(i)]
\item The exterior of the closed unit disc $S:=\set{u^2+v^2>1}\subset R^2$ \textbf{is not} a polynomial image of $R^2$. This is so because the only irreducible component of $\overline{\delta S}^{\text{zar}}$ is the circle $\set{u^2+v^2=1}\subset R^2$ and this set is not a parametric semiline because it is bounded.
			
\item Let $S_1:=\set{uv<1}\subset R^2$ and $S_2:=\set{uv>1,u>0}\subset R^2$ (see Figure \ref{fig:introExampleii}). They both \textbf{are not} polynomial images of $R^2$ since the Zariski closure of their exterior boundaries $\overline{\delta S_1}^{\text{zar}}=\overline{\delta S_2}^{\text{zar}}$ is the hyperbola $\{uv=1\}\subset R^2$, which is not a parametric semiline.
\begin{figure}[h]\hspace{0.1cm}
\begin{subfigure}{.49\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch1_01_S_1.pdf}
\caption{$S_1:=\set{uv<1}$.\label{fig:S_1}}
\end{subfigure}
\begin{subfigure}{.49\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch1_02_S_2.pdf}
\caption{$S_2:=\set{uv>1,u>0}$.\label{fig:S_2}}
\end{subfigure}\\[1ex]
\caption{Plots of the regions defined in Example \ref{introExample} (ii).\label{fig:introExampleii}}
\end{figure}
\item Let $S:=R^2\setminus\set{(0,0)}$ be the punctured plane. Then $S$ is the image of the polynomial map $(x,y) \mapsto (xy-1,(xy-1)x^2-y)$.
\item The open upper half-plane $\H:=\set{v>0}\subset R^2$ is the image of the polynomial map 
$$
R^2\to R^2,\, (x,y)\mapsto (y(xy-1),(xy-1)^2+x^2),
$$
This implies that every open half-plane is a polynomial image of $R^2$. This is probably the simplest polynomial map whose image is $\H$.
\end{enumerate}
\end{examples}
\end{subsection}
	
\begin{subsection}{Statement of the main results}
	
The main results of this chapter are generalizations of items (iii) and (iv) from Examples \ref{introExample}.
%\vspace{0.35cm}
\begin{theorem}\label{finSetTh}\em Let $n\ge2$. For every finite set $F\subset R^n$, the semialgebraic set $R^n\setminus F$ is a polynomial image of $R^n$.\em
\end{theorem}
%\vspace{0.35cm}
\begin{theorem}\label{openQuadGen}\em Let $n\ge 2$. Given independent linear forms $h_1,\dots,h_r$ of $R^n$, the open semialgebraic set $\set{h_1>0,\dots,h_r>0}$ is a polynomial image of $R^n$.\em
\end{theorem}
	
Before the paper \cite{fg} was published, the exterior boundary of all open sets that were known to be polynomial images of $R^2$ was Zariski-irreducible, and all of them were deformations of $\H$. J.M. Gamboa outlined the problem of finding if the open quadrant $\Qu:=\set{x>0,y>0}\subset R^2$ is a polynomial image of $R^2$ or not, since its exterior boundary is Zariski-reducible. The solution of this problem is a key particular case of the content of Theorem \ref{openQuadGen}. Before that, the closest known approach to look for a solution of this problem was the transformation
$$
\psi:R^2 \to R^2,\, (x,y)\mapsto(x^4y^2,x^2y^4)
$$	
whose image is $\Qu\cup\set{(0,0)}$. The answer to the first intriguing problem in this field was given in the following theorem:

\newpage
\begin{theorem}\label{openQuad}\em The first open quadrant $\Qu$ is a polynomial image of $R^2$.\em
\end{theorem}
	
\begin{remark} The first proof of Theorem \ref{openQuad} consists of two parts:
\begin{itemize}
\item Choosing a ``good'' candidate to be a polynomial map whose image is close enough to $\Qu$, and giving the reasons behind this choice (see section \ref{quadReasons}). 
	
\item Checking that the image of the map is $\Qu$ indeed. After some arguments, this can be reduced to prove the non-existence of real roots of certain polynomials in one variable on certain intervals, and to compare some rational functions on those intervals. In order to do this, we use symbolic computations with tools like Sage and Maple. Because of the high degree of the involved polynomials, the actual checking of the non-existence of roots is done with a Maple package that performs \hyperref[sturm]{Sturm algorithm} and a Python programme that implements \hyperref[laguerre] {Laguerre's method}.
\end{itemize}
\end{remark}

Let us see how Theorem \ref{openQuadGen} follows from Theorem \ref{openQuad}.
		
\vspace{1mm}		
		
[Proof of Theorem \ref{openQuadGen}] After a linear change of coordinates we can suppose that $h_1:={\tt x}_1,\dots,h_r:={\tt x}_r$, so we only have to prove that for every pair of positive integers $r\leq n$ the semialgebraic set $\{x_1>0,\dots,x_r>0\}\subset R^n$ is a polynomial image of $R^n$. This is reduced to prove the following two steps:
\begin{itemize}
\item $\H:=\{x_1>0\}\subset R^2$ and $\Qu:=\{x_1>0,\,x_2>0\}\subset R^2$ are polynomial images of $R^2$, which is true, respectively, by Example \ref{introExample} (iv) and Theorem \ref{openQuad}.
\item This implies that $\mathscr{O}:=\{x_1>0,\, x_2>0,\, x_3>0\}\subset R^3$ is a polynomial image of $R^3$. Indeed, let $f,g:R^2 \rightarrow R^2$ be polynomial maps whose respective images are $\H$ and $\Qu$. Let us define:
\begin{align*}
(f,\text{id}_R): R^3=R^2\times R&\longrightarrow R^3= R^2\times R\\
(x_1,x_2,x_3) &\longmapsto (f_1(x_1, x_2),\, f_2(x_1, x_2),\, x_3)\\
(\text{id}_R,g): R^3=R\times R^2&\longrightarrow R^3= R\times R^2\\
(x_1,x_2,x_3) &\longmapsto (x_1,\, g_1(x_2, x_3),\, g_2(x_2, x_3)).
\end{align*}
Then, $\mathscr{O}$ is the image of the polynomial map 
\begin{align*}
H:=(\text{id}_R,g)\circ(f,\text{id}_R):R^3&\longrightarrow R^3\\
(x_1,x_2,x_3) &\longmapsto (f_1(x_1, x_2),\, g_1(f_2(x_1, x_2), x_3),\, g_2(f_2(x_1, x_2), x_3)).
\end{align*}
\end{itemize} 
Once the case $n=3$ is solved the case of arbitrary $n$ follows straightforwardly, by taking $g \times \overset{k}{\cdots} \times g: R^n \longrightarrow R^n$ when $n=2k$ and $H \times g \times \overset{k-1}{\cdots} \times g: R^n \longrightarrow R^n$ when $n=2k-1$. \qed

\vspace{1mm}
		
The original proofs of Theorems \ref{finSetTh} and \ref{openQuad} are written for $R:=\R$. As for both theorems explicit polynomial maps are given, the results can be extended to arbitrary real closed field $R$ by the \hyperref[TP]{Transfer Principle}.
\end{subsection}
\end{section}

\begin{section}{Complementary set of a finite set}
	
We proceed to prove Theorem \ref{finSetTh}:
	
\vspace{1mm}
	
[Proof of Theorem \ref{finSetTh}] Let $F:=\{p_1,\dots,p_k\}$. Let us see that it suffices to prove the result for points of the form $p_j:=(a_j,\vec{0})\in\R\times\R^{n-1}$. After a linear change of coordinates we can assume that the first coordinates of the given points are pairwise distinct. 

In other words, we denote $p_j:=(a_{1j},\dots,a_{nj})$ and we may suppose that $a_{1j}\neq a_{1\ell}$ when $j\neq\ell$. Then, there exists a polynomial $P_1\in\R[{\tt t}]$ such that $P_1(a_{1j})=a_{nj}$, with $j = 1,\dots, n$, and denoting $x':=(x_1,\dots,x_{n-1})$, we  define the polynomial map 
$$
h_1:\R^n\to\R^n,\, (x',x_n)\mapsto (x',x_n+P_1(x_1)).
$$
Indeed $h_1$ is bijective. Note first that every point of $\R^n$ has a preimage in $\R^n$, namely if $x:=(x_1, \dots,x_n)$, then $z:=(x',x_n-P_1(x_1))$ satisfies $h_1(z)=x$ and $h_1$ is onto. As for being injective, let $x,y\in\R^n$ such that 
$$
h_1(x)=(x_1,\dots,x_n+ P_1(x_1))=(y_1,\dots,y_n+ P_1(y_1))=h_1(y).
$$ 
Then $x_i=y_i$ for $i=1,\dots,n-1$. Also $x_n+P_1(x_1)=y_n+P_1(y_1)$ and $P_1(x_1)=P_1(y_1)$ because $x_1= y_1$. Therefore $x_n=y_n$ and $x=y$.
		
Now, for $p_j':=(a_{1j},\dots,a_{(n-1)j},0)$ we have $h_1(p_j')=p_j$. Analogously, there exists $P_2\in\R[{\tt t}]$ such that $P_2(a_{1j}) = a_{(n-1)j}$, and define the polynomial bijection
$$
h_2:\R^n\longrightarrow \R^n,\,(x'',x_{n-1},x_n)\mapsto (x'',x_{n-1}+P_2(x_1),x_n),
$$
where $x'':=(x_1,\dots,x_{n-2})$. Then $h_2(p_j'')=p_j'$ for $p_j''= (a_{1j},\dots,a_{(n-2)j},0,0)$. In this way the polynomial bijection $h_1\circ h_2:\R^n\to\R^n$ satisfies
$$
(h_1\circ h_2)(p_j'')=h_1(h_2(p_j''))=h_1(p_j')=p_j,
$$
and we can inductively construct a polynomial bijection $h:\R^n\rightarrow\R^n$ such that $h(q_j)=p_j$ for $q_j:=(a_{1j},\vec{0})\in\R\times\R^{n-1}$. Now let $G:=\{q_1,\dots,q_k\}$ and suppose that there exists a polynomial map $g:\R^n\rightarrow\R^n$ such that $g(\R^n)=\R^n\setminus G$. Then $(h\circ g)(\R^n) = \R^n \setminus F$, which concludes the first part of the proof. Thus in what follows we suppose that $p_j:=(a_j,\vec{0})$.
		
We claim that the image of the polynomial map $f:=(f_1,\dots,f_n)$ defined as:
$$
f({\tt x}):=\left({\tt x}_1{\tt x}_2-r+a_1,\ {\tt x}_1^{4}\rho({\tt x})+{\tt x}_1^{2}\sigma({\tt x})+{\tt x}_2,\ {\tt x}_3,\dots,\ {\tt x}_n\right)\quad\text{for ${\tt x}:=({\tt x}_1,\ldots,{\tt x}_n)\in\R^n$}
$$
is $\R^n\setminus F$, where $r$ is an integer such that $r\neq a_1-a_j$ for $j=1,\dots,k$,  
$$
\sigma({\tt x}):=\sum_{j=3}^n{\tt x}_j^2 \, \, \text{ and } \, \, \rho({\tt x}):=\prod_{j=1}^k({\tt x}_1{\tt x}_2-r+a_1-a_j).
$$
First, suppose that there exists $b:=(b_{1},\dots,b_{n})\in R^n$ with $f(b)=p_\ell$ for some $\ell=1,\dots,k$. Then $f_1(b)=b_1b_2-r+a_1=a_\ell$. Thus the $\ell^{th}$-factor of the polynomial $\rho$ evaluated at $x:=b$ is
$$
b_1b_2-r+a_1-a_\ell=a_\ell-a_\ell=0,
$$		 
and $\rho(b)=0$. In addition, the equality $f(b)=p_\ell=(a_{_\ell},\vec{0})$ implies that $f_i(b)=0$ for $i=2,\dots,n$. In particular, as $f_i\equiv\text{id}$ for $i=3,\dots,n$ we get $b_i=0$ for $i=3,\dots,n$. Consequently $\sigma(b)=0$. Since $\sigma(b)=\rho(b)=0$ we get $b_2=f_2(b)= 0$, so $b_2=0$ and $a_{\ell}=f_1(b)=a_1-r$, that is, $r=a_1-a_\ell$, which is a contradiction. So $\text{im}(f)\subset \R^n\setminus F$.
Conversely, let $u:=(u_1,\dots,u_n)\in\R^n\setminus F$. We must prove that the system of polynomial equations:
\[ \begin{cases} 
f_1({\tt x})={\tt x}_1{\tt x}_2-r+a_1=u_1 \\
f_2({\tt x})={\tt x}_1^4\rho({\tt x})+{\tt x}_1^2\sigma({\tt x})+{\tt x}_2=u_2 \\
f_j({\tt x})={\tt x}_j=u_j,\quad j\geq 3
\end{cases}  \]
has a solution.
\begin{enumerate}[(i)]
\item If $u_1=a_1-r$ then $f(0,u_2,\dots,u_n)=u$.
\item If $u_1\neq a_1-r$ we use the first equation to substitute 
\end{enumerate}
$$
{\tt x}_2=\frac{u_1-a_1+r}{{\tt x}_1} \quad \text{ and } \quad {\tt x}_j=u_j \quad \text{ for } j\geq 3.
$$ 
Next, we expand $f_2({\tt x})$:
$$
{\tt x}_1^4\rho({\tt x})+x_1^2\sigma({\tt x})-u_2=-{\tt x}_2=-\frac{u_1-a_1+r}{{\tt x}_1},
$$ 
and multiplying by ${\tt x}_1$ we get 
\begin{equation}\label{quintica}
{\tt x}_1^5\rho({\tt x})+{\tt x}_1^3\sigma({\tt x})-u_2{\tt x}_1+(u_1-a_1+r)=0.
\end{equation}
Then, $\rho({\tt x})=\prod_{j=1}^k(u_1-a_j) \text{ and } \sigma({\tt x})=\sigma(u)$. Now it is clear that each solution $x_1$ of equation \eqref{quintica} must be a nonzero root of the polynomial:
$$
Q({\tt t})=\Big(\prod_{j=1}^k(u_1-a_j)\Big){\tt t}^{5}+\sigma(u){\tt t}^{3}-u_2{\tt t}+(r-a_1+u_1),
$$
which has odd degree, and so it has a real root, unless 
$$
\prod_{j=1}^k(u_1-a_j)=\sigma(u)=u_2=0.
$$ 
If this were the case, then $u_1=a_j$ for some $j= 1,\dots,k$ and $u_2=u_3=\cdots=u_k=0$. This is not possible because $u\not\in F$. Thus, $Q({\tt t})$ has a real root, say $b_1$, and in fact $b_1\neq0$ because $Q(0)=r-a_1+u_1\neq 0$.
Finally, 
$$
f\left(b_1,\ \frac{u_1-a_1+r}{b_1},\ u_3,\ \dots,\ u_n\right)=u,
$$
as required.

\qed
\end{section}
\end{chapter}

\begin{chapter}{The open quadrant $\Qu$ problem: First proof}
\begin{section}{How to find a ``potential'' map to solve the problem}\label{quadReasons}
		
It is worthwhile mentioning that though the open interval $I:=(0,+\infty)$ is the image of $\R^2$ under the polynomial map $h:\R^2\to\R,\, (x,y)\mapsto (xy-1)^2+x^2$, see Figure \ref{fig:h(x,y)}, the interval $I$ is not a polynomial image of $\R$ because polynomial images of the real line are closed subsets of $\R$.
\begin{figure}[h]
\begin{center}
\includegraphics[width=0.8\textwidth]{plots/ch1_03_f(x,y).png}
\caption{$h({\tt x},{\tt y})=({\tt x}{\tt y}-1)^2+{\tt x}^2$.\label{fig:h(x,y)}}
\end{center}
\end{figure}
		
However, although $h(\R^2)=I$, the polynomial $h$ does not help to obtain $\Qu$ at all:
\begin{remark}
There is no polynomial map $f:=(P_1, P_2):\R^2\to\R^2$ satisfying $f(\R^2)=\Qu$ and $P_1({\tt x},{\tt y})=({\tt x}{\tt y}-1)^2+{\tt x}^2$.
\end{remark}
The proof of this remark relies on a suitable use of the Curve Selection Lemma (\cite[VIII.2.6]{abr}) to approach a point $(\lambda^2,0)\in\overline{\Qu}$ with $\lambda>0$, to get a contradiction.
		
\vspace{1mm}

On the topic of finding a polynomial map $\Phi:\R^2\to\R^2$ that satisfies $\Phi(\R^2)=\Qu$, ``a major difficulty" is the following:
\begin{center}
\begin{tabular}{rr}
$\qquad \qquad\quad$ \fbox{\textit{The closure of its image must contain the positive half-axes.}} & $\quad \quad$ ($\clubsuit$)
\end{tabular}
\end{center}
\begin{remark} Using Theorem \ref{finSetTh}, we just need to find a polynomial map $$\P=(\F,\G):\R^2\to\R^2$$ such that $\P(\R^2)$ is the disjoint union of $\Qu$ and a set with finite preimage, say $\P(\R^2)=\Qu\ \sqcup F$ with $\P^{-1}(F)$ a finite set. Suppose for a while this is proved. Then, by Theorem \ref{finSetTh}, there exists a polynomial map $\varphi:\R^2\to\R^2$ such that $\varphi(\R^2)=\R^2\setminus\P^{-1}(F)$ and the polynomial map $\Phi:=\P\circ\varphi$ satisfies
$$
\Phi(\R^2)=\P(\varphi(\R^2))=\P(\R^2\setminus\P^{-1}(F))=\P(\R^2)\setminus F=(\Qu\ \sqcup F)\setminus F=\Qu.
$$ 
\end{remark}
We are going to define a map $\P:=(\F,\G)$ that accomplish this task, with the set $F$ being $F:=\set{(-1,0),(0,-1)}$. If we were able to find such map $\P$, then condition ($\clubsuit$) will immediately be satisfied. 
		
\vspace{1mm}

Suppose for a while that such a map $\P$ exists. Then, for every $\lambda,\mu\ge 0$ there will exist \hyperref[curveGerms]{Nash half-branch curve germs} $\alpha_{\lambda}(s),\beta_{\mu}(s)$ which cannot be extended to $0$ and such that:
$$
\lim_{s\rightarrow 0} P(\alpha_{\lambda}(s))=(\lambda^2,0)\qquad \text{and} \qquad \lim_{s\rightarrow 0} P(\beta_{\mu}(s))=(0,\mu^2).
$$
We can try parameterizations of the form:
$$
\alpha_{\lambda}(s):=\left(s^{n_{\lambda}},\frac{a_{\lambda 0}+a_{\lambda 1}s+\cdots}{s^{m_{\lambda}}}\right)
\quad \text{ and } \quad
\beta_{\mu}(s):=\left(\frac{b_{\mu 0}+b_{\mu 1}s+\cdots}{s^{\ell_{\mu}}},s^{k_{\mu}}\right).
$$
Then $a_{\lambda 0},b_{\mu 0}$ must be constants (except maybe for finitely many values of $\lambda$ and $\mu$). This leads us to choose curves of the type:
$$
\alpha_{\lambda}(s):=\left(s^{n_{\lambda}},\frac{1+a_{\lambda 1}s+\cdots}{s^{m_{\lambda}}}\right)
\quad \text{ and } \quad
\beta_{\mu}(s):=\left(\frac{1+b_{\mu 1}s+\cdots}{s^{\ell_{\mu}}},s^{k_{\mu}}\right),
$$
and among them we make the simplest choice: 
$$
\alpha_{\lambda}(s):=\left(s,\frac{1+a_{\lambda }s}{s}\right)
\quad \text{ and } \quad
\beta_{\mu}(s):=\left(\frac{1+b_{\mu }s}{s},s^{3}\right).
$$
The following pair of polynomials:
\begin{equation*}\label{eq:firstMap}
\boxed{
\begin{aligned}
\F({\tt x},{\tt y})&:=(1-{\tt x}^3{\tt y}+{\tt y}-{\tt x}{\tt y}^2)^2+({\tt x}^2{\tt y})^2&=&\ \F_1^2+\F_2^2 \\
\G({\tt x},{\tt y})&:=(1-{\tt x}{\tt y}+{\tt x}-{\tt x}^4{\tt y})^2+({\tt x}^2{\tt y})^2&=&\ \G_1^2+\G_2^2\\
\end{aligned}
}
\end{equation*}
enjoy a nice behavior along these curves, as figure \ref{fig:plotFG} show.
\begin{figure}[h]\hspace{-0.15cm}
\begin{subfigure}{.49\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch1_04_F.png}
\caption{$\F({\tt x},{\tt y}):=(1-{\tt x}^3{\tt y}+{\tt y}-{\tt x}{\tt y}^2)^2+({\tt x}^2{\tt y})^2$.\label{fig:F}}
\end{subfigure}
\begin{subfigure}{.50\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch1_05_G.png}
\caption{$\G({\tt x},{\tt y})=(1-{\tt x}{\tt y}+{\tt x}-{\tt x}^4{\tt y})^2+({\tt x}^2{\tt y})^2$.\label{fig:G}}
\end{subfigure}\\[1ex]
\caption{Plots of the polynomials $\F,\G:\R^2\longrightarrow\R$.\label{fig:plotFG}}
\end{figure}
Next, notice that
\begin{enumerate}[(a)]
\item $\cdot$ $\F_1\circ\alpha_\lambda=1-a_{\lambda}-a_{\lambda}^{2} s-s^{2}-a_{\lambda} s^{3}\in\R[s,a_{\lambda}]$,
$\qquad\qquad\qquad \,\, \, \,   \F_1\circ\alpha_{\lambda }(0)=1-a_{\lambda. }$ \newline
$\cdot$ $\F_1\circ\beta_{\mu}=-3\,b_{\mu}s-3 \,b_{\mu}^{2} s^{2}-{\left(b_{\mu}^{3}-1\right)}s^{3}-s^{5}-b_{\mu}s^{6}\in\R[s,b_{\mu}]$,
$\, \F_1\circ\beta_{\mu}(0)=0$.
				
\item $\cdot$ $ \G_1\circ\alpha_{\lambda } = {\left(1-a_{\lambda} \right)}s-s^{3}-a_{\lambda} s^{4} \in\R[s,a_{\lambda}]$,
$\qquad\qquad\qquad\qquad\, \, \, \, \,\G_1\circ\alpha_{\lambda }(0)=0$.

$\cdot$ $\G_1\circ\beta_{\mu}=1-3\, b_{\mu}-6\,b_{\mu}^{2}s-{\left(4\,b_{\mu}^{3}+1\right)}s^{2}-{\left(b_{\mu}^{4}+ b_{\mu}\right)}s^{3}\in\R[s,b_{\mu}], \, \, \G_1\circ\beta_{\mu}(0)=1-3b_{\mu}$.
		
\item $\cdot$ $\F_2\circ\alpha_{\lambda }= s+a_{\lambda} s^{2} = \G_2\circ\alpha_{\lambda}\in\R[s,a_{\lambda }]$.
			
$\cdot$ $\F_2\circ\beta_{\mu}= s+2 \, b_{\mu} s^{2}+b_{\mu}^{2} s^{3} = \G_2\circ\beta_{\mu}\in\R[s,b_{\mu}]$.
				
$\cdot$ $\F_2\circ\alpha_{\lambda }(0)=\G_2\circ\alpha_{\lambda}(0)=\F_2\circ\beta_{\mu}(0)=\G_2\circ\beta_{\mu}(0)=0$.
\end{enumerate}
All of these map compositions were computed by Sage. Thus, we get the following properties:
		
\begin{enumerate}[(i)]
		
\item The polynomials $\F,\G$ are non-negative in $\R^2$.
		
\item $\cdot$ $\F^{-1}(0)=\F_1^{-1}(0)\cap \F_2^{-1}(0)=\{(0,-1)\}\xmapsto{\ \P\ }\set{(0,1)}$.
			
$\cdot$ $\G^{-1}(0)=\G_1^{-1}(0)\cap \G_2^{-1}(0)\ =\, \{(-1,0)\} \xmapsto{\ \P\ } \set{(1,0)}$.
		
\item $\cdot$ $\P\circ\alpha_{\lambda}=(\F\circ\alpha_{\lambda },\G\circ\alpha_{\lambda})=$
			
$\arraycolsep=2pt\def\arraystretch{1.2}
\begin{array}{l}
\left(\right.a_{\lambda}^{2}-2 \,a_{\lambda}+1+2 \,{(a_{\lambda}^{3}-a_{\lambda}^{2})}s+{(a_{\lambda}^{4}+2 \, a_{\lambda}-1)} s^{2}+ \,a_{\lambda}^{2} s^{3}+\\
\quad {(2\, a_{\lambda}^{3}+a_{\lambda}^{2}+1)}s^{4}+2 \,a_{\lambda} s^{5}+a_{\lambda}^{2} s^{6},\\		
\ {(a_{\lambda}^{2}-2 \ a_{\lambda}+2)} s^{2}+2 \, a_{\lambda} s^{3}+{(a_{\lambda}^{2}+2 \,a_{\lambda}-2)}s^{4}+\\
\quad \,2 \,{(a_{\lambda}^{2}-a_{\lambda})}s^{5}+s^{6}+2\,a_{\lambda} s^{7}+a_{\lambda}^{2}s^{8}\left.\right).
\end{array}
$
				
$\cdot$ $\P\circ\beta_{\mu}=(\F\circ\beta_{\mu},\G\circ\beta_{\mu})=
$
				
				$\arraycolsep=2pt\def\arraystretch{1.2}
\begin{array}{l}
\left(\right.{(9 \,b_{\mu}^{2}+1)}s^{2}+2 \,{(9 \,b_{\mu}^{3}+2\,b_{\mu})}s^{3}+3\,{(5\,b_{\mu}^{4}+2\,b_{\mu}^{2}-2\,b_{\mu})}s^{4}+\\
\quad 2\,{(3 \,b_{\mu}^{5}+2\,b_{\mu}^{3}-3\,b_{\mu}^{2})}s^{5}+{(b_{\mu}^{6}+b_{\mu}^{4}-2\,b_{\mu}^{3}+6\,b_{\mu}+1)} s^{6}+\\
\quad 12\,b_{\mu}^{2} s^{7}+2\,{(4\,b_{\mu}^{3}-1)}s^{8}+2\,{(b_{\mu}^{4}-b_{\mu})}s^{9}+s^{10}+2\,b_{\mu}s^{11}+b_{\mu}^{2} s^{12},\\
					\ 9 \, b_{\mu}^{2}-6 \, b_{\mu}+1+12 \, {(3 \, b_{\mu}^{3} - b_{\mu}^{2})} s+{(60\, b_{\mu}^{4} - 8 \, b_{\mu}^{3}+6 \, b_{\mu}-1)}s^{2} + \\
					\quad 2 \, {(27\,b_{\mu}^{5}-b_{\mu}^{4}+9\,b_{\mu}^{2}+b_{\mu})}s^{3}+{(28\,b_{\mu}^{6}+20\,b_{\mu}^{3}+6\,b_{\mu}^{2}+1)} s^{4}+\\
					\quad2\,{(4\,b_{\mu}^{7}+5\,b_{\mu}^{4}+2\,b_{\mu}^{3}+b_{\mu})}s^{5}+{(b_{\mu}^{8}+2\,b_{\mu}^{5}+ b_{\mu}^{4} +b_{\mu}^{2})} s^{6}\left.\right).
					\end{array}
$
\end{enumerate}
The polynomials $\F\circ\alpha_{\lambda },\ \G\circ\alpha_{\lambda}\in\R[s,a_{\lambda}]$ and $\F\circ\beta_{\mu},\ \G\circ\beta_{\mu}\in\R[s,b_{\mu}]$ were computed with Sage. As we anticipated before, by condition (ii) the set $F=\set{(-1, 0),(0,-1)}$.
\end{section}
\begin{section}{The first proof for the open quadrant problem} [Proof of Theorem \ref{openQuad}] We are going to prove that $\Qu\subset\P(\R^2)$. To do this it is enough to fix $v>0$ and to see that the image under $\F$ of the curve $\{\G=v\}$ contains the open half-line $(0,+\infty)$.
\begin{center}
\fbox{\textbf{Step 1}} \emph{Parametrization of the curve $\{\G-v=0\}$.}
\end{center}\label{step1}

We start by solving the equation $\G-v=0$, that is, 
$$
(1-{\tt x}{\tt y}+{\tt x}-{\tt x}^4{\tt y})^2+({\tt x}^2{\tt y})^2-v=0
$$ 
As it has degree $2$ with respect to $y$, we compute its roots $y^+({\tt x},v)$ and $y^-({\tt x},v)$ given by:
\begin{equation*}
\begin{aligned}
y^+({\tt x},v)&:=\frac{1+{\tt x}+{\tt x}^3+{\tt x}^4+\sqrt{\Delta({\tt x},v)}}{{\tt x}({\tt x}^2+({\tt x}^3+1)^2)}\\
y^-({\tt x},v)&:=\frac{1+{\tt x}+{\tt x}^3+{\tt x}^4-\sqrt{\Delta({\tt x},v)}}{{\tt x}({\tt x}^2+({\tt x}^3+1)^2)}\\
\end{aligned}
\end{equation*}
where $\Delta({\tt x},v)=\Delta_v({\tt x}):=v({\tt x}^2+({\tt x}^3+1)^2)-{\tt x}^2({\tt x}+1)^2,\ \text{deg}_{\tt x}(\Delta)=6$. We can see on figure \ref{fig:plotYs_1} how $y^+$ and $y^-$ look like for instance for $v:=0.8$. As we can see on figure \ref{fig:plotYs_2}, for $v:=1$ there are no singularities on $y^-$ because $\lim_{x\rightarrow0}y^-(x,1)=1$. This observation is used later, in \hyperref[step2]{Step 2}.
\begin{figure}[h]
\centering
\includegraphics[width=1\textwidth]{plots/ch1_06_sols.pdf}
\caption{$y^+(x,v)$ and $y^-(x,v)$ for $v:= 0.8$.\label{fig:plotYs_1}}
\end{figure}
\begin{figure}[h]
\centering
\includegraphics[width=1\textwidth]{plots/ch1_07_sols_1.pdf}
\caption{$y^+(x,v)$ and $y^-(x,v)$ for $v:=1$.\label{fig:plotYs_2}}
\end{figure}

The common domain of these two functions is the set 
$$
D_v:=\{x\in R:\, \Delta(x,v)\geq 0,\,x\neq 0\}.
$$ 
Notice that the only real root of the denominator is $x_0:=0$.\footnote{We checked with Laguerre's method, implemented with Python 2.7, that the polynomial $x^7+2x^4+x^3+x$ has 6 complex roots.} Let
$$
\gamma_v^+: D_v\to\R,\, x\mapsto\F(x,y^+(x,v))\quad\text{ and }\quad\gamma_v^-:D_v\to\R,\, x\mapsto\F(x,y^-(x,v))
$$
Note that $\F(\set{\G=v})=\text{im}(\gamma_v^+)\cup\text{im}(\gamma_v^-)$, so all reduce to prove the inclusion 
$$
(0,+\infty)\subset\text{im}(\gamma_v^+)\cup\text{im}(\gamma_v^-).
$$
\begin{center}
\fbox{\textbf{Step 2}} \emph{Main properties of $\gamma_v^+ \text{ and } \gamma_v^-$.}
\end{center}\label{step2}
In this section we are going to prove that:
$$
\text{(i)} \lim_{x\rightarrow \pm\infty}\gamma_v^+(x)=\lim_{x\rightarrow \pm\infty}\gamma_v^-(x)=0.
$$
$$\text{(ii)} \lim_{x\rightarrow 0}\gamma_v^+(x)=+\infty
,\quad \lim_{x\rightarrow 0}\gamma_v^-(x)=\left\{\begin{array}{ll}
+\infty&\text{ for $v\neq 1$}\\
 4 & \text{ for $v=1$}
\end{array} \right.
$$
Using Sage we can symbolically check how $\gamma_v^+\text{ and }\gamma_v^-$ look like, getting polynomials $A_1,A_2,B_1,B_2\in\R[x,v]$ and $C\in \R[x]$ such that:
$$\text{(a) }\gamma_v^+(x)=\dfrac{A_1(x,v)+B_1(x,v)\sqrt{\Delta(x,v)}}{C(x)}, \ \ 
\gamma_v^-(x)=\dfrac{A_2(x,v)+B_2(x,v)\sqrt{\Delta(x,v)}}{C(x)},$$
$$
\text{(b)}\ \ 
\arraycolsep=1.4pt\def\arraystretch{1.5}
\begin{array}{cclrl}
A_1(x,v)&=&\ \ A_2(x,v)\, , & \text{deg}_x(A_1)=\text{deg}_x(A_2)=24& \\
B_1(x,v)&=&-B_2(x,v)\, , &\text{deg}_x(B_1)=\text{deg}_x(B_2)=21& \\
C(x)&=&x^2(x^2+(x^3+1)^2)^4\, , & \text{deg}_x(C)=26&.
\end{array}
$$
We proceed to study $\gamma_v^+$ and $\gamma_v^-$ at the origin. Since $\Delta$ has even degree and positive leading coefficient with respect to $x$, it is positive for $\abs{x}$ large enough, so (i) holds.
			
Now, for $x=0$, we get $\Delta(0,v)=v>0$, thus $0\in\overline{D_v}$. Also:
\begin{itemize}
\item $A_1(0,v)+B_1(0,v) \sqrt{\Delta(0,v)}= v(1+\sqrt{v})^2>0$.
				\item $A_2(0,v)+B_2(0,v)\sqrt{\Delta(0,v)}=v(1-\sqrt{v})^2\geq 0$, and equality holds if and only if $v=1$.
\end{itemize}
			
\begin{figure}[h]
\centering
\includegraphics[width=0.75\textwidth]{plots/ch1_08_numerators.pdf}
\caption{Numerators of $\gamma_v^+$ and $\gamma_v^-$ for $x:=0$.\label{fig:numerators}}
\end{figure}
			
Thus, (ii) holds (we also checked it with Sage). The result for $v:=1$ in (ii) is not relevant here (see figure \ref{fig:limit}).
\begin{figure}[h]
\centering
\includegraphics[width=1\textwidth]{plots/ch1_09_limit.pdf}
\caption{Notice the value of $\gamma_1^-(x)$ at $x=0$.\label{fig:limit}}
\end{figure}

\begin{center}
\fbox{\textbf{Step 3}} \emph{When $v\geq 0.28^2$ we have} $(0,+\infty)\subset\text{im}(\gamma_v^+)$.
\end{center}\label{step3}
In order to see whether $(0,+\infty)\subset\text{im}(\gamma_v^+)\cup\text{im}(\gamma_v^-)$ or not we are now going to study the domain $D_v$. To that end we need to study when $\Delta(x,v)=0$, so it seems convenient to define:
$$
v(x):=\frac{x^2(x+1)^2}{x^2+(x^3+1)^2},
$$
whose graph can be seen in figure \ref{fig:v(x)}. If $x\in(-\infty,0)$ we checked using Laguerre's method that the polynomial
\begin{figure}[h]\hspace{-0.2cm}
\begin{subfigure}{.5\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch1_10_uve.pdf}
\caption{Plot of $v(x)$.\label{fig:uve}}
\end{subfigure}
\begin{subfigure}{.5\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch1_11_uve_detail.pdf}
\caption{Detail of the function when $x\in(-4,0)$.\label{fig:uveDetail}}
\end{subfigure}\\[1ex]
\caption{Plot of the univariate function $v(x)$.\label{fig:v(x)}}
\end{figure}
$$
\Delta(x,0.28^2)=0.0784\,x^{6}-x^{4}-1.8432\,x^{3}-0.9216\,x^{2}+0.0784
$$ 
has 4 complex roots and 2 real ones\footnote{The value $v_0:=0.28^2$ comes from a careful observation of the plot from figure \ref{fig:uveDetail}.}. These last are $\delta_0\approx 0.236$ and $\delta_1\approx 4.336$. Thus $\Delta({\tt x},v)$ has no negative roots for $v\ge 0.28^2$ and, in addition, it only attains positive values. Therefore $(-\infty,0)\subset D_v$. But then, as $\gamma_v^+$ is continuous and recalling the limits computed in \hyperref[step2]{Step 2}, we get  
$$
(0,+\infty)\subset\text{im}(\gamma_v^+)\subset\text{im}(\gamma_v^+)\cup\text{im}(\gamma_v^-).
$$
\begin{center}
\fbox{\textbf{Step 4}} \emph{When $0<v<0.28^2$ we have} $(0,+\infty)\subset\text{im}(\gamma_v^-)$.
\end{center}
\label{step4}
To prove that for $0<v<0.28^2$ the inclusion $(0,+\infty)\subset\text{im}(\gamma_v^-)$ holds it is enough to prove the existence of $N_v,\delta_v\in\R$ satisfying			
\begin{equation*}\qquad \quad
\qquad\quad\boxed{N_v<\delta_v,\ \ (-\infty,N_v]\cup[\delta_v,+\infty)\subset D_v\text{ and } \gamma_v^-(N_v)>\gamma_v^+(\delta_v)\\
}\qquad \qquad (\spadesuit)
\end{equation*}
\begin{figure}[h]
\centering
\includegraphics[width=1\textwidth]{plots/ch1_12_idea.pdf}
\caption{Idea of what we are saying with $(\spadesuit)$. Here $v:=0.1$.\label{fig:idea}}
\end{figure}
See figure \ref{fig:idea} to get an idea of what we are saying here. 

To prove the existence of such $N_v$ and $\delta_v$, we must compute the roots of $\Delta_v({\tt x})$ in an algebraic closure of the field of rational functions $\R(v)$. Such an algebraic closure is the field of Puiseux series $\C\left(\set{v^*}\right)$, see \ref{puiseux}. These roots are power series in $\C\left(\set{w^*}\right)$ with $w:=\sqrt{v}$, and we consider the largest and the smallest negative roots $\eta_v,\xi_v\in\R\left(\set{v^*}\right)$ of $\Delta_v$ with respect to the unique ordering in $\R\left(\set{v^*}\right)$ that makes $v$ positive and infinitesimal with respect to $\R$. These roots are:
			
\begin{equation*}\left\{\begin{split}
\eta_v:=&-\frac{1}{w}+1+w+w^2+\frac{5}{2}w^3+\cdots\\
\xi_v:=&-w-w^2-\frac{5}{2}w^3-6w^4+\cdots
\end{split}\right.
\end{equation*}
Notice that, by the definition of the ordering in $\R\left(\set{v^*}\right)$, the first coefficient of a series is the ``most meaningful orderwise". In particular $\eta_v<\xi_v$. To perform calculations, we handle suitable truncations of the involved series. Here the word suitable means ``as short as possible but order preserving"; in other words, we look for $N_v$ and $\delta_v$ with $N_v<\eta_v<\xi_v<\delta_v$, and in fact we choose
\begin{equation*}\left\{
\begin{split}
N_v:=&-\frac{1}{w}+1+w+w^2=\eta_v-\Big(\frac{5}{2}w^3+\cdots\Big)<\eta_v\\
\delta_v:=&-w-w^2-\frac{5}{2}w^3=\xi_v-(-6w^4+\cdots)>\xi_v
\end{split}\right.
\end{equation*}
We checked with Sage that $-\infty<N_v<\delta_v<0$ for $v\in (0,0.28^2)$ that is, for $w\in(0,0.28)$, see Figure \ref{fig:comp}. Now we can focus on proving $(\spadesuit)$. Since $\Delta(N_{w^2},w^2)$ and $\Delta(\delta_{w^2},w^2)$ are positive (see Figure \ref{fig:positive}) for $w\in (0,0.28)$, we get that $N_v, \delta_v\in D_v$.
\begin{figure}[h]\hspace{-0.25cm}
\begin{subfigure}{.50\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch1_13_comp.pdf}
\caption{$-\infty<N_v<\delta_v<0$.\label{fig:comp}}
\end{subfigure}
\begin{subfigure}{.50\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch1_14_positive.pdf}
\caption{$\Delta(N_{v}, v), \Delta(\delta_{v},v) > 0$.\label{fig:positive}}
\end{subfigure}\\[1ex]
\caption{Plots of $N_v,\delta_v<0$ and $\Delta(N_{v},v),\ \Delta(\delta_{v},v)>0$ for $v\in(0, 0.28^2)$.\label{fig:N_delta}}
\end{figure} For the first part, let 
$$
D:=\bigcup_{v>0}D_v=\bigcup_{v>0}\set{x\in\R:\Delta(x,v)\geq 0,\,x\neq 0},
$$ 
whose boundary is the union of the axis $\{x=0\}\subset\R^2$ and the curve given by the equation $\Delta(x,v)=0$, that is, the graph of the regular function
$$
v(x)=\frac{x^2(x+1)^2}{x^2+(x^3+1)^2}.
$$
This graph is above the axis $\{v=0\}\subset R^2$. Then, $(-\infty,N_v]$ and $[\delta_v,0)$ are contained in the interior of $D_v$ for $v\in (0, 0.28^2)$, because the curves 
$$
\set{(\delta_v,v):0<v<0.28^2}\, \, \, \text{and}\, \, \, \set{(N_v,v):0<v<0.28^2}
$$ 
are contained in $D$, they are graphs above the vertical axis $\{x=0\}\subset R^2$, and $\delta_v<\xi_v$ and $N_v<\eta_v$ as we saw before. Look at figure \ref{fig:nice_plot}.

\begin{figure}[h]
\centering
\includegraphics[width=1\textwidth]{plots/ch1_15_nice_plot.pdf}
\caption{Plot of $\set{(N_v,v)}, \set{(\delta_v,v)}\subset D_v$, for $0<v<0.28^2$.\label{fig:nice_plot}}
\end{figure}

\vspace{1mm}

So the only thing left to do is checking that $\gamma_v^-(N_v)>\gamma_v^-(\delta_v)$. Recall that 
$$
\gamma_v^-({\tt x})=\dfrac{A_2({\tt x},v)+B_2({\tt x},v)\sqrt{\Delta({\tt x},v)}}{C({\tt x})},
$$
with $\text{deg}_{\tt x}(A_2)=24,\, \, \text{deg}_{\tt x}(B_2)=21,\, \, \text{deg}_{\tt x}(\Delta)=6\, \, \text{ and }\text{deg}_{\tt x}(C)=26$. Consider:
$$
\arraycolsep=2pt\def\arraystretch{1.5}
\begin{array}{rclcrcl}
\cdot\ f_1(w)&=&A_2(N_{w^2},w^2)\cdot w^{24}& \qquad &\cdot\ f_2(w)&=& A_2(\delta_{w^2},w^2)\\
\cdot\ g_1(w)&=&B_2(N_{w^2},w^2)\cdot w^{21}& \qquad &\cdot\ g_2(w)&=&B_2(\delta_{w^2},w^2)\\
\cdot\ q_1(w)&=&\Delta(N_{w^2},w^2)& \qquad &\cdot\ q_2(w)&=&\Delta(\delta_{w^2},w^2)\\
\cdot\ h_1(w)&=&C(N_{w^2})\cdot w^{26}& \qquad &\cdot\ h_2(w)&=&C(\delta_{w^2}).
\end{array}
$$
Thus, we need to prove that for $w\in(0,0.28)$:
$$
\frac{f_1\cdot(w^{24})^{-1}+g_1\cdot (w^{21})^{-1}\sqrt{q_1}}{h_1\cdot(w^{26})^{-1}}>\frac{f_2+g_2\sqrt{q_2}}{h_2} \iff
$$
$$
\frac{w^2h_2f_1-f_2h_1}{h_1h_2}+\frac{w^5g_1\sqrt{q_1}}{h_1}-\frac{g_2\sqrt{q_2}}{h_2}>0,
$$
and we are going to prove that 
$$
\Lambda_1:= \frac{w^2h_2f_1-f_2h_1}{h_1h_2},\, \, \, \Lambda_2:=\frac{w^5g_1\sqrt{q_1}}{h_1} \, \text{ and } \Lambda_3 := -\frac{g_2\sqrt{q_2}}{h_2}
$$
are positive in the given interval, which only contains positive values. As $q_1,q_2$ are positive, we can clear away $w^5$ and $\sqrt{q_1}$ from $\Lambda_2$, and $\sqrt{q_2}$ from $\Lambda_3$. Furthermore, the polynomial $C({\tt x})={\tt x}^2({\tt x}^2+({\tt x}^3+1)^2)^4>0$, so we can also remove $h_1$ and $h_2$ from $\Lambda_1,\Lambda_2, \Lambda_3$. Thus it suffices to see that
$$
L:=\frac{w^2h_2f_1-f_2h_1}{w^4},\quad g_1,\quad K:=-\frac{g_2}{w^3}
$$ 
are positive for $w\in(0,0.28)$.

\vspace{2cm}

As we see in the figures they indeed are. This has been also checked with Sturm algorithm and numerically with Sage. Thus, $(\spadesuit)$ holds and the result is proved.

\begin{center}
\includegraphics[width=0.45\linewidth]{plots/ch1_16_L.pdf}
\includegraphics[width=0.45\linewidth]{plots/ch1_17_g_1.pdf} \\
\includegraphics[width=0.45\linewidth]{plots/ch1_18_K.pdf}		
\end{center}
\qed
\end{section}
\end{chapter}

\begin{chapter}{A short proof for the open quadrant $\Qu$ problem}
\begin{section}{A new approach}
In the previous chapter, we proved that $\Qu$ is the image of $\R^2$ under the polynomial map $\P:=(\F,\G)$. This fact alongside Theorem \ref{finSetTh} were key for proving Theorem \ref{openQuadGen}. To achieve Theorem \ref{openQuad}, we needed the aid of a computer in order to check that certain polynomials do not have roots on particular intervals or that they are positive on them. Although legit, this procedure is controversial, and the authors kept on working on the problem of characterizing which semialgebraic subsets $\mathscr{S} \subset \R^m$ are polynomial images of $\R^n$ and wrote a new paper (\cite{fu}) with a much simpler proof.

In this third chapter we present a new approach to the open quadrant problem. We will show that $\Qu$ is the image of the composition of three simple polynomial maps: $\FF,\, \GG \text{ and } \HH$. The proof of Theorem \ref{openQuad} will be conducted by inspecting at the images of the aforementioned polynomials, albeit the lack of precise tools to determine the image of a polynomial map.

\begin{subsection}{The new polynomial maps}
In this subsection we introduce new polynomial maps that satisfy the requirements to prove Theorem \ref{openQuad} in a different way. To be more precise, we define 
$$
f:=\HH\circ\GG\circ\FF:\R^2\longrightarrow \R^2,
$$
where
\begin{equation*}\label{eq:secondMap}
\boxed{
\begin{aligned}
\FF:\R^2\longrightarrow \R^2,\ (x,y)&\longmapsto((xy-1)^2+x^2,\ (xy-1)^2+y^2), \\
\GG:\R^2\longrightarrow \R^2,\ (x,y)&\longmapsto(x,\ y(xy-2)^2+x(xy-1)^2), \\
\HH:\R^2\longrightarrow \R^2,\ (x,y)&\longmapsto(x(xy-2)^2+\tfrac{1}{2}xy^2,\ y). \\
\end{aligned}
}
\end{equation*}
We can see how the graphs of the components of these maps look like in figure \ref{fig:ch2Maps}, and appreciate the symmetry between the $x$ and $y$ variables while the transformation is performed.

\vspace{1mm}

In the next section we proceed to develop the proof, which splits into three lemmas.

\begin{figure}
\hspace{-0.1cm}
\begin{subfigure}{.49\linewidth}\centering
\begin{tikzpicture}
\node[anchor=south west,inner sep=0] (img)at (0,0) {\includegraphics[width=1\textwidth]{plots/ch2_01_F_1.png}};
\path ($(img.north west)!0.28!(img.north east)$)|-coordinate(c1)($(img.south east)!0.1!(img.north east)$);
\path ($(img.north west)!0.85!(img.north east)$)|-coordinate(c2)($(img.south east)!0.15!(img.north east)$);
\draw (c1) node {$x$};
\draw (c2) node {$y$};
\end{tikzpicture}
\vspace{0.15cm}\caption{$\FF_1({\tt x},{\tt y})=({\tt x}{\tt y}-1)^2+{\tt x}^2$.\label{fig:FF_1}}
\end{subfigure}
\begin{subfigure}{.49\linewidth}\centering
\begin{tikzpicture}
\node[anchor=south west,inner sep=0] (img)at (0,0){\includegraphics[width=1\textwidth]{plots/ch2_02_F_2.png}};
\path ($(img.north west)!0.28!(img.north east)$)|-coordinate(c1)($(img.south east)!0.1!(img.north east)$);
\path ($(img.north west)!0.85!(img.north east)$)|-coordinate(c2)($(img.south east)!0.15!(img.north east)$);
\draw (c1) node {$x$};
\draw (c2) node {$y$};
\end{tikzpicture}
\vspace{0.15cm}\caption{$\FF_2({\tt x},{\tt y})=({\tt x}{\tt y}-1)^2+{\tt y}^2$.\label{fig:FF_2}}
\end{subfigure}\\[1ex]
\vspace{0.4cm}
	
\hspace{-0.1cm}
\begin{subfigure}{.49\linewidth}\centering
\begin{tikzpicture}
\node[anchor=south west,inner sep=0] (img)at (0,0) {\includegraphics[width=1\textwidth]{plots/ch2_03_G_1.png}};
\path ($(img.north west)!0.67!(img.north east)$)|-coordinate(c1)($(img.south east)!0.055!(img.north east)$);
\path ($(img.north west)!0.72!(img.north east)$)|-coordinate(c2)($(img.south east)!0.26!(img.north east)$);
\draw (c1) node {$x$};
\draw (c2) node {$y$};
\end{tikzpicture}
\vspace{0.15cm}\caption{$\GG_1({\tt x}, {\tt y}) = {\tt x}$.\label{fig:GG_1}}
\end{subfigure}
\begin{subfigure}{.49\linewidth}\centering
\begin{tikzpicture}
\node[anchor=south west,inner sep=0] (img)at (0,0) {\includegraphics[width=1\textwidth]{plots/ch2_04_G_2.png}};
\path ($(img.north west)!0.2!(img.north east)$)|-coordinate(c1)($(img.south east)!0.15!(img.north east)$);
\path ($(img.north west)!0.81!(img.north east)$)|-coordinate(c2)($(img.south east)!0.14!(img.north east)$);
\draw (c1) node {$x$};
\draw (c2) node {$y$};
\end{tikzpicture}
\vspace{0.15cm}\caption{$\GG_2({\tt x},{\tt y})={\tt y}({\tt x}{\tt y}-2)^2+{\tt x}({\tt x}{\tt y}-1)^2$.\label{fig:GG_2}}
\end{subfigure}\\[1ex]
\vspace{0.4cm}

\hspace{-0.1cm}
\begin{subfigure}{.49\linewidth}\centering
\begin{tikzpicture}
\node[anchor=south west,inner sep=0] (img)at (0,0) {\includegraphics[width=1\textwidth]{plots/ch2_05_H_1.png}};
\path ($(img.north west)!0.29!(img.north east)$)|-coordinate(c1)($(img.south east)!0.08!(img.north east)$);
\path ($(img.north west)!0.85!(img.north east)$)|-coordinate(c2)($(img.south east)!0.14!(img.north east)$);
\draw (c1) node {$x$};
\draw (c2) node {$y$};
\end{tikzpicture}
\vspace{0.15cm}\caption{$\HH_1({\tt x},{\tt y})={\tt x}({\tt x}{\tt y}-2)^2+\tfrac{1}{2}{\tt x}{\tt y}^2$.\label{fig:HH_1}}
\end{subfigure}
\begin{subfigure}{.49\linewidth}\centering
\begin{tikzpicture}
\node[anchor=south west,inner sep=0] (img)at (0,0) {\includegraphics[width=1\textwidth]{plots/ch2_06_H_2.png}};
\path ($(img.north west)!0.2!(img.north east)$)|-coordinate(c1)($(img.south east)!0.1!(img.north east)$);
\path ($(img.north west)!0.78!(img.north east)$)|-coordinate(c2)($(img.south east)!0.11!(img.north east)$);
\draw (c1) node {$x$};
\draw (c2) node {$y$};
\end{tikzpicture}
\vspace{0.15cm}\caption{$\HH_2({\tt x},{\tt y})={\tt y}$.\label{fig:HH_2}}
\end{subfigure}
\vspace{0.7cm}\caption{The polynomial maps from the second proof: $(\HH\circ\GG\circ\FF)(\R^2)=\Qu$.\label{fig:ch2Maps}}
\end{figure}
\end{subsection}
\end{section}

\begin{section}{The new proof for the open quadrant problem}
As we have anticipated before, $\Qu$ is the image of the composition $\HH\circ\GG\circ \FF$, but before proving this fact we need three auxiliar lemmas in order to shed some light on the properties that the images of $\FF,\,\GG\text { and }\HH$ enjoy.

\begin{subsection}{The first lemma}
\begin{lemma}\label{lemma1} \em Let $\mathscr{A}:=\set{xy\ge1}\ \cap\, \Qu$. Then the image of the map
$$
\FF:=(\FF_1,\FF_2):\R^2\to\R^2,(x,y)\mapsto((xy-1)^2+x^2,(xy-1)^2+y^2)
$$
satisfies that $\mathscr{A}\subset\FF(\R^2)\subset\Qu$. \em 
\begin{Proof}
Since $\FF_1$ and $\FF_2$ are positive on $\R^2$, the inclusion $\FF(\R^2) \subset \Qu$ is evident. To prove the other inclusion, we must show that for $(a,b)\in\mathscr{A}$ the system of polynomial equations
\begin{equation}\label{eq:systemF}
\left\{
\begin{aligned}
({\tt x}{\tt y}-1)^2+{\tt x}^2=a\\
({\tt x}{\tt y}-1)^2+{\tt y}^2=b\\
\end{aligned}
\right.
\end{equation}
has a solution $(x_0,y_0)\in\R^2$. Set ${\tt z}:={\tt x}{\tt y}-1$ in order to rewrite the system \ref{eq:systemF} in terms of ${\tt x}$ and ${\tt z}$. Since ${\tt y}=\frac{{\tt z}+1}{{\tt x}}$ we get:
\begin{equation}\label{eq:system2F}
\left\{
\begin{aligned}
&{\tt z}^2+{\tt x}^2&=a\\
&{\tt z}^2+\frac{({\tt z}+1)^2}{{\tt x}^2}&=b&.\\
\end{aligned}
\right.
\end{equation}
By eliminating ${\tt x}$ on the system \ref{eq:system2F} we deduce that ${\tt z}$ must be a root of the polynomial
$$
P({\tt z}):={\tt z}^4-(a+b+1){\tt z}^2-2{\tt z}+(ab-1)=0.
$$
Taking into account that $(a,b)\in\mathscr{A}$ satisfy that $a,b>0$ and $ab\ge1$, we notice that $P$ is a monic polynomial of even degree satisfying
$$
P(0)=ab-1\ge0\quad\text{ and }\quad P(\sqrt{a})=-2\sqrt{a}-a-1<0.
$$
Thus, $P$ has a real root $z_0$ such that $0\le z_0<\sqrt{a}$, so we set:
$$
x_0:=\sqrt{a-z_0^2}\quad \text{ and } \quad y_0:= \frac{z_0+1}{x_0}.
$$
Then $F(x_0,y_0)=(a,b)$ and $\mathscr{A}\subset\FF(\R^2)$, as required.
\qed
\end{Proof}
\end{lemma}
\end{subsection}

\begin{figure}[h]
\begin{subfigure}{.5\linewidth}\centering
\begin{tikzpicture}
\node[anchor=south west,inner sep=0] (img)at (0,0) {\includegraphics[width=1\textwidth]{plots/ch2_07_A.pdf}};
\path ($(img.north west)!0.6!(img.north east)$)|-coordinate(c1)($(img.south east)!0.7!(img.north east)$);% c1: lugar donde poner \mathscr{A}
\draw (c1) node {\huge{$\mathscr{A}$}};
\end{tikzpicture}
\caption{$\mathscr{A}=\set{xy\ge 1}\ \cap\, \Qu$.\label{fig:setA}}
\end{subfigure}
\hspace{-0.2cm}
\begin{subfigure}{.5\linewidth}\centering
\begin{tikzpicture}
\node[anchor=south west,inner sep=0] (img)at (0,0) {\includegraphics[width=1\textwidth]{plots/ch2_08_B.pdf}};
\path ($(img.north west)!0.6!(img.north east)$)|-coordinate(c1)($(img.south east)!0.7!(img.north east)$);% c1: lugar donde poner \mathscr{B}
\draw (c1) node {\huge{$\mathscr{B}$}};
\end{tikzpicture}
\caption{$\mathscr{B}=\mathscr{A}\cup\set{y\ge x>0}$.\label{fig:setB}}
\end{subfigure}
\caption{Relevant sets for Lemmas \ref{lemma1}, \ref{lemma2} and \ref{lemma3}.\label{fig:setsAB}}
\end{figure}

\begin{subsection}{The second lemma}
\begin{lemma}\label{lemma2} \em Let $\mathscr{B}:=\mathscr{A}\cup\set{y\ge x>0}$. Then, the map
$$
\GG:=(\GG_1,\GG_2):\R^2\to\R^2,(x,y)\mapsto (x,\ y(xy-2)^2+x(xy-1)^2)
$$
satisfies that $\mathscr{B}\subset\GG(\mathscr{A})\subset\GG(\Qu)\subset\Qu$. \em 
\begin{Proof}
The inclusion $\GG(\mathscr{A}) \subset \GG(\Qu)$ is trivial because $\mathscr{A}\subset\Qu$. The last inclusion $\GG(\Qu) \subset\Qu$ also holds since $\GG_1$ and $\GG_2$ are strictly positive on $\Qu$: if $x_0,y_0>0$ then $\GG_1(x_0,y_0)=x_0> 0$ and $\GG_2(x_0,y_0)=y_0(x_0y_0-2)^2+x_0(x_0y_0-1)^2>0$. Notice that $\GG_2(x_0,y_0)\ne0$. Otherwise there would exists a solution of the system of equations
\begin{equation*}
\left\{
\begin{aligned}
&{\tt x}{\tt y}-1=0\\
&{\tt x}{\tt y}-2=0,\\
\end{aligned}
\right.
\end{equation*}
which is not possible.

\vspace{1mm}

Now we can focus on proving $\mathscr{B} \subset \GG(\mathscr{A})$. First of all, notice that we can express the set $\mathscr{B}$ as a union of closed half-lines. Precisely, for each $x>0$ let $\mathscr{B}_x:=[y_x,+\infty)$, where $y_x:=\text{min}\set{x,1/x}$ and notice that
$$
\mathscr{B}=\bigsqcup_{x>0}(\set{x}\times\mathscr{B}_x).
$$
That is, we are ``slicing'' the set $\mathscr{B}$ vertically, depending on $x$. Now look at the definition of the polynomial $\GG_2$ and consider for each $x>0$ the polynomial $\phi_x\in\R[{\tt y}]$ (dependent on the variable ${\tt y})$:
$$
\phi_x({\tt y}):={\tt y}(x{\tt y}-2)^2+x(x{\tt y}-1)^2=x^2{\tt y}^3+(x^3-4x){\tt y}^2+(4-2x^2){\tt y}+x.
$$
The polynomials $\phi_x({\tt y})$ have odd degree and positive leading coefficient since $x > 0$. Now notice that if we fix $x_0 > 0$ then we get the following sequence of inclusions:
\begin{equation*}
\begin{aligned}
\phi_{x_0}(&[1/x_0,+\infty))\ \supset ^1 \ \phi_{x_0}([2/x_0,+\infty))\\
&\quad \quad \ \rotatebox[origin=c]{90}{$\subset$}\,^2 \hspace{3cm} \rotatebox[origin=c]{90}{$\subset$}\,^3\\
&[1/x_0,+\infty) \hspace{1.9cm}[x_0, +\infty) \\
\end{aligned}
\end{equation*}
Inclusion $^1$ follows from the fact that $[1/x_0, +\infty) \supset [2/x_0, +\infty)$ (notice that for $x>0$ the graph of the map $2/x$ is ``above'' the one of $1/x$). Inclusion $^2$ and $^3$ follow from the fact that $\phi_{x_0}({\tt y})$ has positive leading coefficient and the computation of the images of $1/x_0$ and $2/x_0$ through $\phi_{x_0}({\tt y})$:
\begin{equation*}
\begin{aligned}
\phi_{x_0}\left(\frac{1}{x_0}\right)&=\frac{1}{x_0}+\left((x_0^3-4x_0)\frac{1}{x_0^2}+(4-2x_0^2)\frac{1}{x_0}+x_0\right)= \frac{1}{x_0}\\
\phi_{x_0}\left(\frac{2}{x_0}\right)&=\left(\frac{8}{x_0}+(x_0^3-4x_0)\frac{4}{x_0^2}+(4-2x_0^2)\frac{2}{x_0}\right)+x_0= x_0.\\
\end{aligned}
\end{equation*}
Now it is clear that:
$$
\mathscr{B}_x=[y_x,+\infty)\subset\phi_x([1/x, +\infty)).
$$
Then we can prove the desired inclusion in this way:
$$
\mathscr{B}=\bigsqcup_{x>0}\big(\set{x}\times\mathscr{B}_x\big)\subset\bigsqcup_{x>0}\big(\set{x}\times\phi_x([1/x,+\infty))\big)=\bigsqcup_{x>0}\GG\big(\set{x}\times[1/x,+\infty)\big)=\GG(\mathscr{A}),
$$
which concludes the proof.
\qed
\end{Proof}
\end{lemma}
\end{subsection}

\begin{center}
\begin{figure}[h]
\begin{subfigure}{.49\linewidth}\centering
\begin{tikzpicture}
\node[anchor=south west,inner sep=0] (img)at (0,0) {\includegraphics[width=1\textwidth]{plots/ch2_09_B_vert.pdf}};
\path ($(img.north west)!0.8!(img.north east)$)|-coordinate(c1)($(img.south east)!0.8!(img.north east)$); % Para \mathscr{B}
\path ($(img.north west)!0.1!(img.north east)$)|-coordinate(c2)($(img.south east)!0.89!(img.north east)$); % Para la flecha de x_0
\path ($(img.north west)!0.613!(img.north east)$)|-coordinate(c3)($(img.south east)!0.89!(img.north east)$); % Para la flecha de x_1
\path ($(img.north west)!0.1!(img.north east)$)|-coordinate(c4)($(img.south east)!0.105!(img.north east)$); % Para [
\path ($(img.north west)!0.613!(img.north east)$)|-coordinate(c5)($(img.south east)!0.101!(img.north east)$); % Para [
\path ($(img.north west)!0.1!(img.north east)$)|-coordinate(c6)($(img.south east)!0.01!(img.north east)$); % Para x_0
\path ($(img.north west)!0.613!(img.north east)$)|-coordinate(c7)($(img.south east)!0.01!(img.north east)$); % Para x_1
\path ($(img.north west)!0.26!(img.north east)$)|-coordinate(c8)($(img.south east)!0.55!(img.north east)$); % Para B_{x_0}
\path ($(img.north west)!0.77!(img.north east)$)|-coordinate(c9)($(img.south east)!0.35!(img.north east)$); % Para B_{x_1}
\draw (c1) node {\huge{$\mathscr{B}$}};
\draw (c2) node {\Large{\color[rgb]{0,0.392157,0}{$\uparrow$}}};
\draw (c3) node {\Large{\color[rgb]{1,0,0}{$\uparrow$}}};
\draw (c4) node {\large{\color[rgb]{0,0.392157,0}{\rotatebox[origin=c]{90}{[}}}};
\draw (c5) node {\large{\color[rgb]{1,0,0}{\rotatebox[origin=c]{90}{[}}}};
\draw (c6) node {\large{\color[rgb]{0,0.392157,0}{$x_0$}}};
\draw (c7) node {\large{\color[rgb]{1,0,0}{$x_1$}}};
\draw (c8) node {\large{\color[rgb]{0,0.392157,0}{$\set{x_0} \times \mathscr{B}_{x_0}$}}};
\draw (c9) node {\large{\color[rgb]{1,0,0}{$\set{x_1} \times \mathscr{B}_{x_1}$}}};
\end{tikzpicture}
\caption{$\mathscr{B} = \bigsqcup_{x>0}(\set{x} \times \mathscr{B}_{x})$.\label{fig:Bvert}}
\end{subfigure}
\begin{subfigure}{.49\linewidth}\centering
\begin{tikzpicture}
\node[anchor=south west,inner sep=0] (img)at (0,0) {\includegraphics[width=1\textwidth]{plots/ch2_10_B_hor.pdf}};
\path ($(img.north west)!0.6!(img.north east)$)|-coordinate(c1)($(img.south east)!0.7!(img.north east)$);% c1: lugar donde poner \mathscr{B}
\path ($(img.north west)!0.8!(img.north east)$)|-coordinate(c1)($(img.south east)!0.8!(img.north east)$); % Para \mathscr{B}
\path ($(img.north west)!0.9!(img.north east)$)|-coordinate(c2)($(img.south east)!0.604!(img.north east)$); % Para la flecha de y_0
\path ($(img.north west)!0.9!(img.north east)$)|-coordinate(c3)($(img.south east)!0.1492!(img.north east)$); % Para la flecha de y_1
\path ($(img.north west)!0.045!(img.north east)$)|-coordinate(c4)($(img.south east)!0.61!(img.north east)$); % Para (
\path ($(img.north west)!0.045!(img.north east)$)|-coordinate(c5)($(img.south east)!0.154!(img.north east)$); % Para (
\path ($(img.north west)!0.146!(img.north east)$)|-coordinate(c10)($(img.south east)!0.154!(img.north east)$); % Para ]
\path ($(img.north west)!0.335!(img.north east)$)|-coordinate(c11)($(img.south east)!0.154!(img.north east)$); % Para [
\path ($(img.north west)!0.008!(img.north east)$)|-coordinate(c6)($(img.south east)!0.61!(img.north east)$); % Para y_0
\path ($(img.north west)!0.008!(img.north east)$)|-coordinate(c7)($(img.south east)!0.154!(img.north east)$); % Para y_1
\path ($(img.north west)!0.25!(img.north east)$)|-coordinate(c8)($(img.south east)!0.66!(img.north east)$); % Para B_{y_0}
\path ($(img.north west)!0.65!(img.north east)$)|-coordinate(c9)($(img.south east)!0.2!(img.north east)$); % Para B_{y_1}
\draw (c1) node {\huge{$\mathscr{B}$}};
\draw (c2) node {\Large{\color[rgb]{0,0.392157,0}{$\rightarrow$}}};
\draw (c3) node {\Large{\color[rgb]{1,0,0}{$\rightarrow$}}};
\draw (c4) node {\large{\color[rgb]{0,0.392157,0}{(}}};
\draw (c5) node {\large{\color[rgb]{1,0,0}{(}}};
\draw (c10) node {\large{\color[rgb]{1,0,0}{]}}};
\draw (c11) node {\large{\color[rgb]{1,0,0}{[}}};
\draw (c6) node {\large{\color[rgb]{0,0.392157,0}{$y_0$}}};
\draw (c7) node {\large{\color[rgb]{1,0,0}{$y_1$}}};
\draw (c8) node {\large{\color[rgb]{0,0.392157,0}{$\mathscr{C}_{y_0} \times \set{y_0}$}}};
\draw (c9) node {\large{\color[rgb]{1,0,0}{$\mathscr{C}_{y_1} \times \set{y_1}$}}};
\end{tikzpicture}
\caption{$\mathscr{B}=\bigsqcup_{y>0}(\mathscr{C}_{y}\times\set{y})$.\label{fig:Bhor}}
\end{subfigure}
\caption{Idea of how we represent the set $\mathscr{B}$ in Lemmas \ref{lemma2} and \ref{lemma3}.\label{fig:sliceB}}
\end{figure}
\end{center}

\begin{subsection}{The third lemma}
\begin{lemma}\label{lemma3} \em The polynomial map 
$$
\HH:=(\HH_1,\HH_2):\R^2\to\R^2,(x,y)\mapsto(x(xy-2)^2+\tfrac{1}{2}xy^2,\ y)
$$
satisfies $\HH(\mathscr{B})=\HH(\Qu)=\Qu$. \em 
\begin{Proof}
The inclusion $\HH(\mathscr{B})\subset\HH(\Qu)$ is trivial because $\mathscr{B}\subset\Qu$. As for $\HH(\Qu)\subset\Qu$, since $\HH_1$ and $\HH_2$ are strictly positive on $\Qu$ the inclusion holds.

\vspace{1mm}

We proceed now to prove that $\Qu\subset\HH(\mathscr{B})$ and therefore get $\Qu\subset\HH(\mathscr{B})\subset\HH(\Qu) \subset\Qu$, which implies that $\HH(\mathscr{B})=\HH(\Qu)=\Qu$.

Firstly, notice that the set $\mathscr{B}$ can be expressed as follows:
$$
\mathscr{B}=\bigsqcup_{y>0}(\mathscr{C}_y\times\set{y}),\quad\text{ where } \mathscr{C}_y:= 
\left\{
\begin{array}{ll}
(0,+\infty)&\text{ if } y \ge 1,\\
(0,y]\cup[1/y,+\infty) & \text { if } 0<y<1.
\end{array}
\right.
$$
Intuitively, we are ``slicing'' the set $\mathscr{B}$ horizontally, depending on $y$. Looking at the definition of $\HH_1$ we define for each $y>0$ the polynomial $\psi_y$ dependent on the variable ${\tt x}$:
$$
\psi_y({\tt x}):={\tt x}(y{\tt x}-2)^2+\tfrac{1}{2}y^2{\tt x}=y^2{\tt x}^3-4y{\tt x}^2+(4+\tfrac{1}{2}y^2){\tt x}.
$$
Notice first that $\psi_y({\tt x})$ has odd degree, positive leading coefficient and the following properties:
$$
\begin{array}{llcll}
\text{(i)}&\lim_{x\rightarrow+\infty}\psi_y(x)=+\infty. & &
\text{(iii)}&\psi_y(y)=y((y^2-2)^2+\tfrac{1}{2}y^2)>y\text{ for } 0<y<1.\\
\text{(ii)}&\psi_y(0)=0. & &
\text{(iv)}&\psi_y\left(\tfrac{2}{y}\right)=y.\\
\end{array}
$$
Property (iii) holds because $(y^2-2)^2+\tfrac{1}{2}y^2>1$ when $0<y<1$. Next, we are going to show that:
$$
\!\psi_y(\mathscr{C}_y) \!=\!
\left\{ \def\arraystretch{1.5}
\begin{array}{ll} 
\! \! \psi_y((0,+\infty))=^1(0,+\infty) & \!\!\! \text{ if } y \ge 1,\\
\! \! \psi_y\big((0,y]\cup \big[\frac{1}{y}, +\infty\big)\big) \supset^2 (0, \psi_y(y)] \cup \big[\psi_y\big(\tfrac{2}{y}\big),+\infty\big)=^3(0,+\infty)& \!\!\! \text{ if } 0<y<1.
\end{array}
\right.
$$
Equality $^1$ holds because of (i), (ii) and the fact that $\psi_y$ is strictly positive on $(0, +\infty)$. Inclusion $^2$  follows from the fact that $[1/y_0,+\infty)\supset[2/y_0,+\infty)$ for each fixed $y_0$. Finally, equality $^3$ holds because of (iii) and (iv): $\psi_y(y) > y = \psi_y\big(\tfrac{2}{y}\big)$.

Then we can write:
$$
\Qu=\bigsqcup_{y>0}\big((0,+\infty)\times\set{y}\big)\subset \bigsqcup_{y>0}\big(\psi_y(\mathscr{C}_y)\times\set{y}\big)= \bigsqcup_{y>0}\HH\big(\mathscr{C}_y\times\set{y}\big)=\HH(\mathscr{C}_y),
$$
which concludes the proof.
\qed
\end{Proof}
\end{lemma}
\end{subsection}

\begin{subsection}{The second proof for the open quadrant problem}
To wrap up this chapter, we can now write the proof of Theorem \ref{openQuad} relying on Lemmas \ref{lemma1}, \ref{lemma2} and \ref{lemma3}:

\vspace{1mm}

[Proof of Theorem \ref{openQuad}] Applying the lemmas, we deduce that
$$
\Qu \overset{\ref{lemma3}}{=}\HH(\mathscr{B})\overset{\ref{lemma2}}{\subset}(\HH\circ\GG)(\mathscr{A}) \overset{\ref{lemma1}}{\subset}(\HH\circ\GG\circ\FF)(\R^2)\overset{\ref{lemma1}}{\subset}(\HH\circ\GG)(\Qu) \overset{\ref{lemma2}}{\subset}\HH(\Qu)\overset{\ref{lemma3}}{=}\Qu,
$$
which means 
$$
(\HH\circ\GG\circ\FF)(\R^2)=\Qu,
$$
as required.
\qed
\end{subsection}


%%Ejemplo de como introducir texto con TikZ, con una rejilla de ayuda
%--------------------------------------------------------------------%
%\begin{figure}[h]
%\begin{tikzpicture}
%\node[anchor=south west,inner sep=0] (img)at (0,0) {\includegraphics[width=\textwidth]{plots/ch1_15_nice_plot.pdf}};
%\foreach \xx in {0,1,2,...,9}{
%\draw[dashed] ($(img.north west)!0.\xx!(img.north east)$)node[above]{0.\xx} --  ($(img.south west)!0.\xx!(img.south east)$);
%\draw[dashed] ($(img.south east)!0.\xx!(img.north east)$)node[right]{0.\xx} --  ($(img.south west)!0.\xx!(img.north west)$);
%}
%\path ($(img.north west)!0.1!(img.north east)$)|-coordinate(c1)($(img.south east)!0.3!(img.north east)$);% c1: first corner
%\path ($(img.north west)!0.82!(img.north east)$)|-coordinate(c2)($(img.south east)!0.77!(img.north east)$);   %c2 : second corner
%\draw[red,ultra thick,rounded corners] (c1)         rectangle (c2);
%\draw (c1) node {\huge{$\mathscr{A}$}};
%\draw (c2) node[below] {\huge{$\mathscr{B}$}};
%\end{tikzpicture}
%\caption{M1} \label{fig:M1}
%\end{figure}
%--------------------------------------------------------------------%

\end{section}
\end{chapter}

\begin{chapter}{A topological proof for the open quadrant $\Qu$ problem}
\begin{section}{A topological perspective}
%Modificad cualquier cosa que no os convenza o que no sea totalmente cierta de esta introduccion:
Although Fernando, Gamboa and Ueno proved that the open quadrant $\Qu$ is the image of $\R^2$ under two distinct polynomial maps using very different techniques, they developed quite recently in \cite{fgu} a completely new proof that relies on algebraic topology methods applied to a new polynomial map $\FFF: \R^2 \longrightarrow \R^2$. The genesis of this third proof appears in Ueno's Ph.D. \cite{u} written under the supervision of Fernando. 

In this chapter we will build up the topological machinery necessary to prove theorem \ref{openQuad} in a very geometrical way, and completely avoiding the aid of computer calculations.
\begin{subsection}{The new polynomial map}
Without further ado, the polynomial map we are going to work with is denoted $\FFF$ and it is defined as:
\begin{equation*}\label{eq:thirdMap}
\boxed{
\FFF({\tt x}, {\tt y}) := \big(({\tt x}^2{\tt y}^4+{\tt x}^4{\tt y}^2-{\tt y}^2-1)^2+{\tt x}^6{\tt y}^4,\ ({\tt x}^6{\tt y}^2+{\tt x}^2{\tt y}^2-{\tt x}^2-1)^2+{\tt x}^6{\tt y}^4\big).
}
\end{equation*}

As we announced before, in Section \ref{TTT} we will introduce some definitions and prove some facts about a family of topological subspaces of $\R^3$ homeomorphic to a closed disc, and paths that go through them.

\vspace{1mm}

Afterwards, after factorizing $\FFF=f_2\circ f_1$ with $f_2=h\circ g$, it will be clear that the proof is reduced to check that the boundaries of two certain topological subspaces of $\R^3$ homeomorphic to a closed disc meet $g(\overline{\Qu})$, where $\overline{\Qu}:=\set{x\ge 0,y\ge 0}$ is the closed quadrant.
\end{subsection}
\end{section}
\begin{section}{Topological tools}\label{TTT}
\begin{subsection}{Some definitions}\label{topDefs}
We begin by defining the key topological manifolds we are going to work with.
\begin{definitions}
(i) Let ${\mathbb D}_A:=\set{(x,y):x^2+y^2\le A^2}\subset\R^2$ be the closed disc of center the origin and radius $A>0$. A \textit{warped disc} is a subset 
$$
\D_{A,\xi}:=\set{(x,y,z):x^2+y^2\le A^2,\ z=\xi(x,y)}\subset\R^3$$
where $\xi:\R^2\longrightarrow\R$ is a continuous function. Let $\zeta$ be the homeomorphism
$$
\zeta:\R^3\longrightarrow\R^3,\ (x,y,z)\longmapsto\big(x,\, y,\, z-\xi(x,y)\big).
$$
Clearly $\zeta(\D_{A,\xi})={\mathbb D}_A\times\{0\}$ is the projection or ``flattening'' of the warped disc $\D_{A,\xi}$ onto the plane $\{z=0\}\subset\R^3$. We will also call a warped disc the image of $\D_{A,\xi}$ under a permutation of the variables of $\R^3$; namely
\begin{equation*}
\begin{aligned}
\D_{A,\xi}:=\set{(x,y,z): y^2+z^2\le A^2,\ x=\xi(y,z)}& \ \text{ or } \\
\D_{A,\xi}:=\set{(x,y,z): x^2+z^2\le A^2,\ y=\xi(x,z)}&,
\end{aligned}
\end{equation*}
with $\xi$ defined as above.

\vspace{1mm}

(ii) For each $\eps>0$ let us define the following  open neighbourhood of ${\mathbb D}_A$: 
$$
{\mathbb D}_A(\eps):=\set{(x,y):x^2+y^2<(A+\eps)^2}\times(-\eps,\eps)\subset\R^3.
$$ 
As $\zeta$ is a homeomorphism, $\D_{A,\xi}(\eps):=\zeta^{-1}\big({\mathbb D}_A(\eps)\big)\subset\R^3$ is an open neighbourhood of the warped disc $\D_{A,\xi}$. 
\end{definitions}

Next, we recall the notions of \emph{path} and \emph{path concatenation}. Also, we will recall the concept of  \emph{fundamental group} of a (path connected) topological space.

\vspace{1mm}

\begin{definitions}\label{pathDefs}
(i) Let $X$ be a topological space. A continuous map $\alpha:[a,b]\to X$, where $[a,b]\subset\R$ is a closed interval is a \emph{path} in $X$. If $\alpha(a)=\alpha(b)=x_0\in X$, we say that $\alpha$ is a \emph{loop} with base point $x_0$. In such a case, $\alpha$ may be viewed as a map whose domain is the quotient space $[a,b]/\!\sim$ obtained by identifying the end points of $[a,b]$. Notice that $[a,b]/\!\sim$ is homeomorphic to the circumference $\mathbb{S}^1:=\set{(x,y):x^2+y^2=1}\subset\R^2$. After a linear change of variables we may assume, if necessary, that $[a,b]=[0,1]$.

\vspace{1mm}

(ii) Given two paths $\alpha:[0,1]\to X$ and $\beta:[0,1]\to X$ such that  $\alpha(1)=\beta(0)$ the \em concatenation \em (also called \em product \em) of $\alpha$ and $\beta$ is defined as follows:
$$
\alpha*\beta:[0,1]\longrightarrow X,\ t\longmapsto
\left\{\begin{array}{ll}
\alpha(2t) &\text{ if } 0\leq t\leq\tfrac{1}{2},\\
\beta(2t-1) &\text{ if } \tfrac{1}{2}\leq t\leq1.
\end{array}
\right.
$$
The idea under this definition is clear. We use $\alpha$ in the "first part of the path", but the speed must be double of the original one to reach the point $\alpha(1)$ at $t:=\tfrac{1}{2}$. This explains the definition of the first part of the new path. We must use $\beta$ for the second part. Necessarily $(\alpha*\beta)\big(\tfrac{1}{2}\big)=\beta(0)$ and $(\alpha*\beta)(1)=\beta(1)$. To do that, we use the line that joints the points $p:=\big(\tfrac{1}{2},0\big)$ and $q:=(1,1)$, that is $\gamma(t):=2t-1$. Of course this is not at all the only way to construct a path joining $p$ and $q$, but seems to be the simplest one.

It is easily checked that the concatenation of loops enjoys the associative property. Besides, fixed $x_0\in X$, the constant loop $e_{x_0}:[0,1]\to X,\, t\mapsto x_0$ satisfies the equality $e_{x_0}*\alpha=\alpha=\alpha*e_{x_0}$ for every loop $\alpha$ in $X$ of basis $x_0$. In addition, given a loop $\alpha$ in $X$ the loop $\alpha^{-1}:[0,1]\to X, \, t\mapsto\alpha(1-t)$ that travels the same curve as $\alpha$ but in the opposite direction satisfies $\alpha*\alpha^{-1}=\alpha^{-1}*\alpha=e_{x_0}$.

\vspace{1mm}

(iii) Let $I:=[0,1]\subset\R$ and let $X,Y$ be two path-connected topological spaces. A \emph{homotopy} is a continuous map $H: X\times I\longrightarrow Y$. We associate to $H$ the family of continuous maps $\{H_s:X\to Y,\ x\mapsto H(x,s)\}_{s\in I}$, and it is said that the maps $H_0:X\to Y$ and $g:=H_1:X\to Y$ are \em homotopic. \em We denote this with $f\overset{H}{\simeq}g$. If, in addition, $g$ is constant we say that $f$ is \emph{null-homotopic}.

\vspace{1mm} 

(iv) Given a path-connected topological space $X$ and a point $x_0\in X$ we define the \emph{fundamental group of $X$ at the base point $x_0$} as the quotient space of loops of base $x_0$ modulo the ``homotopy relation'', and we denote it with $\pi_1(X,x_0)$. If $\alpha$ is a loop with base point $x_0$, then it represents an element of $\pi_1(X,x_0)$ denoted with $[\alpha]$. The concatenation of loops is compatible with the homotopy relation and endows $\pi_1(X,x_0)$ with an structure of group.

\vspace{1mm}

(v) We impose $X$ to be path connected to be sure that the fundamental groups $\pi_1(X,x_0)$ and $\pi_1(X,x_1)$ corresponding to two distinct points $x_0$ and $x_1$ in $X$ are isomorphic. Indeed, if $\gamma$ is a path in $X$ that connects $x_0$ and $x_1$ we associate to each loop $\alpha$ with base $x_0$ the loop of base $x_1$ defined as the product $\gamma\cdot\alpha\cdot\gamma^{-1}$. This construction is compatible with the homotopy relation, so it induces a homomorphism $\pi_1(X,x_0)\to\pi_1(X,x_1)$. This is in fact an isomorphism because we can associate to every loop $\beta$ with base $x_1$ the loop of base $x_0$ defined as the product $\gamma^{-1}\cdot\beta\cdot\gamma$. This is why it is usual to denote $\pi_1(X)$ the fundamental group of $X$ without any reference to the base point $x_0$. 
\end{definitions}

\vspace{1mm}

(vi) A path connected space $X$ is said to be \em simply connected \em if its fundamental group is trivial, that is, all loops are null-homotopic. Intuitively this means that all loops in $X$ are contractible to a point.

\vspace{1mm}

Next we explain the meaning of \emph{meeting transversally once a warped disc}, which is just a formalization of our intuition.

\begin{definitions} \label{pathDefs1}

(i) A path $\alpha:[a,b]\to\R^3$\emph{meets transversally once the warped disc $\D_{A,\xi}$} if there exist $s_0\in(a,b)$ and $\eps>0$ such that
$$
J:=\alpha^{-1}(\D_{A,\xi}(\eps))=(s_0-\eps,s_0+\eps)
$$
is an open subinterval of $[a,b]$ and 
$$
(\zeta\circ\alpha)|_J(t)=(0,0,t-s_0),
$$
where obviously $(\zeta\circ\alpha)|_J(t)\subset\mathbb{D}_A(\eps)$ because $\alpha|_J(t)\in\zeta^{-1}\big(\mathbb{D}_A(\eps)\big) = \D_{A,\xi}(\eps)$.

\vspace{1mm}

(ii) Let $C$ be a topological space homeomorphic to a closed disc and let $\phi:C\to\R^3$ be a continuous map. The restriction $\partial\phi:=\phi|_{\partial C}$ is called the \textit{boundary map} of $\phi$. We say that the boundary map $\partial\phi$ \emph{meets transversally once a warped disc} $\D_{A,\xi}\subset\R^3$ if there exists a parameterization $\beta:[a,b]\to\partial C\cong\mathbb{S}^1$ such that the path $\alpha:=\phi\circ\beta:[a,b]\to\R^3$ meets transversally once the warped disc $\D_{A,\xi}$.
\end{definitions}


\begin{remark}\label{remPath}
If the path $\alpha:[a,b]\to\R^3$ meets transversally once the warped disc $\D_{A,\xi}$, then $\alpha\big([a,b]\big)\cap\partial\D_{A,\xi}=\varnothing$. This will be helpful in the proof of Proposition \ref{propTop}.
\end{remark}
\end{subsection}

\begin{subsection}{Auxiliary results}
We proceed now to prove some facts that will be helpful later on to prove Theorem \ref{openQuad}. Firstly, we prove in Lemma \ref{lemmaFundGr} that if a loop meets transversaly once a warped disc, then the topological space $\R^3$ minus the border of the warped disc has $\Z$ as fundamental group. Figure \ref{fig:disc} helps to visualize the idea of the proof.

\begin{lemma}\label{lemmaFundGr} \em Let $\D_{A,\xi}\subset\R^3$ be a warped disc and let $X:=\R^3\setminus\partial\D_{A,\xi}$. Let $\alpha:[a,b]\to X$ be a loop with base point $x_0\in X$ that meets transversally once $\D_{A,\xi}$. Then $[\alpha]$ is a generator of $\pi_1(X,x_0)\cong{\mathbb Z}$. \em 
\begin{Proof} 
Using the notation introduced in Definitions \ref{pathDefs} and \ref{pathDefs1}, let $s_0\in(a,b)$ and $\eps>0$ be such that 
$$
J:=\alpha^{-1}\big(\D_{A,\xi}(\eps)\big)=(s_0-\eps,s_0+\eps)\subset[a,b]
$$ 
and $(\zeta\circ\alpha)|_J(t)=(0,0,t-s_0)$. We can assume $s_0=0$ after a reparameterization of $\alpha$; so $J=(-\eps,\eps)$ and $(\zeta\circ\alpha)|_J(t)=(0,0,t)$. Note that we can write the interval $[a,b]$ as $[a,-\eps]\cup(-\eps,\eps)\cup[\eps,b]$.

\vspace{1mm}

Since $\zeta$ is a homeomorphism of $\R^3$, instead of working in the warped disc we will prove the statement for ${\mathbb D}_A$ where $\beta:=\zeta\circ\alpha$, $Y:=\R^3\setminus\partial{\mathbb D}_A$ and the new base point is $y_0:=\beta(-\eps)=(0,0,-\eps)$. Consider the path $\gamma:[0,1]\to\R^3$ (see Figure \ref{fig:disc}) defined in the following way:
$$
\gamma(t):=
\begin{cases}
\big(3(A+\eps)t,\,0,\,\eps\big)&\text{if $0\le t\le\frac{1}{3}$,}\\
\big(A+\eps,\, 0,\, \eps-\big(t-\frac{1}{3}\big)6\eps\big)&\text{if $\frac{1}{3}<t\le \frac{2}{3}$,}\\
\big(A+\eps-3(A+\eps)\big(t-\frac{2}{3}\big),\, 0,\, -\eps\big)&\text{if $\frac{2}{3}<t\le 1$}.
\end{cases}
$$
Let $\beta_0:=\beta|_{J}=\beta|_{(-\eps,\eps)}$ and $\beta_1:=\beta|_{[\eps,b]}\ast\beta|_{[a,-\eps]}$. Using the properties of path concatenation we get:
$$
\quad[\beta]=[\beta_0\ast\beta_1]=\big[\beta_0\ast\big(\gamma\ast\gamma^{-1}\big)\ast\beta_1\big]=[\beta_0\ast\gamma]\,\cdot\,[\gamma^{-1}\ast\beta_1].
$$
We claim that $[\beta_0\ast\gamma]=g$ and $[\gamma^{-1}\ast\beta_1]=e$, where $g$ and $e$ are, respectively, a generator of $\pi_1(Y,y_0)\cong{\mathbb Z}$ and the identity element.

\begin{figure}[ht!]
\begin{center}
\begin{tikzpicture}[scale=0.8,line join=round,decoration={
    markings,
    mark=at position 0.5 with {\arrow[black!80,opacity=0.6]{>}}}]
\tikzstyle{estiloejes} = [line width=1pt]
\tikzstyle{estilodiscos} = [shading=radial]
\tikzstyle{estiloborde1} = [line width=2pt, draw=gray!70, rounded corners=8pt]
\tikzstyle{estiloborde2} = [line width=2pt, decorate]
%Mio
\tikzstyle{estiloborde3} = [line width=2pt, draw=red!70, rounded corners=8pt]
\tikzstyle{estiloborde4} = [line width=2pt, draw=black!50!blue, rounded corners=8pt]
\tikzstyle{estiloborde5} = [line width=2pt, draw=blue!70, rounded corners=8pt]
%------
\tikzstyle{estiloborde} = [line width=2pt]
\draw[estiloejes](-1.164,1.416)--(-1.947,2.368);
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](-.677,.688)--(-.677,2.214)--(-.203,2.248)--(-.203,.722)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](-.203,.722)--(-.203,2.248)--(.277,2.245)--(.277,.719)--cycle;
\draw[estiloejes](0,-3.816)--(0,3.8);
\filldraw[fill=gray!50,fill opacity=0.4,draw=black, dashed](-2.839,-1.316)--(-2.982,-1.093)--(-3.051,-.862)--(-3.045,-.628)--(-2.964,-.398)--(-2.81,-.177)--(-2.587,.03)--(-2.301,.217)--(-1.957,.38)--(-1.566,.515)--(-1.136,.618)--(-.677,.688)--(-.203,.722)--(.277,.719)--(.75,.679)--(1.204,.605)--(1.629,.496)--(2.014,.356)--(2.349,.189)--(2.626,-.001)--(2.839,-.211)--(2.982,-.433)--(3.051,-.665)--(3.045,-.898)--(2.964,-1.128)--(2.81,-1.349)--(2.587,-1.556)--(2.301,-1.743)--(1.957,-1.906)--(1.566,-2.041)--(1.136,-2.145)--(.677,-2.214)--(.203,-2.248)--(-.277,-2.245)--(-.75,-2.206)--(-1.204,-2.131)--(-1.629,-2.022)--(-2.014,-1.883)--(-2.349,-1.716)--(-2.626,-1.525)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](.277,.719)--(.277,2.245)--(.75,2.206)--(.75,.679)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](-1.136,.618)--(-1.136,2.145)--(-.677,2.214)--(-.677,.688)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](.75,.679)--(.75,2.206)--(1.204,2.131)--(1.204,.605)--cycle;
\draw[estiloejes](-1.136,1.382)--(-1.164,1.416);
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](-1.566,.515)--(-1.566,2.041)--(-1.136,2.145)--(-1.136,.618)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](1.204,.605)--(1.204,2.131)--(1.629,2.022)--(1.629,.496)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](-1.957,.38)--(-1.957,1.906)--(-1.566,2.041)--(-1.566,.515)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](1.629,.496)--(1.629,2.022)--(2.014,1.883)--(2.014,.356)--cycle;
\draw[estiloejes](1.136,-1.382)--(-1.136,1.382);
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](-2.301,.217)--(-2.301,1.743)--(-1.957,1.906)--(-1.957,.38)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](2.014,.356)--(2.014,1.883)--(2.349,1.716)--(2.349,.189)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](-2.587,.03)--(-2.587,1.556)--(-2.301,1.743)--(-2.301,.217)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](2.349,.189)--(2.349,1.716)--(2.626,1.525)--(2.626,-.001)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](-2.81,-.177)--(-2.81,1.349)--(-2.587,1.556)--(-2.587,.03)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](2.626,-.001)--(2.626,1.525)--(2.839,1.316)--(2.839,-.211)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](-3.045,-.628)--(-3.045,.898)--(-2.964,1.128)--(-2.964,-.398)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](-3.051,-.862)--(-3.051,.665)--(-3.045,.898)--(-3.045,-.628)--cycle;
\draw[estiloejes](2.839,.553)--(-2.839,-.553);
\draw[estiloejes](0,-.763)--(0,.038);
\filldraw[fill=gray!50,fill opacity=0.4,draw=black,dashed](-2.626,.001)--(-2.349,-.189)--(-2.014,-.356)--(-1.629,-.496)--(-1.204,-.605)--(-.75,-.679)--(-.277,-.719)--(.203,-.722)--(.677,-.688)--(1.136,-.618)--(1.566,-.515)--(1.957,-.38)--(2.301,-.217)--(2.587,-.03)--(2.81,.177)--(2.964,.398)--(3.045,.628)--(3.051,.862)--(2.982,1.093)--(2.839,1.316)--(2.626,1.525)--(2.349,1.716)--(2.014,1.883)--(1.629,2.022)--(1.204,2.131)--(.75,2.206)--(.277,2.245)--(-.203,2.248)--(-.677,2.214)--(-1.136,2.145)--(-1.566,2.041)--(-1.957,1.906)--(-2.301,1.743)--(-2.587,1.556)--(-2.81,1.349)--(-2.964,1.128)--(-3.045,.898)--(-3.051,.665)--(-2.982,.433)--(-2.839,.211)--cycle;
\draw[estiloborde5,decorate,decoration={
    markings,
    mark=at position 0.5 with {\arrow[blue!60,opacity=0.6]{>}}}](-2.839,-.514)--(-2.839,-1.316)--(-.081,-.779);
\draw[estiloborde,draw=blue!60](-2.839,-.514)--(-2.839,-1.316)--(-.081,-.779);
%beta_1 (clarito):
\draw[estiloborde3, opacity=1](-3.9,-.789)--(-3.893,-1.521)--(-3.731,-2.253)--(-3.244,-2.921)--(-2.433,-2.763)--(-1.622,-3.368)--(-.811,-3.211)--(0,-3.053)--(0,-1.526)--(0,-.763)--(0,.238)--(0,.763)--(0,1.526)--(-.811,2.132)--(-2.433,1.816)--(-3.244,2.421)--(-4.056,1.5)--(-4.056,.737)--cycle;
%Mi beta_0 (clarito):
\draw[estiloborde,draw=black!20!blue,opacity=1](-0,0)--(-0,-0.8);
%Disco naranja:
\filldraw[fill opacity=0.5,orange!90,line width=1pt,estilodiscos](-.973,1.222)--(-1.342,1.134)--(-1.678,1.018)--(-1.972,.878)--(-2.218,.718)--(-2.409,.541)--(-2.541,.351)--(-2.61,.154)--(-2.615,-.046)--(-2.556,-.244)--(-2.433,-.436)--(-2.251,-.615)--(-2.013,-.778)--(-1.726,-.922)--(-1.396,-1.041)--(-1.032,-1.134)--(-.643,-1.198)--(-.237,-1.232)--(.174,-1.234)--(.581,-1.206)--(.973,-1.146)--(1.342,-1.057)--(1.678,-.942)--(1.972,-.802)--(2.218,-.641)--(2.409,-.464)--(2.541,-.275)--(2.61,-.077)--(2.615,.123)--(2.556,.321)--(2.433,.512)--(2.251,.691)--(2.013,.855)--(1.726,.998)--(1.396,1.117)--(1.032,1.21)--(.643,1.275)--(.237,1.308)--(-.174,1.311)--(-.581,1.282)--cycle;
\draw[estiloejes,->](0,0)--(0,3.8);
%Mi beta_0 (oscuro):
\draw[estiloborde,draw=black!30!blue,opacity=0.9](-0,1.1)--(-0,0.01);
%beta_1 (oscuro):
\draw[estiloborde3,opacity=0.9](-3.9,-.789)--(-3.893,-1.521)--(-3.731,-2.253)--(-3.244,-2.921)--(-2.433,-2.763)--(-1.622,-3.368)--(-.811,-3.211)--(0,-3.053)--(0,-1.526)(0,.77)--(0,.663)--(0,1.526)--(-.811,2.132)--(-2.433,1.816)--(-3.244,2.421)--(-4.056,1.5)--(-4.056,.737);
\draw[estiloborde3,decorate,decoration={
    markings,
    mark=at position 0.5 with {\arrow[red!80,opacity=0.7]{>}}}]
(-3.98,1.)--(-4.056,-0.5);
\draw[estiloborde3,decorate,decoration={
    markings,
    mark=at position 0.5 with {\arrow[red!80,opacity=0.7]{>}}}]
(-1.622,-3.368)--(-.811,-3.211);
%Mi flecha
\draw[estiloborde4,decorate,decoration={
    markings,
    mark=at position 0.5 with {\arrow[black!30!blue,opacity=0.65]{>}}}]
(0,-0.5)--(0,1.25);
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](-2.964,-.398)--(-2.964,1.128)--(-2.81,1.349)--(-2.81,-.177)--cycle;
\draw[estiloejes](3.319,.646)--(2.911,.567);
\draw[estiloejes](2.911,.567)--(2.839,.553);
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](2.839,-.211)--(2.839,1.316)--(2.982,1.093)--(2.982,-.433)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](2.982,-.433)--(2.982,1.093)--(3.051,.862)--(3.051,-.665)--cycle;
\draw[estiloborde,draw=blue!70](-.081,.747)--(-2.839,.211)--(-2.839,-.514);
\draw[estiloborde5,decorate,decoration={
    markings,
    mark=at position 0.5 with {\arrow[blue!60,opacity=0.6]{>}}}](-.081,.747)--(-2.839,.211)--(-2.839,-.514);
\draw[fill=black, draw=none, fill opacity=0.5] (0,.747) circle (0.1cm);
\draw[fill=black, draw=none, fill opacity=0.3] (0,-.77) circle (0.1cm);
\draw[estiloejes](4.867,.947)--(3.319,.646);
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](3.051,-.665)--(3.051,.862)--(3.045,.628)--(3.045,-.898)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](-2.982,-1.093)--(-2.982,.433)--(-3.051,.665)--(-3.051,-.862)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](3.045,-.898)--(3.045,.628)--(2.964,.398)--(2.964,-1.128)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](-2.839,-1.316)--(-2.839,.211)--(-2.982,.433)--(-2.982,-1.093)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](2.964,-1.128)--(2.964,.398)--(2.81,.177)--(2.81,-1.349)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](-2.626,-1.525)--(-2.626,.001)--(-2.839,.211)--(-2.839,-1.316)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](2.81,-1.349)--(2.81,.177)--(2.587,-.03)--(2.587,-1.556)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](-2.349,-1.716)--(-2.349,-.189)--(-2.626,.001)--(-2.626,-1.525)--cycle;
\draw[estiloejes](-2.839,-.553)--(-2.911,-.567);
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](2.587,-1.556)--(2.587,-.03)--(2.301,-.217)--(2.301,-1.743)--cycle;
\draw[estiloejes](-2.911,-.567)--(-3.063,-.596);
\draw[estiloejes](-3.063,-.596)--(-3.319,-.646);
\draw[estiloejes,->](-3.319,-.646)--(-4.867,-.947);
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](-2.014,-1.883)--(-2.014,-.356)--(-2.349,-.189)--(-2.349,-1.716)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](2.301,-1.743)--(2.301,-.217)--(1.957,-.38)--(1.957,-1.906)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](-1.629,-2.022)--(-1.629,-.496)--(-2.014,-.356)--(-2.014,-1.883)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](1.957,-1.906)--(1.957,-.38)--(1.566,-.515)--(1.566,-2.041)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](-1.204,-2.131)--(-1.204,-.605)--(-1.629,-.496)--(-1.629,-2.022)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](1.566,-2.041)--(1.566,-.515)--(1.136,-.618)--(1.136,-2.145)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](-.75,-2.206)--(-.75,-.679)--(-1.204,-.605)--(-1.204,-2.131)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](1.136,-2.145)--(1.136,-.618)--(.677,-.688)--(.677,-2.214)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](-.277,-2.245)--(-.277,-.719)--(-.75,-.679)--(-.75,-2.206)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](.677,-2.214)--(.677,-.688)--(.203,-.722)--(.203,-2.248)--cycle;
\filldraw[fill=gray!50,fill opacity=0.4,draw=none](.203,-2.248)--(.203,-.722)--(-.277,-.719)--(-.277,-2.245)--cycle;
\draw[estiloejes](1.164,-1.416)--(1.136,-1.382);
\draw[estiloejes,<-](1.947,-2.368)--(1.164,-1.416);
\path (2.271,-2.763) node[left]{$y$} (-5.5,-1.2) node[above right]{$x$} (0,4.4) node[below]{$z$};\path (1.45,0) node[right]{${\mathbb D}_A$} (-0.1,-1.02) node[right]{$y_0$};
\path (0,0.85) node[right]{$y_1$};
\path [black!50!blue] (0.1,-0.1) node[right]{$\beta_0$};
\path (2.5,1.468) node[above right]{${\mathbb D}_A(\eps)$};
\path [red] (-4.3,-1.5) node[below]{$\beta_1$};
\path [blue!90] (-1.1,1.15) node[below]{$\gamma$};
\end{tikzpicture}
\caption[The loop $\beta=\beta_0\ast\beta_1$ meets transversally once the disk ${\mathbb D}_A$.]{The loop $\beta=\beta_0\ast\beta_1$ meets transversally once the disk ${\mathbb D}_A$. Here $y_0:=\beta(-\eps)$ and $y_1:=\beta(\eps)$, so the path $\beta_0$ goes from $y_0$ to $y_1$ (in purple), $\gamma$ goes from $y_1$ to $y_0$ (in blue) and $\beta_1$ goes from $y_1$ to $y_0$ (in red).}\label{fig:disc}
\end{center}
\end{figure}
Firstly, the loop $\gamma^{-1}\ast\beta_1$ with base point $y_0$ is contained in $\R^3\setminus{\mathbb D}_A$, which is a simply connected space. Thus the loop $\gamma^{-1}*\beta_1$ is null-homotopic and $[\gamma^{-1}*\beta_1]=e \in \pi_1(Y,y_0)$.

\vspace{1mm}

On the other hand, the class $[\beta_0\ast\gamma]$ generates $\pi_1(Y,y_0)$. Indeed, $Y$ has as deformation retract the set $Z:=\partial{\mathbb D}_A(\eps)\cup I_\eps$ where $\partial{\mathbb D}_A(\eps)$ is the boundary of ${\mathbb D}_A(\eps)$ and we denote $I_\eps:=\set{(0,0,z):-\eps\le z\le\eps}$. Finally, since $Z$ is homeomorphic to the union of a sphere and one of its diameters we deduce from Lemma \ref{lemmaZ} that $[\beta_0\ast\gamma]$ is a generator of $\pi_1(Z,y_0)\cong\pi_1(Y,y_0)\cong{\mathbb Z}$, as required.
\qed 
\end{Proof}
\end{lemma}

\vspace{1mm}

\begin{lemma}\label{lemmaZ} \em Let $S:=\set{(x,y,z):x^2+y^2+z^2=A^2}\subset\R^3$ be the sphere of center the origin and radius $A> 0$, let $D$ be one of its diameters and let $M := S\cup D$. If $x_0\in M$ then $\pi_1(M,x_0)\cong\Z$. \em 

\begin{Proof}
Let $x_0\in S\setminus D$ and let $U := M\setminus\set{x_0}$. Also, let $V$ be an small enough  neighbourhood of $x_0$ homeomorphic to a closed disc such that it does not meet the diameter $D$. It is clear that $M\cong U\cup V$. Consider  the group homomorphism
$$
\varphi:\pi_1(U\cap V,x_0)\to\pi_1(U,x_0)
$$
induced by the inclusion map ${\tt j}: (U\cap V)\hookrightarrow U$. As $V$ is a simply connected space, we deduce from the Theorem of Seifert and Van Kampen \cite[Chapter IV: $\mathsection$4, page 95]{m} that 
$$
\pi_1(M,x_0)=\bigslant{\pi_1(U,x_0)}{\text{im}(\varphi)}.
$$
Next, notice that $U$ is homeomorphic to the union of a closed disc with an arc that joints two points of the disc and that doesn't touch its border. Thus, $U$ has $\mathbb{S}^1$ as deformation retract and $\pi_1(U, x_0)\cong \Z$. In addition, as $U\cap V\cong V\setminus\set{x_0}$ the set $U\cap V$ is homeomorphic to a punctured disc, so $\pi_1(U\cap V, x_0)\cong \pi_1(\mathbb{S}^1,x_0) \cong \Z$, and notice that a generator of this fundamental group is a loop contained  in $S\setminus\set{x_0}\subset U$. As $S\setminus\set{x_0}$ is contractible, $\varphi(\pi_1(U\cap V, x_0))=0$, hence $\pi_1(M, x_0) = \pi_1(U, x_0)$ is generated by the class of a loop $\alpha$ as in Figure \ref{fig:sphereZ}. Consequently, $\pi_1(M, x_0)=\Z$ as required.
\qed
\end{Proof}
\end{lemma}

\begin{figure}[h]
\begin{center}
\begin{tikzpicture}
\draw[dashed] (-5,0) arc (180:0:5cm and 1.25cm);
\draw[dashed] (0,5) arc (90:-90:1.5cm and 5cm);
\draw (-3,4)--(0,0)--(3,-4);
\draw [line width=2pt, draw=blue!65, opacity=0.8,rounded corners=8pt] (-3,4)--(0,0)--(3,-4);
\draw (0,0) circle (5cm);
\shade[ball color=blue!10!white,opacity=0.30] (0,0) circle (5cm);
\draw (-5,0) arc (180:360:5cm and 1.25cm);
\draw (0,5) arc (90:270:1.5cm and 5cm);
\draw [line width=2pt, draw=blue!65, rounded corners=8pt] (-3,4) arc (120:-38:4.65cm and 5.4cm);
\draw[line width=2.5pt,rotate=180,decorate,decoration={
markings,
mark=at position 0.5 with {\arrow[black!30!blue,opacity=0.65]{>}}}]
(-4.2,0)--(-2.3,-4.5);
\draw[line width=2.5pt,rotate=218,decorate,decoration={
markings,
mark=at position 0.5 with {\arrow[black!10!blue,opacity=0.45]{>}}}]
(0,-1)--(0,1.45);
\path (-4.1,-4.1) node[right]{\Large{$S$}};
\path (-2.7,2.2) node[right]{\Large{$D$}};
\path [blue!85] (3,3) node[right]{\Large{$\alpha$}};
\end{tikzpicture}
\caption{The set $M:=S\cup D$ and a generator $\alpha$ of $\pi_1(M,x_0)$ from Lemma \ref{lemmaZ}.}\label{fig:sphereZ}
\end{center}
\end{figure}

\begin{lemma}\label{lemmaId} \em Let $C$ be a topological space homeomorphic to a closed disc and let $z_0\in\partial C$. Let $\phi:C\longrightarrow X$ be a continuous map and consider a parameterization $\beta:[a,b]\to\partial C$ such that $\beta(a)=z_0=\beta(b)$. Then $[\phi\circ\beta]$ is the identity element of $\pi_1\big(X,\phi(z_0)\big)$.\em
\begin{Proof} 
Let $\psi:C\to\{x^2+y^2\leq 1\}$ be a homeomorphism. Let $H$ be the continuous map
$$
H:[0,1]\times[a,b]\to X,\ (\rho,t)\mapsto\big(\phi\circ\psi^{-1}\big)\big(\rho\cdot(\psi\circ\beta)(t)+(1-\rho)\cdot\psi(z_0))\big).
$$
Notice that $H(0,t)=\phi(z_0)$ and that $H(1,t)=\phi\big(\beta(t)\big)$. Thus $H$ is a homotopy map between $\phi\circ\beta$ and the constant path, as required.
\qed
\end{Proof}
\end{lemma}

\begin{proposition}\label{propTop}
Let $C$ be a topological space homeomorphic to a closed disc and let $\phi:C\longrightarrow\R^3$ be a continuous map. If the boundary map $\partial\phi$ of $\phi$ meets transversally once a warped disc $\D\subset\R^3$, then $\partial\D\cap\phi\big(\overset{\circ}{C}\big)\neq\varnothing$.
\begin{Proof}
Suppose instead that $\partial\D\cap\phi\big(\overset{\circ}{C}\big)=\varnothing$. Since $\partial\phi$ meets transversally once $\D$ it follows from Remark \ref{remPath} that the image of $\partial C$ under the map $\phi$ does not intersect $\partial\D$. This alongside our initial asumption gives us that $\phi(C)\subset X:=\R^3\setminus\partial\D$.

\vspace{1mm}

Let $\beta:[a,b]\to\partial C$ be a parameterization such that $\beta(a)=z_0=\beta(b)$ for some point $z_0\in\partial C$ such that $\phi\circ\beta$ meets transversally once $\D$. By Lemma \ref{lemmaId} the class $[\phi\circ\beta]$ is the identity element of $\pi_1\big(X,\phi(z_0)\big)$. However $[\phi\circ\beta]$ generates, by Lemma \ref{lemmaFundGr}, the group $\pi_1\big(X,\phi(z_0)\big)\cong\Z$, which leads to a contradiction. Thus, $\partial\D\cap\phi\big(\overset{\circ}{C}\big)\neq\varnothing$, as desired.
\qed
\end{Proof}
\end{proposition}
\end{subsection}
\end{section}

\begin{section}{The topological proof for the open quadrant problem}

\begin{subsection}{Factorizing $\FFF$}
The authors observed in \cite[Section 3]{fgu} that the map $\FFF$ can be factorized as $\FFF=f_2\circ f_1$, where the polynomial maps $f_1, f_2$ are defined as follows:
\begin{align*}
&f_1:\R^2\longrightarrow\R^2,\quad (x,y)\longmapsto\big(x^2,\,y^2\big),\\
&f_2:\R^2\longrightarrow\R^2,\quad (x,y)\longmapsto\big((xy^2+x^2y-y-1)^2+x^3y^2,\,(x^3y+xy-x-1)^2+x^3y^2\big).
\end{align*}
Since $f_1\big(\R^2\big)=\overline{\Qu}$ it is then clear that we just need to prove that
\begin{equation}
f_2\big(\overline{\Qu}\big)=\Qu.
\end{equation}
Note that both components of $f_2$ are strictly positive on $\overline{\Qu}$ so the inclusion $f_2(\overline{\Qu})\subset\Qu$ holds. We need to prove the converse inclusion:
\begin{equation}\label{mainTop}
\Qu\subset f_2\big(\overline{\Qu}\big).
\end{equation}
Indeed $f_2=h\circ g$, where the continuous semialgebraic maps $g, h$ are defined as:
$$
\arraycolsep=2pt\def\arraystretch{1.2}
\begin{array}{crlcl}
g:&\overline{\Qu}\longrightarrow\R^3,&\ (x,y)&\longmapsto&\big(xy^2+x^2y-y-1,\,x^{3/2}y,\,x^3y+xy-x-1\big),\\
h:&\R^3\longrightarrow\R^2,&\ (x,y,z)&\longmapsto&\big(x^2+y^2,\,y^2+z^2\big).\\
\end{array}
$$
In this way we can reduce the proof to show that for each pair of positive real numbers $(A^2,B^2)\in\Qu$ there exists a point $(x_0,y_0)\in\overline{\Qu}$ such that $(h\circ g)(x_0,y_0)=(A^2,B^2)$. This is equivalent to check that
\begin{equation*}
\boxed{
\forall\, \,  (A^2,B^2)\in\Qu:\ h^{-1}\big(\set[\big]{(A^2,B^2)}\big)\ \bigcap\ g\big(\overline{\Qu}\big)\ne\varnothing.
}
\end{equation*}

Let $\Ss:=g\big(\overline{\Qu}\big)$ and fix values $B\ge A>0$. By the definition of $h$ we know that
\begin{align*}
&h^{-1}\big(\set{(A^2,B^2)}\big)=\set[\big]{(x,y): x^2+y^2=A^2,\,y^2+z^2=B^2}\subset\R^2 \, \, \text{ and}\\
&h^{-1}\big(\set{(B^2,A^2)}\big)=\set[\big]{(x,y): y^2+z^2=A^2,\,x^2+y^2=B^2}\subset\R^2.
\end{align*} 
Both of them are the intersection of two orthogonal cylinders. Besides, these sets contain, respectively, the boundaries of the warped discs
\begin{align}
&\D_1:= \set{(x,y,z): x^2+y^2\le A^2,\,z=\xi_1(x,y)} \, \, \text{ and}\label{d1}\\
&\D_2:= \set{(x,y,z): y^2+z^2\le A^2,\,x=\xi_2(y,z)},\label{d2}
\end{align}
for the continuous and semialgebraic functions
\begin{align}
&\xi_1:\R^2\longrightarrow\R,\ (x,y)\longmapsto\sqrt{B^2-\min\{y^2,B^2\}},\label{xi1}\\
&\xi_2:\R^2\longrightarrow\R,\ (y,z)\longmapsto\sqrt{B^2-\min\{y^2,B^2\}},\label{xi2}
\end{align}
see Figure \ref{fig:homeo}.

%% IMAGEN COMENTADA
\begin{comment}
\begin{figure}[!ht]
\begin{center}
\begin{tikzpicture}
\pgfplotsset{ticks=none}
\begin{axis}[view={45}{30}, scale=1.8, axis lines=middle, footnotesize,xlabel=$$,ylabel=$$,
xmin=-5.5,xmax=5.5,ymin=-9.5,ymax=9.5,zmin=-1,
zmax=9, unit vector ratio=]
\addplot3[opacity=0.0, fill opacity=0.2, surf, gray, samples=5,
variable=\u, variable y=\v,
domain=-5:5, y domain=-9:-3]
({u}, {v}, {0});
\addplot3[opacity=0.0, fill opacity=0.2, surf, gray, samples=5,
variable=\u, variable y=\v,
domain=-5:5, y domain=3:9]
({u}, {v}, {0});
\addplot3[opacity=0.0, fill opacity=0.2, surf, gray, samples=20,
variable=\u, variable y=\v,
domain=-5:5, y domain=0:180]
({u}, {3*cos(v)}, {3*sin(v)});
\addplot3[very thin,mark=,black] plot coordinates {
          (-5,-3,0)
          (-5,-9,0)
          (5,-9,0)
          (5,-3,0)};
\addplot3[very thin,mark=,black] plot coordinates {
          (-5,3,0)
          (-5,9,0)
          (5,9,0)
          (5,3,0)};
\addplot3[very thin,domain=0:pi,samples=20,samples y=0]
({-5},
{3*cos(deg(x))},
{3*sin(deg(x))});
\addplot3[very thin,domain=0:pi,samples=20,samples y=0]
({5},
{3*cos(deg(x))},
{3*sin(deg(x))});
%------
\addplot3[very thick,domain=0:2*pi,samples=40,samples y=0]
({2*cos(deg(x))},
{2*sin(deg(x))},
{sqrt(9-4*(sin(deg(x)))^2)});
\addplot3[opacity=0, fill opacity=0.5, surf,samples=40,gray,
variable=\u, variable y=\v,
domain=0:2, y domain=0:360]
({u*cos(v)},{u*sin(v)},{sqrt(9-u^2*(sin(v))^2)});
%------
\addplot3[opacity=0.0, fill opacity=0.2, surf,gray,samples=5,
variable=\u, variable y=\v,
domain=-5:5, y domain=-9:-3]
({u}, {v}, {2});
\addplot3[opacity=0.0, fill opacity=0.2, surf, gray,samples=5,
variable=\u, variable y=\v,
domain=-5:5, y domain=3:9]
({u}, {v}, {2});
\addplot3[opacity=0.0, fill opacity=0.2, surf, gray, samples=20,
variable=\u, variable y=\v,
domain=-5:5, y domain=0:180]
({u}, {3*cos(v)}, {2+3*sin(v)});
\addplot3[very thin,domain=0:pi,samples=20,samples y=0]
({-5},
{3*cos(deg(x))},
{2+3*sin(deg(x))});
\addplot3[very thin,domain=0:pi,samples=20,samples y=0]
({5},
{3*cos(deg(x))},
{2+3*sin(deg(x))});
\addplot3[very thin,mark=,black] plot coordinates {
          (-5,-3,2)
          (-5,-9,2)
          (5,-9,2)
          (5,-3,2)};
\addplot3[very thin,mark=,black] plot coordinates {
          (-5,3,2)
          (-5,9,2)
          (5,9,2)
          (5,3,2)};
%----
\addplot3[opacity=0.0, fill opacity=0.3, surf,gray,samples=5,
variable=\u, variable y=\v,
domain=-5:5, y domain=-9:-3]
({u}, {v}, {4});
\addplot3[opacity=0.0, fill opacity=0.2, surf, gray,samples=5,
variable=\u, variable y=\v,
domain=-5:5, y domain=3:9]
({u}, {v}, {4});
\addplot3[opacity=0.0, fill opacity=0.2, surf, gray, samples=20,
variable=\u, variable y=\v,
domain=-5:5, y domain=0:180]
({u}, {3*cos(v)}, {4+3*sin(v)});
\addplot3[very thin,domain=0:pi,samples=20,samples y=0]
({-5},
{3*cos(deg(x))},
{4+3*sin(deg(x))});
\addplot3[very thin,domain=0:pi,samples=20,samples y=0]
({5},
{3*cos(deg(x))},
{4+3*sin(deg(x))});
\addplot3[very thin,mark=,black] plot coordinates {
          (-5,-3,4)
          (-5,-9,4)
          (5,-9,4)
          (5,-3,4)};
\addplot3[very thin,mark=,black] plot coordinates {
          (-5,3,4)
          (-5,9,4)
          (5,9,4)
          (5,3,4)};
%----
\addplot3[opacity=0.0, fill opacity=0.2, surf,gray,samples=5,
variable=\u, variable y=\v,
domain=-5:5, y domain=-9:-3]
({u}, {v}, {6});
\addplot3[opacity=0.0, fill opacity=0.2, surf, gray,samples=5,
variable=\u, variable y=\v,
domain=-5:5, y domain=3:9]
({u}, {v}, {6});
\addplot3[opacity=0.0, fill opacity=0.2, surf, gray, samples=20,
variable=\u, variable y=\v,
domain=-5:5, y domain=0:180]
({u}, {3*cos(v)}, {6+3*sin(v)});
\addplot3[very thin,domain=0:pi,samples=20,samples y=0]
({-5},
{3*cos(deg(x))},
{6+3*sin(deg(x))});
\addplot3[very thin,domain=0:pi,samples=20,samples y=0]
({5},
{3*cos(deg(x))},
{6+3*sin(deg(x))});
\addplot3[very thin,mark=,black] plot coordinates {
          (-5,-3,6)
          (-5,-9,6)
          (5,-9,6)
          (5,-3,6)};
\addplot3[very thin,mark=,black] plot coordinates {
          (-5,3,6)
          (-5,9,6)
          (5,9,6)
          (5,3,6)};
%----
\end{axis}
\end{tikzpicture}

\vskip 0.3cm
\begin{tikzpicture}
%\draw[white,->] (0,0)--(1,3);
\draw [thick, ->] (0,0)--(0,-0.5) node [right] {$\zeta$} -- (0,-1);
\end{tikzpicture}
\vskip 0.3cm

\begin{tikzpicture}
\pgfplotsset{ticks=none}
\begin{axis}[view={45}{30}, scale=1.8, axis lines=middle, footnotesize,xlabel=$$,ylabel=$$,
xmin=-5.5,xmax=5.5,ymin=-9.5,ymax=9.5,zmin=-1,
zmax=9, unit vector ratio=]
\addplot3[opacity=0.0, fill opacity=0.2, surf,gray,samples=20,colormap/hot,
variable=\u, variable y=\v,
domain=-5:5, y domain=-9:9]
({u}, {v}, {0});
\addplot3[very thin,mark=,black] plot coordinates {
          (-5,-9,0)
          (-5,9,0)
          (5,9,0)
          (5,-9,0)
          (-5,-9,0)};
%---
\addplot3[very thick,domain=0:2*pi,samples=40,samples y=0]
({2*cos(deg(x))},
{2*sin(deg(x))},
{0});
\addplot3[opacity=0, fill opacity=0.5, surf,samples=40,gray,
variable=\u, variable y=\v,
domain=0:2, y domain=0:360]
({u*cos(v)},{u*sin(v)},{0});
%---
\addplot3[opacity=0.0, fill opacity=0.2, surf,gray,samples=20,colormap/hot,
variable=\u, variable y=\v,
domain=-5:5, y domain=-9:9]
({u}, {v}, {2});
\addplot3[very thin,mark=,black] plot coordinates {
          (-5,-9,2)
          (-5,9,2)
          (5,9,2)
          (5,-9,2)
          (-5,-9,2)};
\addplot3[opacity=0.0, fill opacity=0.2, surf,gray,samples=20,colormap/hot,
variable=\u, variable y=\v,
domain=-5:5, y domain=-9:9]
({u}, {v}, {4});
\addplot3[very thin,mark=,black] plot coordinates {
          (-5,-9,4)
          (-5,9,4)
          (5,9,4)
          (5,-9,4)
          (-5,-9,4)};
\addplot3[opacity=0.0, fill opacity=0.2, surf,gray,samples=20,colormap/hot,
variable=\u, variable y=\v,
domain=-5:5, y domain=-9:9]
({u}, {v}, {6});
\addplot3[very thin,mark=,black] plot coordinates {
          (-5,-9,6)
          (-5,9,6)
          (5,9,6)
          (5,-9,6)
          (-5,-9,6)};
\end{axis}
\end{tikzpicture}
\caption{The homeomorphism $\zeta$ for $\xi_1(x,y):=\sqrt{B^2-\min(y^2,B^2)}$ acting on $\R^3$. Notice how it ``flattens'' the warped disc $\D_1$.}\label{fig:homeo}
\end{center}
\end{figure}
\end{comment}

Now it is clear that our aim is to prove the following fact:

\begin{center}
\fbox{\textit{For fixed values $B\ge A>0$ the intersections $\partial\D_1\cap\Ss$ and $\partial\D_2\cap\Ss$ are non-empty.}} ($\diamondsuit$)
\end{center}

\end{subsection}

\begin{subsection}{Proof of Claim ($\diamondsuit$)}\label{mainsubsectop}

In order to prove ($\diamondsuit$), we first introduce an auxiliary map $\phi$ and study some of its properties. Let $\phi:=(\phi_1,\phi_2,\phi_3):\R^2\longrightarrow\R^3$, whose components are defined as
$$
\arraycolsep=2pt\def\arraystretch{1.5}
\begin{array}{l}
\phi_1(\rho,\theta)\!:=\!\cos\theta\sin\theta(\cos\theta-
\sin\theta)^2\!+\!\rho(2\cos^4\theta\sin\theta\!+\!\cos\theta\sin^4\theta\!+\!\cos^5\theta)\!+\!\rho^2\cos^5\theta\sin\theta,\\
\phi_2(\rho,\theta)\!:=\!\sqrt{\cos\theta\sin\theta}(\cos\theta+\sin\theta+\rho\cos\theta\sin\theta),\\
\phi_3(\rho,\theta)\!:=\!\rho\sin\theta.
\end{array}
$$

Let also $\Rr:=\big[0,+\infty\big)\times\big(0,\tfrac{\pi}{2}\big)$ and let $\overline{\Rr}:=\big[0,+\infty\big)\times\big[0,\tfrac{\pi}{2}\big]$ be its closure.

\vspace{1mm}

\begin{lemma}\label{phiContainsS}
With the notation introduced above, $\phi(\Rr)\subset\Ss$.
\begin{Proof}
Let $\psi$ be the analytic map
$$
\psi:=(\psi_1,\psi_2):\Rr\to\Qu,\quad(\rho,\theta)\mapsto\left(\frac{\sin\theta}{\cos\theta},\frac{(\cos\theta+\sin\theta+\rho\cos\theta
\sin\theta)\cos^2\theta}{\sin\theta}\right).
$$
Note that $g\circ\psi=\phi|_{\Rr}$. If $\theta\in\big(0,\tfrac{\pi}{2}\big)$ then $\cos\theta,\sin\theta\in(0,1)$, so $\psi$ is well-defined. This together with the fact $\rho\in[0,+\infty)$ implies that $\psi_1,\psi_2$ just attain positive values, so $\psi(\Rr)\subset \Qu\subset \overline{\Qu}$. Thus, $\phi({\Rr})=g(\psi(\Rr))\subset g\big(\overline{\Qu}\big)=\Ss$.
\qed
\end{Proof}
\end{lemma}

\vspace{1mm}

\begin{lemma}\label{phidist}
For all $(\rho,\theta)\in\overline{\Rr}$ the inequality $\phi_1^2(\rho,\theta)+\phi_3^2(\rho,\theta)\ge\frac{\rho^2}{4}$ holds. Thus,
\begin{equation}\label{eq:ineqphi}
\forall (\rho,\theta)\in\overline{\Rr}:\  \text{dist}\big(\phi(\rho,\theta),0\big)\geq\frac{\rho}{2}.
\end{equation}

\begin{Proof}
Notice first that if the inequality $\phi_1^2(\rho,\theta)+\phi_3^2(\rho,\theta)\ge\frac{\rho^2}{4}$ holds, then
$$
\text{dist}\big(\phi(\rho,\theta),0\big)=\sqrt{\phi_1^2(\rho,\theta)+\phi_3^2(\rho,\theta) + \phi_2^2(\rho,\theta)}\ge\sqrt{\frac{\rho^2}{4} + \phi_2^2(\rho,\theta)}\ge\sqrt{\frac{\rho^2}{4}}\ge\frac{\rho}{2},
$$
so \ref{eq:ineqphi} holds. Now, for the first part, if $(\rho,\theta)\in\overline{\Rr}$ then $\cos\theta, \sin\theta \in[0,1]$ and $\rho\ge0$, so we have:
\begin{align*}
\phi_1(\rho,\theta)&\ge\,\rho(\cos\theta\sin^4\theta+\cos^5\theta)=\rho\cos\theta(\cos^4\theta+\sin^4\theta)\\
&=^1\rho\cos\theta(1-2\cos^2\theta\sin^2\theta)=^2\rho\cos\theta\left(1-\frac{\sin^2(2\theta)}{2}\right)
\ge^3 \frac{\rho}{2}\cos\theta.
\end{align*}
In the equality $^1$ we have used that $1^2=(\cos\theta^2+\sin\theta^2)^2=\cos\theta^4+\sin\theta^4+2\cos\theta^2\sin\theta^2$. Equality $^2$ holds because $2\cos\theta\sin\theta=\sin(2\theta)$. Also, as $\theta\in[0,\tfrac{\pi}{2}]$ we have $2\theta\in[0,\pi]$, so $\sin(2\theta)\in[0,1]$. Thus $\sin^2(2\theta)\in[0,1]$ and $\tfrac{\sin(2\theta)}{2}\in[0,\tfrac{1}{2}]$ and inequality $^3$ holds.

\vspace{1mm}

In addition, $\phi_3(\rho,\theta)=\rho\sin\theta\ge\frac{\rho}{2}\sin\theta$, so we obtain the desired inequality:
$$
\phi_1^2(\rho,\theta)+\phi_3^2(\rho,\theta)\ge \frac{\rho^2}{4}\cos^2\theta+\frac{\rho^2}{4}\sin^2\theta=\frac{\rho^2}{4}.
$$
\qed
\end{Proof}
\end{lemma}

\begin{constr}\label{quotConstr}
\em
Recall the elementary equalities
$$
\sin\theta=\cos\Big(\frac{\pi}{2}-\theta\Big)\text{ and } \cos\theta=\sin\Big(\frac{\pi}{2}-\theta\Big)\ \ \forall\theta\in\R.
$$
Thus $\phi(0,\theta)=\phi\big(0,\tfrac{\pi}{2}-\theta\big)$ for $\theta\in[0,\tfrac{\pi}{2}]$. This induces us to make an identification described as follows. Fix $M>0$ and consider the rectangle 
$$
\overline{\Rr}_M:=\big[0,M\big]\times\big[0,\tfrac{\pi}{2}\big]\subset\overline{\Rr}.
$$
Let $\phi_M=\phi|_{\overline{\Rr}_M}$. Now, identify the points $(0,\theta)$ and $(0,\frac{\pi}{2}-\theta)$ for $\theta\in[0,\tfrac{\pi}{2}]$ (see Figure \ref{fig:identify}) and endow the quotient space $\tilde{\overline{\Rr}}_M$ with the quotient topology. Observe that, as a topological manifold with boundary, the interior of $\tilde{\overline{\Rr}}_M$ is the quotient space $\tilde{\Rr}_M$ obtained identifying the points $(0,\theta)$ and $(0,\frac{\pi}{2}-\theta)$ of $\Rr_M:=\big[0,M\big)\times\big(0,\tfrac{\pi}{2}\big)$, where $\theta\in\big(0,\tfrac{\pi}{2}\big)$.

\begin{figure}[!ht]
\begin{center}
\begin{tikzpicture}[scale=0.99]
\draw[->, line width=1pt] (-0.3,0) -- (5.5,0);
\draw[->, line width=1pt] (0,-0.3) -- (0,3.5);
\draw[gray,line width=2pt,fill=gray!20] (0,3) to (5,3) to (5,0) to (0,0);
\draw (-0.25,-0.25) node{$0$};
\draw (-0.3,1.5) node{$\theta$};
\draw (-0.3,3.4) node{$\tfrac{\pi}{2}$};
\draw (2.5,-0.35) node{$\rho$};
\draw (5,-0.25) node{$M$};
\draw (0,0) node{{\color{blue!65}\large$\bullet$}};
\draw (0,3) node{{\color{blue!65}\large$\bullet$}};
\draw (0,1.5) node{{\color{red!60}\large$\bullet$}};
\draw (0,2.5) node{{\color{orange!60}\large$\bullet$}};
\draw (0,0.5) node{{\color{orange!60}\large$\bullet$}};
\draw (0,2) node{{\color{black!20!yellow!60}\large$\bullet$}};
\draw (0,1) node{{\color{black!20!yellow!60}\large$\bullet$}};
\draw (2.5,1.5) node{$\overline{\Rr}_M$};
\draw [line width=0.8pt, draw=blue!65, <->] (-0.1,3) arc (80:280:1.52cm);
\draw [line width=0.8pt, draw=red!60, <->] (0.05,1.42) arc (210:510:0.2cm);
\draw [line width=0.8pt, draw=orange!60, <->] (-0.1,2.5) arc (80:280:1.03cm);
\draw [line width=0.8pt, draw=black!20!yellow!60, <->] (-0.1,2) arc (80:280:0.5cm);
\end{tikzpicture}
\end{center}
\caption{Idea of the identification in Construction \ref{quotConstr}.}\label{fig:identify}
\end{figure}

Consider the canonical projection $\pi_M:\overline{\Rr}_M\longrightarrow\tilde{\overline{\Rr}}_M$, which is continuous. Since $\phi_M$ is compatible with $\pi_M$, there exists a continuous map $\tilde{\phi}_M:\tilde{\Rr}_M\longrightarrow\R^3$ such that the following diagram is commutative. 

\vspace{1mm}

In addition $\tilde{\phi}_M(\tilde{\Rr}_M)=\phi(\Rr_M)\subset\phi(\Rr)\subset\Ss$ because of Lemma \ref{phiContainsS} and the fact that $\Rr_M\subset\Rr$.
\begin{center}
\begin{tikzpicture}[scale=1.5]
\node (A0) at (0,1) {$\Rr_M$};
\node (A) at (1,1) {$\overline{\Rr}_M$};
\node (C0) at (0,0) {$\tilde{\Rr}_M$};
\node (C) at (1,0) {$\tilde{\overline{\Rr}}_M$};
\node (D) at (2,0) {$\R^3$};

\path[->,font=\scriptsize,>=angle 90]
(A) edge node[above right]{$\phi_M$} (D)
(A) edge node[left]{$\pi_M$} (C)
(A0) edge node[left]{$\pi_M|_{\Rr_M}$} (C0)
(C) edge node[below]{$\tilde{\phi}_M$} (D);

\path[right hook->,font=\scriptsize,>=angle 90]
(A0) edge node[left]{} (A)
(C0) edge node[left]{} (C);

\end{tikzpicture}
\end{center}

\em
\end{constr}

%%%% IMAGEN COMENTADA
\begin{comment}
\begin{figure}[!ht]
\begin{center}
\resizebox{6.2cm}{5cm}{\begin{tikzpicture}%[background rectangle/.style=
%{double,draw=gray},show background rectangle]
\pgfplotsset{ticks=none}
\begin{axis}[point meta min=-4, point meta max=3,view={-45}{30}, scale=2.1, axis lines=middle, footnotesize,xlabel=$$,ylabel=$$,
xmin=-0.5,xmax=2.5,ymin=-0.3,ymax=1.5,zmin=-0.5,zmax=2.5,
unit vector ratio=]
\addplot3[opacity=1, fill opacity=1, surf,samples=20,colormap/blackwhite,
variable=\u, variable y=\v,
domain=0:2, y domain=0:90]
({min(cos(v)*sin(v)*(sin(v)-cos(v))^2+
u*(2*(cos(v))^4*sin(v)+cos(v)*(sin(v))^4+(cos(v))^5)
+u^2*(cos(v))^5*sin(v),10)}, {min(sqrt(sin(v)*cos(v))*(sin(v)+cos(v)
+u*cos(v)*sin(v)),10)}, {min(u*sin(v),10)});
\addplot3[opacity=0.0, fill opacity=0.0,surf,gray,z buffer=sort,samples=40,
variable=\u, variable y=\v,
domain=-1.5:2.5, y domain=0:360]
({3*cos(v)}, {3*sin(v)}, {u});
\addplot3[opacity=1, fill opacity=0.0,domain=0:90,samples=40,samples y=0]
({min(cos(x)*sin(x)*(sin(x)-cos(x))^2,2)}, {min(sqrt(sin(x)*cos(x))*(sin(x)+cos(x)),2)}, {0});
\end{axis}
\end{tikzpicture}}\hskip 0.2cm
\resizebox{6.2cm}{5cm}{
\begin{tikzpicture}
\pgfplotsset{ticks=none}
\begin{axis}[point meta min=-4, point meta max=3,view={45}{30}, scale=2.5, axis lines=middle, footnotesize,xlabel=$$,ylabel=$$,
xmin=-0.5,xmax=3.5,ymin=-0.3,ymax=1.5,zmin=-0.5,zmax=2.5,
unit vector ratio=]
\addplot3[opacity=1, fill opacity=1, surf,samples=20,colormap/blackwhite,
variable=\u, variable y=\v,
domain=0:2, y domain=0:90]
({min(cos(v)*sin(v)*(sin(v)-cos(v))^2+
u*(2*(cos(v))^4*sin(v)+cos(v)*(sin(v))^4+(cos(v))^5)
+u^2*(cos(v))^5*sin(v),10)}, {min(sqrt(sin(v)*cos(v))*(sin(v)+cos(v)
+u*cos(v)*sin(v)),10)}, {min(u*sin(v),10)});
\addplot3[opacity=0.0, fill opacity=0.0,surf,gray,z buffer=sort,samples=40,
variable=\u, variable y=\v,
domain=-1.5:2.5, y domain=0:360]
({3*cos(v)}, {3*sin(v)}, {u});
\addplot3[opacity=1, fill opacity=0.0,domain=0:90,samples=40,samples y=0]
({min(cos(x)*sin(x)*(sin(x)-cos(x))^2,2)}, {min(sqrt(sin(x)*cos(x))*(sin(x)+cos(x)),2)}, {0});
\end{axis}
\end{tikzpicture}%}
}
\caption{Left and right views of $\phi_M(\Rr_M)\subset\Ss$.}\label{pic:surface1}
\end{center}
\end{figure}
\end{comment}

\begin{lemma}\label{RMdisc}
The set $\tilde{\overline{\Rr}}_M$ is homeomorphic to a disc and its boundary is the set
$$
\pi_M\big(\{\rho=M\}\cup\{\theta=0\}\cup\{\theta=\tfrac{\pi}{2}\}\big).
$$
\begin{Proof} Identify $\R^2$ with $\C$ (interchanging the order of the variables $(\rho,\theta)\leadsto(\theta,\rho)$) and consider the continuous map defined as 
$$
\mu:\C\longrightarrow\C,\ z:=\theta+{\tt i}\rho\longmapsto w:=u+{\tt i}v=\big(\tfrac{4}{\pi}z-1\big)^2,
$$
where ${\tt i}$ is the imaginary unit $\sqrt{-1}$. The restriction $\mu|_{\{\rho>0\}}:\{\rho>0\}\to\C\setminus\big([0,+\infty)\times\{0\}\big)$ is a homeomorphism. Now observe that the image of $\overline{\Rr}_M\setminus\{\rho=0\}$ is
$$
\Tt_M:=\big\{(u,v)\in\R^2:\ \big(\tfrac{\pi v}{8M}\big)^2-\big(\tfrac{4M}{\pi}\big)^2\leq u\leq1-\big(\tfrac{v}{2}\big)^2\big\}\setminus\set[\big]{(u,0):u\in[0,1]}.
$$
The closure $\overline{\Tt}_M$ of $\Tt_M$ is a compact convex set because it is a closed bounded intersection of two convex sets, see Figure \ref{fig:Tm}. This implies, by \cite[Corolary 11.3.4]{b}, that $\overline{\Tt}_M$ is homeomorphic to a closed disc. In addition, the map
$$
\mu|_{\set{\rho=0}}:\{\rho=0\}\to\set[\big]{(u,0):u\in[0,+\infty)},\ \theta\mapsto\big(\tfrac{4}{\pi}\theta-1\big)^2
$$
maps the segment $[0,\tfrac{\pi}{2}]\times\set{0}$ onto the interval $[0,1]\times\set{0}$ and the fiber $(\mu|_{\set{\rho=0}})^{-1}(t_0)$ for $t_0\in[0,1]$ consists of two points, namely: 
$$
\set[\big]{\theta_1:=\tfrac{\pi}{4}\big(1+\sqrt{t_0}\big),\, \, \theta_2:=\tfrac{\pi}{4}\big(1-\sqrt{t_0}\big)},
$$
which makes sense considering the identification described in Construction \ref{quotConstr}.

\begin{figure}[!ht]
\begin{center}
\begin{tikzpicture}[scale=0.99]
%\draw[style=help lines,step=0.5cm] (0,0) grid (12.5,5);
\begin{scope}[scale=0.5,xshift=4cm, yshift=5cm]
%\draw[line width=1.5pt,rotate=-90,draw,fill=gray!40] (6,11) parabola bend (0,20) (-6,11) parabola bend (0,10) (6,11);
%--------------- Mio
\draw[line width=1.5pt,rotate=-90,draw,fill=gray!40] (-6,11) parabola bend (0,10) (6,11);
\draw[line width=1.5pt,rotate=-90,draw,fill=gray!40] (6,11) parabola bend (0,20) (-6,11);
%---------------
\draw[->, line width=1pt] (9,0) -- (21,0);
\draw[->, line width=1pt] (19,-6.5) -- (19,6.5);
%--------------- Mio
\draw[draw=black!10!orange!80,line width=1.5pt,rotate=-90,draw] (-6,11) parabola bend (0,10) (6,11);
\draw[draw=blue!60,line width=1.5pt,rotate=-90,draw] (0,20) parabola bend (0,20) (-6,11);
\draw[draw=black!15!green!60,line width=1.5pt,rotate=-90,draw] (6,11) parabola bend (0,20) (0,20);
%---------------
\draw (20.5,-0.5) node{$1$};
\draw (18.5,-0.5) node{$0$};
\draw (14,2.5) node{$\overline{\Tt}_M$};
\draw[draw=red!65,line width=1.5pt] (19,0) -- (20,0);
\draw (19,0) node{$\bullet$};
\draw (20,0) node{$\bullet$};
\end{scope}
\draw[draw=none, fill=gray!40] (0.5,0) to (3.5,0) to (3.5,5) to (0.5,5) to (0.5,0);
%\draw[draw=blue!60,line width=1.5pt] (3.5,0) to (3.5,5) to (0.5,5) to (0.5,0);
\draw[->, line width=1pt] (-0.5,0) -- (4.5,0);
\draw[->, line width=1pt] (0.5,-1) -- (0.5,6);
%--------------- Mio
\draw[draw=blue!60,line width=1.5pt] (3.5,0) to (3.5,5);
\draw[draw=black!10!orange!80,line width=1.5pt] (3.5,5) to (0.5,5);
\draw[draw=black!15!green!60,line width=1.5pt] (0.5,5) to (0.5,0);
%---------------
\draw[draw=red!65,line width=1.5pt] (0.5,0) to (3.5,0);
\draw[line width=1.5pt] (2,-0.15) -- (2,0.15);
\draw [line width=1pt, ->] (4.5,2.5)--(5.25,2.5) node [above] {$\mu$} -- (6,2.5);
\draw (0.25,-0.25) node{$0$};
\draw (3.5,-0.35) node{$\tfrac{\pi}{2}$};
\draw (4.4,-0.35) node{$\theta$};
\draw (2.25,-0.35) node{$\tfrac{\pi}{4}$};
\draw (0.2,5) node{$M$};
\draw (2.25,2.5) node{$\overline{\Rr}_M$};
\draw (0.2,2.5) node{$\rho$};
\end{tikzpicture}
\end{center}
\caption{Behavior of the map $\mu:\overline{\Rr}_M\longrightarrow\overline{\Tt}_M$.}\label{fig:Tm}
\end{figure}

Following Construction \ref{quotConstr} and since $\theta_1=\tfrac{\pi}{2}-\theta_2$, the map $\lambda:=\mu|_{\overline{\Rr}_M}:\overline{\Rr}_M\to\overline{\Tt}_M$ factors through $\tilde{\overline{\Rr}}_M$ and there exists a continuous map $\tilde{\lambda}:\tilde{\overline{\Rr}}_M\to\overline{\Tt}_M$ such that the following diagram is commutative:
\begin{center}
\begin{tikzpicture}[scale=1.5]
\node (A0) at (0,1) {$\Rr_M$};
\node (A) at (1,1) {$\overline{\Rr}_M$};
\node (C0) at (0,0) {$\tilde{\Rr}_M$};
\node (C) at (1,0) {$\tilde{\overline{\Rr}}_M$};
\node (D) at (2,0) {$\Tt_M$};

\path[->,font=\scriptsize,>=angle 90]
(A) edge node[above right]{$\lambda$} (D)
(A) edge node[left]{$\pi_M$} (C)
(A0) edge node[left]{$\pi_M|_{\Rr_M}$} (C0)
(C) edge node[below]{$\tilde{\lambda}$} (D);

\path[right hook->,font=\scriptsize,>=angle 90]
(A0) edge node[left]{} (A)
(C0) edge node[left]{} (C);
\end{tikzpicture}
\end{center}
The map $\tilde{\lambda}$ is continuous and bijective and in fact it is a homeomorphism because $\tilde{\overline{\Rr}}_M$ is compact and $\overline{\Tt}_M$ is a Hausdorff space. Thus, $\tilde{\overline{\Rr}}_M$ is homeomorphic to a disc and its boundary is 
$$
\pi_M\big(\set{\rho=M}\cup\set{\theta=0}\cup\set{\theta=\tfrac{\pi}{2}}\big),
$$
which concludes the proof.
\qed
\end{Proof}
\end{lemma}

\vspace{1mm}

We are ready to prove  the main result of this section, which will be the key to prove Theorem \ref{openQuad}.

\vspace{1mm}

\begin{lemma}\label{mainlemmatop}
Fix $B\ge A>0$ and consider the warped discs $\D_1$ and $\D_2$ introduced in \eqref{d1} and \eqref{d2}. Then, there exists $M>0$ such that the boundary map $\partial\tilde{\phi}_M:\partial\tilde{\overline{\Rr}}_M\longrightarrow\R^3$ meets transversally once both discs $\D_1$ and $\D_2$.
\begin{Proof} First, since $\D_1$ and $\D_2$ are bounded, there exists $M_0>0$ such that 
$$
\D_1\cup\D_2\subset\set{(x,y,z):\norm{(x,y,z)}<M_0}\subset\R^3.
$$
Take $M:=4M_0$ and consider the set $\tilde{\overline{\Rr}}_M$ and the continuous map $\tilde{\phi}_M$ introduced in Construction \ref{quotConstr}.

\vspace{1mm}

We are going to prove that the boundary map $\partial\tilde{\phi}_M:\partial\tilde{\overline{\Rr}}_M\rightarrow\R^3$ meets transversally once $\D_1$.

\begin{figure}[!ht]
\begin{center}
\includegraphics[height=6cm]{plots/ch3_02_B2.png}
\end{center}
\caption{The boundary map $\partial\tilde{\phi}_M:\partial\tilde{\overline{\Rr}}_M\rightarrow\R^3$ meets transversally once $\D_1$.}
\end{figure}

Consider the parameterization of $\partial\tilde{\overline{\Rr}}_M$ given by
$$
\beta_1(t):=
\begin{cases}
\pi_M\big(t,\frac{\pi}{2}\big) &\text{if $0\le t\le M$},\\
\pi_M\big(M,M+\frac{\pi}{2}-t\big) &\text{if $M<t\le M+\frac{\pi}{2}$},\\
\pi_M\big(2M+\frac{\pi}{2}-t,0\big) &\text{if $M+\frac{\pi}{2}<t\le 2M+\frac{\pi}{2}$}.
\end{cases}
$$ 

\begin{figure}[!ht]
\begin{center}
\begin{tikzpicture}[scale=0.99]
\draw[->, line width=1pt] (-0.5,0) -- (5.5,0);
\draw[->, line width=1pt] (0,-0.5) -- (0,3.5);
\draw[draw=blue!60,line width=2pt,fill=gray!20] (0,3) to (5,3) to (5,0) to (0,0);
\draw[draw=blue!60,line width=2pt,->,>=angle 45] (0,3) to (2.75,3);
\draw[draw=blue!60,line width=2pt,->,>=angle 45] (5,3) to (5,1.25);
\draw[draw=blue!60,line width=2pt,->,>=angle 45] (5,0) to (2.25,0);
\draw[->, line width=1pt] (6.5,0) -- (12.5,0);
\draw[->, line width=1pt] (7,-0.5) -- (7,3.5);
\draw[draw=red!65,line width=2pt,fill=gray!20] (7,3) to (12,3) to (12,0) to (7,0);
\draw[draw=red!65,line width=2pt,->,>=angle 45] (12,3) to (9.25,3);
\draw[draw=red!65,line width=2pt,->,>=angle 45] (12,0) to (12,1.75);
\draw[draw=red!65,line width=2pt,->,>=angle 45] (7,0) to (9.75,0);
\draw (-0.25,-0.25) node{$0$};
\draw (-0.3,1.5) node{$\theta$};
\draw (-0.3,3) node{$\tfrac{\pi}{2}$};
\draw (2.5,-0.35) node{$\rho$};
\draw (5,-0.25) node{$M$};
\draw (0,0) node{{\color{blue!60}\large$\bullet$}};
\draw (0,3) node{{\color{blue!60}\large$\bullet$}};
\draw (1.5,1.5) node{identified!};
\draw[->,thick] (1.25,1.75) -- (0.2,2.8);
\draw[->,thick] (1.25,1.25) -- (0.2,0.2);
\draw (2.5,3.5) node{$\beta_1(t)$};
\draw (6.75,-0.25) node{$0$};
\draw (6.7,1.5) node{$\theta$};
\draw (6.7,3) node{$\tfrac{\pi}{2}$};
\draw (9.5,-0.35) node{$\rho$};
\draw (12,-0.25) node{$M$};
\draw (7,0) node{{\color{red!65}\large$\bullet$}};
\draw (7,3) node{{\color{red!65}\large$\bullet$}};
\draw (8.5,1.5) node{identified!};
\draw[->,thick] (8.25,1.75) -- (7.2,2.8);
\draw[->,thick] (8.25,1.25) -- (7.2,0.2);
\draw (9.5,3.5) node{$\beta_2(t)$};
\end{tikzpicture}
\end{center}
\caption{Behavior of the paths $\beta_1$ and $\beta_2$, surrounding $\tilde{\overline{\Rr}}_M$.}\label{fig:betas}
\end{figure}

Let $\alpha_1(t):=\tilde{\phi}_M\circ\beta_1(t)$ defined as:
$$
\alpha_1(t)=\begin{cases}
\phi\big(t,\frac{\pi}{2}\big) &\text{if $0\le t\le M$},\\
\phi\big(M,M+\frac{\pi}{2}-t\big) &\text{if $M<t\le M+\frac{\pi}{2}$},\\
\phi\big(2M+\frac{\pi}{2}-t,0\big) &\text{if $M+\frac{\pi}{2}<t\le 2M+\frac{\pi}{2}$}.
\end{cases}
$$ 

Choose $\eps$ such that $0<\eps<\min\{B,M_0-B\}$ and consider the homeomorphism
$$
\zeta_1:\R^3\to\R^3,\ (x,y,z)\mapsto(x,y,z-\xi_1(x,y)),
$$
where $\xi_1$ is the continuous semialgebraic function introduced in \eqref{xi1}. Let us abbreviate $\D_1(\varepsilon):=\zeta_1^{-1}\big({\mathbb D}_A(\varepsilon)\big)$. As we have done in other proofs we can rely on ${\mathbb D}_A(\varepsilon)$ to conclude this part of the proof, so is enough to check the equality:
$$
\alpha_1^{-1}(\D_1(\varepsilon))=(B-\varepsilon,B+\varepsilon). 
$$

If $t_0\in[0,2M+\frac{\pi}{2}]$, pick $p_0:=\alpha_1(t_0)\in\text{im}(\alpha_1)$. The definition of $\alpha_1$ leads us to distinguish three cases:

\begin{enumerate}[(i)]
\item If $0\le t_0\le M$, then 
$$
\zeta_1(p_0)=\zeta_1(\alpha(t_0))=\zeta_1(\phi(t_0,0))=\zeta_1(\phi(t_0,\tfrac{\pi}{2}))=(0,0,t_0-B),
$$
where $\phi$ was introduced at the beginning of \ref{mainsubsectop}. Thus, $\zeta_1(p_0)\in{\mathbb D}_A(\varepsilon)$ if and only if $-B<-\varepsilon<t_0-B<\varepsilon<M-B$, that is, $0<B-\varepsilon<t_0<B+\varepsilon<M$. 

\item If $M<t_0\le M+\frac{\pi}{2}$ we have by \eqref{eq:ineqphi}, for every point $q\in\D_1(\varepsilon)$,  
$$
\text{dist}(p_0,0)=\text{dist}\big(\phi\big(M,M+\tfrac{\pi}{2}-t\big),0\big)\geq\tfrac{M}{2}=2M_0>\sqrt{2}M_0>\text{dist}(q,0).
$$ 
Therefore $p_0\notin\D_1(\varepsilon)$.

\item If $M+\frac{\pi}{2}<t_0\le 2M+\frac{\pi}{2}$, then 
$$
p_0=\alpha_1(t_0)=\phi\big(2M+\tfrac{\pi}{2}-t_0,0\big)=\big(2M+\tfrac{\pi}{2}-t_0,0,0\big),
$$ 
so $\zeta_1(p_0)=(2M+\tfrac{\pi}{2}-t_0,0,-B)$. As $\varepsilon<B$, we have $\zeta_1(p_0)\not\in{\mathbb D}_A(\varepsilon)$ and $p_0\not\in\D_1(\varepsilon)$.
\end{enumerate}

We conclude $\alpha_1^{-1}\big(\D_1(\varepsilon)\big)=\big(B-\varepsilon,B+\varepsilon\big)$, so $\alpha_1$ meets transversally once $\D_1$. 

Analogously one shows that the boundary map $\partial\tilde{\phi}_M:\partial\tilde{\overline{\Rr}}_M\longrightarrow\R^3$ meets transversally once $\D_2$.

\begin{figure}[!ht]
\begin{center}
\includegraphics[height=6cm]{plots/ch3_01_A2.png}
\end{center}
\caption{The boundary map $\partial\tilde{\phi}_M:\partial\tilde{\overline{\Rr}}_M\rightarrow\R^3$ meets transversally once $\D_2$.}
\end{figure}

\vspace{1mm}

Consider in this case the parameterization of $\partial\tilde{\overline{\Rr}}_M$ given by
$$
\beta_2(t):=
\begin{cases}
\pi_M\big(t,0\big) &\text{if $0\le t\le M$},\\
\pi_M\big(M,t-M\big) &\text{if $M<t\le M+\frac{\pi}{2}$},\\
\pi_M\big(2M+\frac{\pi}{2}-t,\frac{\pi}{2}\big) &\text{if $M+\frac{\pi}{2}<t\le 2M+\frac{\pi}{2}$},
\end{cases}
$$ 
(see Figure \ref{fig:betas}). Then we define $\alpha_2(t):=\tilde{\phi}_M\circ\beta_2(t)$ as:
$$
\alpha_2(t) =
\begin{cases}
\phi\big(t,0\big) &\text{if $0\le t\le M$},\\
\phi\big(M,t-M\big) &\text{if $M<t\le M+\frac{\pi}{2}$},\\
\phi\big(2M+\frac{\pi}{2}-t,\frac{\pi}{2}\big) &\text{if $M+\frac{\pi}{2}<t\le 2M+\frac{\pi}{2}$}.
\end{cases}
$$ 

Proceed as above keeping the same values for $A$ and $\varepsilon$ and using in this case the homeomorphism
$$
\zeta_2:\R^3\to\R^3,\ (x,y,z)\longmapsto(z,y,x-\xi_2(z,y)),
$$
where $\xi_2$ is the continuous semialgebraic function introduced in \eqref{xi2}, to prove that $\alpha_2$ meets transversally once the warped disk $\D_2$. This concludes the proof.
\qed
\end{Proof}
\end{lemma}

Now we are ready to prove ($\diamondsuit$) and this way conclude the topological proof.

\vspace{2mm}		

[Proof of Theorem \ref{openQuad}] Note first that, by Lemma \ref{RMdisc}, $\overline{\Rr}_M$ is homeomorphic to a closed disc. By Proposition \ref{propTop} applied to the continuous map $\phi_M:\overline{\Rr}_M\to\R^3$ and Lemma \ref{mainlemmatop}, we deduce that the boundaries of both warped discs $\D_1$ and $\D_2$ meet $\phi_M({\Rr}_M)\subset\Ss$. Thus, ($\diamondsuit$) holds, and this concludes the proof.
\qed

\end{subsection}
\end{section}
\end{chapter}

\begin{chapter}{Complexity analysis}\label{compChapter}

\begin{section}{Introduction to the computational comparison}\label{5sect1}
In this chapter we set up the theoretical basis to discuss how ``good'' or how ``bad'' the three polynomial maps $\R^2\to\R^2$ having ${\Qu}$ as image are. Thus, we first need to clearly specify what ``good'' and ``bad'' means here. Afterwards, and using a computer, we will compare the images under the maps $\P$ (chapter 2), $\HH\circ\GG\circ\FF$ (chapter 3) and $\FFF$ (chapter 4) of certain subsets of $\R^2$.

We will start with some naif grids of integers contained in the square $[-10, 10]\times[-10, 10]$ and in $[-100, 100]\times[-100, 100]$, and some grids in $[-1, 1]\times[-1, 1]$ and $[0, 1]\times[0, 1]$. Later, we will move into more specific sets provided by certain curves, following the ideas of  Section \ref{quadReasons}. Lastly, we will use random sets of points contained, respectively, in the unit disc and in the disc of radius $\rho=100$.

In the analysis, we will compare the execution times between the three maps, and also between computing the image as a composition of maps or as a fully expanded polynomial map. We will also take advantage of the proof in Chapter 4 for computing $f_2\big(\overline{\Qu}\big)$ instead of computing $\FFF\big(\R^2\big)$.

One may wonder:

%\vspace{0.1cm}
\begin{center}
\fbox{ \emph{Why is it interesting to represent the open quadrant in an easy way?} }
\end{center}
%\vspace{0.1cm}

Here the word \textit{easy} means computationally efficient, so we are looking for the map that fills the open quadrant $\Qu$ quicker (in terms of the number of calculations) and the one $f$ such that the image $f(\Ss)$ of suitable subsets $\Ss\subset\R^2$ fill a bigger area.

The answer is that the representation of $\Qu$ as a polynomial image of $\R^2$ is a key step to represent much more sophisticated subsets of $\R^n$ as polynomial or regular images of some $\R^m$. Thus, if we are able to represent $\Qu$ easily we would be able to represent other semialgebraic sets easily too. This is the case, for instance, for the family  of convex polyhedra, their interiors and their complementaries. The reason for this is that for constructing either polynomial or regular maps $f:\R^n\to\R^n$ producing polyhedral images, the first step relies on the construction of a polynomial map whose image is the open orthant $\mathscr{O}:=\{x_1>0,\dots,x_n>0\}$. As we saw in Theorem \ref{openQuadGen} this heavily relies on using polynomial maps on the plane with the half-plane $\H$ and the open quadrant $\Qu$ as images. Afterwards, the strategy for obtaining polynomial maps with convex polyhedral images is usually to start from $\mathscr{O}$, which is the simplest convex polyhedron containing at least one vertex, and add new vertices inductively by composing with adequate either polynomial or regular maps.

That is why the better the constituents of the final map are, the better the final map will be.  Thus, the representation of $\Qu$ as a polynomial image of $\R^2$ is key in this process.	
\end{section}

\begin{section}{Complexity of the given polynomial maps}\label{5sect2}

\begin{subsection}{The map from the first proof}

We need first to compute the coefficients and the shape of the polynomials we are going to use. Note for instance that the first polynomial map $\P$ defined in \ref{eq:firstMap} transforms $\R^2$ into $\Qu\cup\set{p_1:=(0,1),p_2=(1,0)}$ and then, relying on the proof of Theorem \ref{finSetTh} we manage to ged rid of $p_1$ and $p_2$ by means of a polynomial map (say $H$) that is applied to $\R^2$ before $\P$ acts. Nevertheless the proof of Theorem \ref{finSetTh} depends on the some values $r,a_1,a_2,\dots$; so, how is $H$ defined?

Fernando and Ueno answered this question in \cite{fu1} where they proved the following Lemma:

\begin{lemma}
Let $r\in\R\setminus\{0,1\}$ and $S=\set{(0,0),(-1,0)}$. Then, $\R^2\setminus S$ is the image of the polynomial map 
$$
H=(H_1,H_2):\R^2\to\R^2,\ (x,y)\mapsto\big(xy-r,\ x^2(xy-r)(xy-r+1)+y\big).
$$	
\end{lemma}

Here we take $r=-1$ for simplicity. In fact the ``conflictive'' set is the preimage through $\P$ of the set $\set{(0,1),(1,0)}$, namely $\set{(0,-1),(-1,0)}$ and not $\set{(0,0),(-1,0)}$, but a change of coordinates 
$$
Q:\R^2\to\R^2,\ (x,y)\mapsto(x,y-x-1),
$$
maps $(-1,0)$ to $(-1,0)$ and $(0,0)$ to $(0,-1)$. Now it is clear that the first map we will use for the computational comparison is
$$
g=(g_1, g_2):=\P\circ Q\circ H:\R^2\longrightarrow\R^2.
$$

We wonder how the full expansion of $g$ looks like, and the result can be observed in Table \ref{tab:firstMap}. In the comparison we will mostly be using the composition $\P\circ Q\circ H$ to get the image of a given point, but we will also do a comparison between that composition and the full expansion as shown in Table \ref{tab:firstMap}.

\begin{table}[ht!]
\framebox{
\begin{tabular}{p{14cm}}
{\tiny $g_1(\x,\y) =  (\x^{18} + 2   \x^{16} + \x^{14} ) \y^{10} + 2  (7   \x^{17} + 11   \x^{15} + 2   \x^{14} + 3   \x^{13} + 3   \x^{12} - \x^{11} + \x^{10} )\y^{9} + (87   \x^{16} + 98   \x^{14} + 44   \x^{13} - \x^{12} + 48   \x^{11} - 10   \x^{10} + 6   \x^{9} + 7   \x^{8} - 2   \x^{7} + \x^{6} )\y^{8}  + 2   (158   \x^{15} + 104   \x^{13} + 104   \x^{12} - 49   \x^{11} + 69   \x^{10} + \x^{9} - 12   \x^{8} + 19   \x^{7} - 3   \x^{6} + \x^{4} ) \y^{7} + (743   \x^{14} + 118   \x^{12} + 552   \x^{11} - 331   \x^{10} + 114   \x^{9} + 116   \x^{8} - 136   \x^{7} + 61 \x^{6} + 8   \x^{5} - 14   \x^{4} + 4   \x^{3} + \x^{2} )\y^{6}  + 2   (591   \x^{13} - 225   \x^{11} + 450   \x^{10} - 225   \x^{9} - 132   \x^{8} + 163   \x^{7} - 103   \x^{6} - 9   \x^{5} + 26   \x^{4} - 13   \x^{3} - 2   \x^{2} + \x ) \y^{5} + (1289   \x^{12} - 1250   \x^{10} + 924   \x^{9} - 78   \x^{8} - 786   \x^{7} + 386   \x^{6} - 10   \x^{5} - 154   \x^{4} + 66   \x^{3} + 3   \x^{2} - 14   \x + 1 )\y^{4} + 2   (476   \x^{11} - 770   \x^{9} + 292   \x^{8} + 282   \x^{7} - 432   \x^{6} + 63   \x^{5} + 143   \x^{4} - 76   \x^{3} + \x^{2} + 19   \x - 4 ) \y^{3} + (456   \x^{10} - 1064   \x^{8} + 208   \x^{7} + 767   \x^{6} - 456   \x^{5} - 172   \x^{4} + 290   \x^{3} - 27   \x^{2} - 52   \x + 23 ) \y^{2}  + 4   (32   \x^{9} - 100   \x^{7} + 8   \x^{6} + 107   \x^{5} - 24   \x^{4} - 47   \x^{3} + 23   \x^{2} + 8   \x - 7 )\y + (16 \x^{8}- 64   \x^{6} + 92   \x^{4} - 56 \x^{2} +  13)$,}
\\[0.2cm]
{\tiny $g_2(\x,\y) = \x^{16} \y^{12} + 2   (7   \x^{15} - \x^{13} + \x^{12} ) \y^{11} + (89   \x^{14} - 26   \x^{12} + 22   \x^{11} + \x^{10} - 2   \x^{9} + \x^{8} )\y^{10} + 2  (171   \x^{13} - 76   \x^{11} + 54   \x^{10} + 6   \x^{9} - 10   \x^{8} + 4   \x^{7} ) \y^{9} + (893   \x^{12} - 532   \x^{10} + 316   \x^{9} + 64   \x^{8} - 88   \x^{7} + 28   \x^{6} ) \y^{8} + 2   (844   \x^{11} - 628   \x^{9} + 311   \x^{8} + 101   \x^{7} - 114   \x^{6} + 29   \x^{5} )\y^{7} + (2396   \x^{10} - 2140   \x^{8} + 878   \x^{7} + 427   \x^{6} - 396   \x^{5} + 81   \x^{4} ) \y^{6} + 2   (1299   \x^{9} - 1369   \x^{7} + 457   \x^{6} + 326   \x^{5} - 248   \x^{4} + 40   \x^{3} ) \y^{5} + (2148   \x^{8} - 2668   \x^{6} + 698   \x^{5} + 751   \x^{4} - 458   \x^{3} + 55   \x^{2} )\y^{4} + 2   (661   \x^{7} - 976   \x^{5} + 187   \x^{4} + 327   \x^{3} - 151   \x^{2} + 12   \x ) \y^{3} + (573   \x^{6} - 1022   \x^{4} + 126   \x^{3} + 414   \x^{2} - 130   \x + 5 )\y^{2}  + 4   (39   \x^{5} - 86   \x^{3} + 5   \x^{2} + 44   \x - 7 ) \y + ( 20   \x^{4}- 56   \x^{2} + 40)$.}
\end{tabular}}
\caption{The first polynomial map}\label{tab:firstMap}
\end{table}
\end{subsection}

\begin{subsection}{The map from the short proof}
As for the second map, we recall that it is defined as $f=(f_1, f_2):=\HH\circ\GG\circ\FF$, see its definition in \ref{eq:secondMap}. The full expansion of $f$ can be seen in Table \ref{tab:secondMap}. We will also be doing a comparison between the expanded map and the composition in the next section.

\begin{table}[ht!]
\framebox{
\begin{tabular}{p{14cm}}

{\tiny $f_1(\x,\y)= \big(4\x^{26}+20\x^{24}+41\x^{22}+44\x^{20}+26\x^{18}
+8\x^{16}+\x^{14}\big)\y^{26}+\big(-104\x^{25}-
480\x^{23}-902\x^{21}-880\x^{19}-468\x^{17}-128\x^{15}
-14\x^{13}\big)\y^{25}+\big(32\x^{26}+1458\x^{24}+
5839\x^{22}+9807\x^{20}+8554\x^{18}+4036\x^{16}+
967\x^{14}+91\x^{12}\big)\y^{24}+\big(-768\x^{25}-
13876\x^{23}-46860\x^{21}-69188\x^{19}-53264\x^{17}
-22028\x^{15}-4564\x^{13}-364\x^{11}\big)\y^{23}
+\big(113\x^{26}+9382\x^{24}+97367\x^{22}+274164\x^{20}
+{\tfrac{703621}{2}}\x^{18}+236532\x^{16}+84820\x^{14}
+15018\x^{12}+{\tfrac{2003}{2}}\x^{10}\big)\y^{22}
+\big(-2486\x^{25}-75768\x^{23}-525594\x^{21}
-1229924\x^{19}-1360121\x^{17}-791240\x^{15}
-243544\x^{13}-36436\x^{11}-2007\x^9\big)\y^{21}
+\big(231\x^{26}+27209\x^{24}+446529\x^{22}
+2240074\x^{20}+{\tfrac{8710925}{2}}\x^{18}
+{\tfrac{8244713}{2}}\x^{16}+2057114\x^{14}+538091\x^{12}+{\tfrac{134535}{2}}\x^{10}
+{\tfrac{6051}{2}}\x^8\big)\y^{20}+\big(-4620\x^{25}-193928\x^{23}-2018472\x^{21}
-7667498\x^{19}-12393340\x^{17}-9976824\x^{15}-4233956\x^{13}-931594\x^{11}-96204\x^9
-3492\x^7\big)\y^{19}+\big(301\x^{26}+45304\x^{24}+{\tfrac{1996081}{2}}\x^{22}
+7201629\x^{20}+21316526\x^{18}+28643722\x^{16}+{\tfrac{38977381}{2}}\x^{14}
+6970385\x^{12}+1276041\x^{10}+107514\x^8+3108\x^6\big)\y^{18}+\big(-5418\x^{25}
-285964\x^{23}-3907609\x^{21}-20635184\x^{19}-48472730\x^{17}-54092612\x^{15}
-30891281\x^{13}-9219636\x^{11}-1387160\x^9-94004\x^7-2128\x^5\big)\y^{17}
+\big(259\x^{26}+47243\x^{24}+{\tfrac{2580609}{2}}\x^{22}+{\tfrac{23978613}{2}}\x^{20}
+47980885\x^{18}+90479081\x^{16}+{\tfrac{167285973}{2}}\x^{14}+
{\tfrac{79543913}{2}}\x^{12}+9792158\x^{10}+1193474\x^8+63896\x^6+1106\x^4\big)\y^{16}
+\big(-4144\x^{25}-262276\x^{23}-4387372\x^{21}-29332620\x^{19}-91032136\x^{17}-
138703760\x^{15}-105761608\x^{13}-41463220\x^{11}-8305148\x^9-805172\x^7-33232\x^5
-424\x^3\big)\y^{15}+\big(147\x^{26}+31738\x^{24}+1029734\x^{22}+11578342\x^{20}
+{\tfrac{115563913}{2}}\x^{18}+141146980\x^{16}+174192331\x^{14}+108825883\x^{12}
+{\tfrac{69479137}{2}}\x^{10}+5560611\x^8+418307\x^6+12832\x^4+{\tfrac{227}{2}}\x^2\big)
\y^{14}+\big(-2058\x^{25}-152936\x^{23}-3012828\x^{21}-24111820\x^{19}
-92027457\x^{17}-178500672\x^{15}-178178038\x^{13}-90313924\x^{11}-23084717\x^9
-2880652\x^7-162050\x^5-3480\x^3-19\x\big)\y^{13}+\big(53\x^{26}+13607\x^{24}
+514692\x^{22}+6758603\x^{20}+{\tfrac{79906193}{2}}\x^{18}+{\tfrac{236896489}{2}}\x^{16}
+183083134\x^{14}+146995602\x^{12}+{\tfrac{119160879}{2}}\x^{10}+{\tfrac{23809093}{2}}
\x^8+1115393\x^6+44130\x^4+{\tfrac{1187}{2}}\x^2+{\tfrac{3}{2}}\big)\y^{12}
+\big(-636\x^{25}-55808\x^{23}-1273116\x^{21}-11799438\x^{19}-52781280\x^{17}
-122608140\x^{15}-150791284\x^{13}-96320302\x^{11}-30530204\x^9-4590824\x^7
-302620\x^5-7466\x^3-48\x\big)\y^{11}+\big(11\x^{26}+3544\x^{24}+{\tfrac{314743}{2}}
\x^{22}+2376631\x^{20}+16126054\x^{18}+55398078\x^{16}+{\tfrac{202163613}{2}}\x^{14}
+98174729\x^{12}+48935769\x^{10}+11683851\x^8+{\tfrac{2465761}{2}}\x^6+49595\x^4
+534\x^2\big)\y^{10}+\big(-110\x^{25}-12028\x^{23}-320343\x^{21}-3389132\x^{19}
-17228062\x^{17}-45771560\x^{15}-65325089\x^{13}-49297772\x^{11}-18508228\x^9-
3090272\x^7-192077\x^5-2508\x^3+26\x\big)\y^9+\big(\x^{26}+499\x^{24}
+{\tfrac{54971}{2}}\x^{22}+{\tfrac{963471}{2}}\x^{20}+3698783\x^{18}+14267155\x^{16}
+{\tfrac{58589293}{2}}\x^{14}+{\tfrac{64546337}{2}}\x^{12}+18324283\x^{10}+4804470\x^8
+{\tfrac{907373}{2}}\x^6+{\tfrac{7397}{2}}\x^4-553\x^2-3\big)\y^8+\big(-8\x^{25}
-1344\x^{23}-44228\x^{21}-539160\x^{19}-3067508\x^{17}-9009888\x^{15}-14152800\x^{13}
-11695504\x^{11}-4652360\x^9-672008\x^7+7308\x^5+4412\x^3+72\x\big)\y^7
+\big(28\x^{24}+2366\x^{22}+50998\x^{20}+446884\x^{18}+1901034\x^{16}+4222671\x^{14}
+4948005\x^{12}+{\tfrac{5751153}{2}}\x^{10}+639605\x^8-{\tfrac{52037}{2}}\x^6
-16587\x^4-{\tfrac{1249}{2}}\x^2-1\big)\y^6+\big(-56\x^{23}-2828\x^{21}-42092\x^{19}
-269596\x^{17}-854940\x^{15}-1404926\x^{13}-1159452\x^{11}-389461\x^9+18128\x^7
+30043\x^5+2488\x^3+9\x\big)\y^5+\big(70\x^{22}+2310\x^{20}+24418\x^{18}+114536\x^{16}
+265718\x^{14}+306840\x^{12}+{\tfrac{302491}{2}}\x^{10}-{\tfrac{3703}{2}}\x^8
-{\tfrac{49077}{2}}\x^6-{\tfrac{9289}{2}}-{\tfrac{39\x^2}{2}}\x^4+{\tfrac{3}{2}}\big)\y^4
+\big(-56\x^{21}-1264\x^{19}-9568\x^{17}-32360\x^{15}-52408\x^{13}-37034\x^{11}
-2472\x^9+10104\x^7+3718\x^5+16\x^3-20\x\big)\y^3+\big(28\x^{20}+439\x^{18}
+2350\x^{16}+{\tfrac{10971}{2}}\x^{14}+5505\x^{12}+1064\x^{10}-2161\x^8-1411\x^6-46\x^4
+{\tfrac{127}{2}}\x^2+1\big)\y^2+\big(-8\x^{19}-86\x^{17}-312\x^{15}-451\x^{13}
-168\x^{11}+222\x^9+252\x^7+26\x^5-34\x^3-5\x\big)\y+\big(\x^{18}+7\x^{16}+{\tfrac{31}{2}}
\x^{14}+{\tfrac{19}{2}}\x^{12}-8\x^{10}-17\x^8-4\x^6+5\x^4+{\tfrac{3}{2}}\x^2
+{\tfrac{3}{2}}\big)$,}
\\[0.2cm]
{\tiny $f_2(\x,\y)= \big(2\x^{10}+5\x^8+4\x^6+\x^4\big)\y^{10}+
\big(-20\x^9-40\x^7-24\x^5-4\x^3\big)\y^9+
\big(5\x^{10}+102\x^8+149\x^6+62\x^4+6\x^2\big)\y^8+
\big(-40\x^9-312\x^7-316\x^5-84\x^3-4\x\big)\y^7+
\big(4\x^{10}+149\x^8+600\x^6+395\x^4+58\x^2+1\big)\y^6
+\big(-24\x^9-316\x^7-720\x^5-276\x^3-16\x\big)\y^5
+\big(\x^{10}+62\x^8+397\x^6+504\x^4+85\x^2\big)\y^4+
\big(-4\x^9-84\x^7-284\x^5-168\x^3\big)\y^3
+\big(6\x^8+60\x^6+99\x^4+5\x^2-1\big)\y^2
+\big(-4\x^7-20\x^5-8\x^3+6\x\big)\y+
(\x^6+2\x^4-2\x^2+1).$}

\end{tabular}}
\caption{The second polynomial map}\label{tab:secondMap}
\end{table}
\end{subsection}

\begin{subsection}{The map from the topological proof}

Lastly and after such long polynomials, the map from the topological proof defined in \ref{eq:thirdMap} is showed in its expanded form in Table \ref{tab:thirdMap}. Recall that $\FFF = f_2 \circ f_1$ where $f_1\big(\R^2\big) = \overline{\Qu}$, so we will also be testing how $f_2\big(\overline{\Qu}\big)$ behaves.

\begin{table}[ht!]
\begin{center}
\vspace{1cm}
\framebox{
\begin{tabular}{p{10cm}}
{\tiny $\FFF_1(\x,\y) = \x^{4} \y^{8} + 2   {(\x^{6} - \x^{2})} \y^{6} + {(\x^{8} + \x^{6} - 2   \x^{4} - 2   \x^{2} + 1)} \y^{4} - 2   {(\x^{4} - 1)} \y^{2} + 1$,}
\\[0.2cm]
{\tiny $ \FFF_2(\x,\y) = {(\x^{12} + 2   \x^{8} + \x^{6} + \x^{4})} \y^{4}  - 2   {(\x^{8} + \x^{6} + \x^{4} + \x^{2})} \y^{2} + (\x^{4}+ 2   \x^{2} + 1)$.}
\end{tabular}}
\end{center}
\caption{The third polynomial map}\label{tab:thirdMap}
\end{table}
\end{subsection}

\begin{subsection}{Optimal algebraic structure of the given polynomial maps}

In this section we show the total degree and the total number of (non-zero) monomials from the three polynomial maps, see Table \ref{tab:degreeMon}. We define the \textit{total degree} of a polynomial map to be the sum of the degrees of its components. For instance $\text{deg}(\FFF)=\text{deg}(\FFF_1)+\text{deg}(\FFF_2)=12+16=28$.

\begin{table}[t]
\begin{center}
\begin{tabular}{c || c | c | c}
& Total degree & Total number of monomials & Non-escalar complexity\\ \hline \hline
$g = \P\circ Q \circ H$ & 56 & 167 & 13 \\ \hline
$f=\HH\circ\GG\circ\FF$ & 72 &  350 & 11\\ \hline
$\FFF = f_2 \circ f_1$ & 28 & 22 & 25\\	
\end{tabular}
\caption{Total degree, total number of monomials and non-escalar complexity.}\label{tab:degreeMon}
\end{center}
\end{table}

\end{subsection}

\begin{subsection}{Optimal multiplicative complexity of the given polynomial maps}

When trying to evaluate a polynomial on a certain point in a efficient way, we can consider the number of non-scalar multiplications that the computer needs to perform to get its image. To do this, we assume that if the same product needs to be computed more than once in the same evaluation, the computer will only do it once. In any case we only compute an upper bound of the number of calculations, because depending on how the product is implemented on a certain programming language this value could be smaller.

For instance consider the first polynomial map $g = \P\circ Q \circ H$:
\begin{align*}
&H:\R^2\to\R^2,\ (x,y)\mapsto\big(xy+1,\ x^2(xy+1)(xy+2)+y\big), \\
&Q:\R^2\to\R^2,\ (x,y)\mapsto(x,y-x-1), \\
&\P:\R^2\to\R^2,\ (x,y)\mapsto\big((1-x^3y+y-xy^2)^2+x^4y^2, (1-xy+x-x^4y)^2+x^4y^2\big).\\
\end{align*}
Looking at $H$ we see that the different non-scalar products that need to be computed are $xy, x^2, (xy + 1)(xy+2) \text{ and } x^2(xy + 1)(xy+2)$, that makes 4 in total. In a similar way we get 0 for $Q$ and $9$ for $\P$. In total, an upper bound for $g$ is $4 + 0 + 9 = 13$. Similarly, we obtain $4+4+3=11$ for $f=\HH\circ\GG\circ\FF$ rewritten as
\begin{align*}
&\FF:\R^2\to\R^2,\  (x,y)\mapsto((xy-1)^2+x^2,(xy-1)^2+y^2),\\
&\GG:\R^2\to\R^2,\  (x,y)\mapsto(x,y((xy)^2-4xy+4)+x((xy)^2-2xy+1)),\\
&\HH:\R^2\to\R^2,\  (x,y)\mapsto(xy(x\cdot(xy)-4x+4+\tfrac{1}{2}y),y),
\end{align*}

As for $\FFF$: 
\begin{align*}
\FFF_1(x,y) = &\  x^{4} y^{4}y^4 + 2   {(x^{4}x^2 - x^{2})} y^{4}y^2 + (x^{4}x^4 + x^{4}x^2 - 2   x^{4} - 2   x^{2} + 1) y^{4}\\
&\  - 2   {(x^{4} - 1)} y^{2} + 1, \\
\FFF_2(x,y) =&\ {(x^{4}x^4x^4 + 2   x^{4}x^4 + x^{4}x^2 + x^{4})} y^{4}  - 2   {(x^{4}x^4 + x^{4}x^2 + x^{4} + x^{2})} y^{2} \\
&\ + (x^{4}+ 2   x^{2} + 1).
\end{align*}

we get $14+11=25$. See Table \ref{tab:degreeMon}.

\end{subsection}

\end{section}

\begin{section}{Computational analysis}\label{5sect3}

After all these arguments and explanations, we did a few tests on Sage, in terms of timing and obtaining the resulting regions of $\R^2$. We split this analysis into three cases depending on the chosen domain.

\begin{subsection}{Uniformly distibuted points contained in a square}

The tests we performed related to this were:
\begin{enumerate}[1. ]
\item \textbf{The set of integers contained in $[-10, 10]\times[-10,10]$}, that is:
$$
\PP_1 := \set[\big]{(x,y): -10\le x,y\le 10,\ x, y\in \Z} \subset \R^2.
$$
\item \textbf{The set of integers contained in $[-100, 100]\times[-100,100]$}, that is:
$$
\PP_2 := \set[\big]{(x,y): -100\le x,y\le 100,\ x, y\in \Z} \subset \R^2.
$$
\item \textbf{Grid of $10^6$ points uniformly distributed in $[0, 1]\times[0,1]$} with step $h=\tfrac{1}{999}$:
$$
\PP_3 := \set[\big]{x: x = nh,\ 0\le n\le 999 } \times \set[\big]{y: y=nh,\ 0\le n\le 999 } \subset \R^2.
$$
\item \textbf{Grid of $10^6$ points uniformly distributed in $[-1, 1]\times[-1,1]$} with step $h=\tfrac{2}{999}$:
$$
\PP_4 := \set[\big]{x: x = nh -1,\ 0\le n\le 999 } \times \set[\big]{y: y=nh-1,\ 0\le n\le 999 } \subset \R^2.
$$
\item \textbf{Grid of $4\cdot 10^4$ points uniformly distributed in $[-10, 10]\times[-10,10]$} with step $h=\tfrac{20}{199}$:
$$
\PP_5:=\set[\big]{x:x=nh -10,\ 0\le n\le 199 }\times\set[\big]{y: y=nh-10,\ 0\le n\le199 }\subset\R^2.
$$
\item \textbf{Grid of $4\cdot 10^6$ points uniformly distributed in $[-10, 10]\times[-10,10]$} with step $h=\tfrac{20}{1999}$:
$$
\PP_6:=\set[\big]{x:x=nh -10,\ 0\le n\le 1999 }\times\set[\big]{y:y=nh-10,\ 0\le n\le 1999 }\subset \R^2.
$$
\end{enumerate}

We considered to continue making the set of points bigger, namely a grid of $4\cdot 10^8$ points, but a quick estimation took this idea away from us, because it could take a few hours just for the first polynomial. The execution time results are displayed in Table \ref{tab:square}.

\begin{figure}[ht!]
%\vspace{-0.6cm}
\hspace{0.1cm}
\begin{subfigure}{.49\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_08_P4prime.png}
\vspace{-0.4cm}\caption{$g(\PP_4)$.\label{fig:gP4}}
\end{subfigure}
\begin{subfigure}{.49\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_04_P3.png}
\vspace{-0.4cm}\caption{$g(\PP_3)$.\label{fig:gP3}}
\end{subfigure}\\[1ex]
\vspace{-0.2cm}

\hspace{0.1cm}
\begin{subfigure}{.49\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_05_P3.png}
\vspace{-0.4cm}\caption{$f(\PP_3)$.\label{fig:fP3}}
\end{subfigure}
\begin{subfigure}{.49\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_06_P3.png}
\vspace{-0.4cm}\caption{$\FFF(\PP_3)$.\label{fig:FFFP3}}
\end{subfigure}
\vspace{-0.1cm}\caption{The sets $g(\PP_4),\ g(\PP_3),\ f(\PP_3)$ and $\FFF(\PP_3)$.\label{fig:discAll}}
\end{figure}

\begin{table}[ht!]
\begin{center}
\begin{tabular}{c || c | c | c}
& $g = \P\circ Q \circ H$ & $f=\HH\circ\GG\circ\FF$ & $\FFF$ \\ \hline \hline
$\PP_1$ & 0.19 s & 0.17 s & 0.07 s \\ \hline
$\PP_2$ & 17.38 s & 16.23 s & 6.88 s \\ \hline
$\PP_3$ & 410.73 s (\ref{fig:gP3}) & 389.74 s (\ref{fig:fP3}) & 155.09 s (\ref{fig:FFFP3}) \\ \hline
$\PP_4$ & 408.88 s (\ref{fig:gP4}) & 392.34 s & 155.29 s \\ \hline
$\PP_5$ & 17.10 s & 15.45 s & 7.00 s \\ \hline
$\PP_6$ & 1633.50 s (\ref{fig:gP6_1}-\ref{fig:gP6_2}) & 1640.01 s (\ref{fig:fP6_1}-\ref{fig:fP6_2}) & 625.11 s  (\ref{fig:FFFP6_1}-\ref{fig:FFFP6_2}) \\
\end{tabular}
\caption[Execution times of the computation of points contained in a square.]{Execution times of the computation of uniformly distributed points contained in a square.}\label{tab:square}
\end{center}
\end{table}

\begin{figure}
\hspace{-0.1cm}
\begin{subfigure}{.49\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_16_P6.png}
\vspace{0cm}\caption{$g(\PP_6)$.\label{fig:gP6_1}}
\end{subfigure}
\begin{subfigure}{.49\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_17_P6prime.png}
\vspace{0cm}\caption{$g(\PP_6)$.\label{fig:gP6_2}}
\end{subfigure}\\[1ex]
\vspace{0.4cm}
	
\hspace{-0.1cm}
\begin{subfigure}{.49\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_19_P6.png}
\vspace{0cm}\caption{$f(\PP_6)$.\label{fig:fP6_1}}
\end{subfigure}
\begin{subfigure}{.49\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_20_P6prime.png}
\vspace{0cm}\caption{$f(\PP_6)$.\label{fig:fP6_2}}
\end{subfigure}\\[1ex]
\vspace{0.4cm}

\hspace{-0.1cm}
\begin{subfigure}{.49\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_21_P6.png}
\vspace{0cm}\caption{$\FFF(\PP_6)$.\label{fig:FFFP6_1}}
\end{subfigure}
\begin{subfigure}{.49\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_22_P6prime.png}
\vspace{0cm}\caption{$\FFF(\PP_6)$.\label{fig:FFFP6_2}}
\end{subfigure}
\vspace{0.1cm}\caption{Images of the $4\cdot 10^6$ points from $\PP_6$ through $f, g$ and $\FFF$.\label{fig:P6}}
\end{figure}

In this section we also compare the first and third maps as either a composition or a a fully expanded espression, as shown in Table \ref{tab:firstMap} and Table \ref{tab:secondMap}. The results are shown in Tables \ref{tab:expand1} and \ref{tab:expand2}.

\begin{table}[ht!]
\parbox{.45\linewidth}{
\centering
\begin{tabular}{c || c | c }
$g$ & Composition &Expanded \\ \hline \hline
$\PP_1$&0.19 s&0.23 s \\ \hline
$\PP_5$ & 17.10 s&16.15 s \\ \hline
$\PP_6$ &1633.50 s &1582.08 s \\
\end{tabular}
\caption[Comparison between $g$ on its expanded form or as a composition.]{Comparison between $g= \P\circ Q \circ H$ on its expanded form (Table \ref{tab:firstMap}) or as a composition.}\label{tab:expand1}
}
\hfill
\parbox{.45\linewidth}{
\centering
\begin{tabular}{c || c | c }
$f$ & Composition &Expanded \\ \hline \hline
$\PP_1$ & 0.17 s & 0.40 s \\ \hline
$\PP_5$ & 15.45 s & 26.50 s \\ \hline
$\PP_6$ & 1640.01 s & 2650.13 s \\
\end{tabular}
\caption[Comparison between $f$ on its expanded form or as a composition.]{Comparison between $f=\HH\circ\GG\circ\FF$ on its expanded form (Table \ref{tab:secondMap}) or as a composition.}\label{tab:expand2}
}
\end{table}

Lastly, we recall that $\FFF=f_2\circ f_1$, where $f_1(\x,\y)=(\x^2,\y^2)$, so $f_1\big(\R^2\big) =\overline{\Qu}$. Thus, we study $f_2\big(\overline{\Qu}\big)$ instead of computing $\FFF\big(\R^2\big)$. We used a grid of $10^6$ points uniformly distributed in $[0, 10]\times[0,10]$ with step $h=\tfrac{10}{999}$:
$$
\PP_7 := \set[\big]{x: x=nh,\ 0\le n\le 999 }\times\set[\big]{y: y=nh,\ 0\le n\le 999 }\subset \R^2.
$$
It took 149.99 s for $f_2$ to compute the image of the $10^6$ points from $\PP_7$, which is very close to the 155.09 s and 155.29 s that it took $\FFF$ to compute the image of the $10^6$ points from $\PP_3$ and $\PP_4$ respectively. Note that this makes sense since the only difference between computing the image of a set under $\FFF= f_2\circ f_1$ or $f_2$ is that with $\FFF$ you first compute the image under $f_1$, which should not take a lot of time because of its simplicity, and then you compute the image under $f_2$ of the resulting set.
% comparar con las imagenes de F(P_3) y F(P_4)
\end{subsection}

\begin{subsection}{Using families of curves}
It this section we recall the condition that any polynomial map that has $\Qu$ as an image must verify:
\begin{center}
\begin{tabular}{rr}
$\qquad \qquad\quad$ \fbox{\textit{The closure of its image must contain the positive half-axes.}} & $\quad\quad$ ($\clubsuit$)
\end{tabular}
\end{center}
\vspace{0.2cm}
We used in  Chapter 2 certain families of curves whose images approach the axes, namely:
$$
\alpha_{\lambda}(s,a_\lambda):=\left(s,\frac{1+a_{\lambda }s}{s}\right)
\quad \text{ and } \quad
\beta_{\mu}(s,b_\mu):=\left(\frac{1+b_{\mu }s}{s},s^{3}\right).
$$
In this section we use as the domain of the curves the grid of $10^6$ points uniformly distributed in $[-10, 10]\times[-10,10]$ with step $h=\tfrac{20}{999}$:
$$
\PP_8:=\set[\big]{x: x=nh-10,\ 0\le n\le 999 }\times\set[\big]{y:y=nh-10,\ 0\le n\le 999}\subset\R^2.
$$
First, for each point $(s,a_\lambda) \in \PP_8$ we computed $\alpha_{\lambda}\big((s, a_\lambda)\big)$, and then we applied $g$ to that set of points. We did the same for $(s, b_\mu) \in \PP_8$, obtaining $g\big(\beta_{\mu}\big((s, b_\mu)\big)\big)$. The timing tests are displayed in Table \ref{tab:curves1}.

\begin{table}[ht!]
\parbox{.45\linewidth}{
\centering
\begin{tabular}{c || c }
 & Time  \\ \hline \hline
\\[-1em]
$\alpha_{\lambda}\big((s,a_\lambda)\big)$ &  129.27 s\\ \hline
\\[-1em]
$\beta_{\mu}\big((s,b_\mu)\big)$ &133.76 s \\ \hline
\\[-1em]
$g\big(\alpha_{\lambda}\big((s,a_\lambda)\big)\big)$ & 398.04 s  \\ \hline
\\[-1em]
$g\big(\beta_{\mu}\big((s,b_\mu)\big)\big)$ & 399.02 s \\
\end{tabular}
\caption[]{Execution times when computing the image of curves through $g$.}\label{tab:curves1}
}
\hfill
\parbox{.45\linewidth}{
\centering
\begin{tabular}{c || c }
 & Time  \\ \hline \hline
\\[-1em]
$\gamma_{\lambda}\big((s, a_\lambda)\big)$ & 133.64 s \\ \hline
\\[-1em]
$\delta_{\mu}\big((s, b_\mu)\big)$ &127.90 s \\ \hline
\\[-1em]
$f_2\big(\gamma_{\lambda}\big((s, a_\lambda)\big)\big)$ & 141.92 s  \\ \hline
\\[-1em]
$f_2\big(\delta_{\mu}\big((s, b_\mu)\big)\big)$ & 143.21 s \\
\end{tabular}
\caption[]{Execution times when computing the image of curves through $f_2$.}\label{tab:curves3}
}
\end{table}

We can proceed in exactly the same way with a new family of curves for $f_2$:
$$
\gamma_\lambda(s, a_\lambda) = \left(\frac{1+a_\lambda s}{s}, s^2\right)
\quad \text{ and } \quad
\delta_\mu(s, b_\mu) = \left(s, \frac{1+b_\mu s}{s}\right).
$$
The computation times can be seen in Table \ref{tab:curves3}. The images of the curves through $g$ and $f_2$ are shown in Figure \ref{fig:curvesfg}.

\begin{figure}
\vspace{-0.6cm}
\hspace{0.4cm}
\begin{subfigure}{.45\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_25_1curves3.png}
\vspace{-0.4cm}\caption{$g(\alpha_{\lambda})$ and $g(\beta_{\mu})$.\label{fig:1curves1}}
\end{subfigure}
\begin{subfigure}{.45\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_29_3curves3.png}
\vspace{-0.4cm}\caption{$f_2(\alpha_{\lambda})$ and $f_2(\beta_{\mu})$.\label{fig:3curves1}}
\end{subfigure}\\[1ex]
\vspace{-0.2cm}
	
\hspace{0.4cm}
\begin{subfigure}{.45\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_24_1curves2.png}
\vspace{-0.4cm}\caption{$g(\alpha_{\lambda})$ and $g(\beta_{\mu})$.\label{fig:1curves2}}
\end{subfigure}
\begin{subfigure}{.45\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_30_3curves4.png}
\vspace{-0.4cm}\caption{$f_2(\alpha_{\lambda})$ and $f_2(\beta_{\mu})$.\label{fig:3curves2}}
\end{subfigure}\\[1ex]
\vspace{-0.2cm}

\hspace{0.4cm}
\begin{subfigure}{.45\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_26_1curves4.png}
\vspace{-0.4cm}\caption{$g(\alpha_{\lambda})$ and $g(\beta_{\mu})$.\label{fig:1curves3}}
\end{subfigure}
\begin{subfigure}{.45\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_30_3curves5.png}
\vspace{-0.4cm}\caption{$f_2(\alpha_{\lambda})$ and $f_2(\beta_{\mu})$.\label{fig:3curves3}}
\end{subfigure}
\vspace{-0.1cm}\caption{Images of families of curves for $g$ and $f_2$: $\alpha_{\lambda}$ in orange and $\beta_{\mu}$ in purple.\label{fig:curvesfg}}
\end{figure}

\end{subsection}

\begin{subsection}{Randomly distributed points contained in a disc}
When thinking of the possible domain that the polynomial maps could have, we thought of points randomly distributed on a square. However we opted for doing it on the unit disc. The points are generated by means of a random argument $\theta\in[0,2\pi]$ and a random radius; first with $\rho\in[0,1]$, and $\rho\in[0,100]$ afterwards. Then, each point is generated as $(\rho\cos\theta,\rho\sin\theta)$. The result is a subset of $10^5$ points of the disc that presents a higher concentration of points when we get closer to the origin. Of course this is not a problem for our study case. See Figure \ref{fig:disc}. The timing tests are shown in Table \ref{tab:disc}.

\begin{figure}[ht!]
\vspace{-0.6cm}
\hspace{0.1cm}
\begin{subfigure}{.45\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_34_disc.png}
\vspace{-0.4cm}\caption{Set of $10^5$ points contained in ${\mathbb D}_1$.\label{fig:disc}}
\end{subfigure}
\begin{subfigure}{.49\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_35_disc1.png}
\vspace{-0.4cm}\caption{$g({\mathbb D}_1)$.\label{fig:disc1}}
\end{subfigure}\\[1ex]
\vspace{-0.2cm}

\hspace{0.1cm}
\begin{subfigure}{.49\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_37_disc2.png}
\vspace{-0.4cm}\caption{$f({\mathbb D}_1)$.\label{fig:disc2}}
\end{subfigure}
\begin{subfigure}{.49\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_39_disc3.png}
\vspace{-0.4cm}\caption{$\FFF({\mathbb D}_1)$.\label{fig:disc3}}
\end{subfigure}
\vspace{-0.1cm}\caption{Images of points in ${\mathbb D}_{1}$.\label{fig:discAll}}
\end{figure}

\vspace{0.2cm}

\begin{table}[ht!]
\begin{center}
\begin{tabular}{c || c | c | c}
& $g = \P\circ Q \circ H$ & $f=\HH\circ\GG\circ\FF$ & $\FFF$ \\ \hline \hline
${\mathbb D}_1$ & 131.97 s (\ref{fig:disc1}) & 99.56 s (\ref{fig:disc2}) & 32.02 s (\ref{fig:disc3}) \\ \hline
${\mathbb D}_{100}$ & 131.62 s & 100.84 s & 32.36 s \\
\end{tabular}
\caption[Execution times of the computation of points contained in ${\mathbb D}_{1}$ and ${\mathbb D}_{100}$.]{Execution times of the computation of ramdomly distibuted points in ${\mathbb D}_{1}$ and ${\mathbb D}_{100}$.}\label{tab:disc}
\end{center}
\end{table}

\end{subsection}

\end{section}

\begin{section}{Conclusions and future research}\label{5sect4}

As we have seen in the previous section, the third map $\FFF$ outstrips the other two maps in the timing tests. This is to be expected from the ideas developed in Section \ref{5sect2}. Also, even though the second map $f$ was by far the one that provided the easiest proof for Theorem \ref{openQuad}, the Figures from the previous section show that it is not very good at filling a big area of the open quadrant $\Qu$. Lastly, the first map $g$ was reasonably good in terms of covering $\Qu$, but not so much in terms of execution time.

All of this could just be considered as an appetizer for finding a polynomial map with the least possible total degree and the least possible number of monomials:
\begin{problem}
\begin{enumerate}[(i)]
\item Which is the minimum total degree for a polynomial map $\R^2 \to \R^2$ having $\Qu$ as image?
\item Which is the sparsest polynomial map $\R^2 \to \R^2$ whose image is $\Qu$?
\end{enumerate}
\end{problem}

The authors haven't stopped working on the problem, and we present right now some new candidates whose images could be $\Qu$:
\begin{align*}
\cdot\ \mathcal{N}_1:\R^2 &\to R^2, \\
(x,y)&\mapsto\big(x^4y^4+(x^2y+xy^2-1)^2(y^2+1),\ x^4y^4+(x^2y+xy^2-1)^2(x^2+1)\big),\\
\cdot\ \mathcal{N}_2:\R^2 &\to \R^2, \\
(x,y)&\mapsto\big(x^2y^2+(x^2y+xy^2-1)^2(y^2+1),\ x^2y^2+(x^2y+xy^2-1)^2(x^2+1)\big),\\
\cdot\ \mathcal{N}_3:\R^2 &\to \R^2, \\
(x,y)&\mapsto\big(x^6y^4+(x^2y+xy^2-1)^2(y^2+1),\ x^4y^6+(x^2y+xy^2-1)^2(x^2+1)\big).
\end{align*}
It is remarkable how good their properties are in terms of total degree and number of monomials, see Table \ref{tab:newDegreeMon}.

\begin{table}[ht!]
\begin{center}
\begin{tabular}{c || c | c | c}
& Total degree & Total number of monomials & Non-escalar complexity\\ \hline \hline
$\mathcal{N}_1$&16&24&11 \\ \hline
$\mathcal{N}_2$&16&26&7 \\ \hline
$\mathcal{N}_3$&20&26&15 \\	
\end{tabular}
\caption{Properties of the new maps.}\label{tab:newDegreeMon}
\end{center}
\end{table}
Note that the symmetry of the maps above converts them in good candidates to minimize the upper-bound of the non-escalar complexity. We have used the following pair of families of curves to approach the axes:

$$
\sigma_\lambda(s, a_\lambda) = \left(s^2 + a_\lambda s^3,\ \frac{1}{s}\right)
\quad \text{ and } \quad
\tau_\mu(s, b_\mu) = \left(\frac{1}{s},\ s^2 + b_\mu s^3\right).
$$
The execution times for $\mathcal{N}_1$ and $\mathcal{N}_2$ are displayed respectively in Tables \ref{tab:curvesNew1} and \ref{tab:curvesNew2}.

\begin{table}[ht!]
\parbox{.45\linewidth}{
\centering
\begin{tabular}{c || c }
 & Time  \\ \hline \hline
\\[-1em]
$\sigma_{\lambda}\big((s, a_\lambda)\big)$ &  133.15 s\\ \hline
\\[-1em]
$\tau_{\mu}\big((s, b_\mu)\big)$ &129.80 s, \\ \hline
\\[-1em]
$\mathcal{N}_1\big(\sigma_{\lambda}\big((s, a_\lambda)\big)\big)$ & 148.88 s \\ \hline
\\[-1em]
$\mathcal{N}_2\big(\tau_{\mu}\big((s, b_\mu)\big)\big)$ & 153.14 s \\
\end{tabular}
\caption[]{Execution times when computing the image of curves through $\mathcal{N}_1$.}\label{tab:curvesNew1}
}
\hfill
\parbox{.45\linewidth}{
\centering
\begin{tabular}{c || c }
 & Time  \\ \hline \hline
\\[-1em]
$\sigma_{\lambda}\big((s, a_\lambda)\big)$ &  133.15 s\\ \hline
\\[-1em]
$\tau_{\mu}\big((s, b_\mu)\big)$ &129.80 s, \\ \hline
\\[-1em]
$\mathcal{N}_1\big(\sigma_{\lambda}\big((s, a_\lambda)\big)\big)$ & 148.23 s  \\ \hline
\\[-1em]
$\mathcal{N}_2\big(\tau_{\mu}\big((s, b_\mu)\big)\big)$ & 148.84 s \\
\end{tabular}
\caption[]{Execution times when computing the image of curves through $\mathcal{N}_2$.}\label{tab:curvesNew2}
}
\end{table}

Note how good $\mathcal{N}_1$ seems to be on approaching the positive half-axes for this family of curves. Even when checking on $[0, 0.1]\times[0, 0.1]$ it fills plenty of area towards the axes. See Figures \ref{fig:4curves1} and \ref{fig:5curves1}.

\begin{figure}
%\vspace{-0.6cm}
\hspace{0.4cm}
\begin{subfigure}{.45\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_32_4curves2.png}
\vspace{-0.4cm}\caption{$\mathcal{N}_1(\sigma_{\lambda})$ and $\mathcal{N}_1(\tau_{\mu})$.\label{fig:4curves1}}
\end{subfigure}
\begin{subfigure}{.45\linewidth}\centering
\includegraphics[width=1\textwidth]{plots/ch5_33_4curves3.png}
\vspace{-0.4cm}\caption{$\mathcal{N}_2(\sigma_{\lambda})$ and $\mathcal{N}_2(\tau_{\mu})$.\label{fig:5curves1}}
\end{subfigure}\\[1ex]
\vspace{-0.2cm}

\vspace{-0.1cm}\caption{Images of families of curves for $\mathcal{N}_1$ and $\mathcal{N}_2$: $\sigma_{\lambda}$ in green and $\tau_{\mu}$ in blue.\label{fig:curvesfg}}
\end{figure}

\subsection{Comments on further reductions}

\subsubsection{Reduction of multiplications using powers of 2}

Aside from the optimal algebraic structure and the optimal multiplicative complexity, there is another measurement that could be considered when talking about the complexity of the given polynomials.

It is well know that for a computer it is far way easier to compute multiplications and divisions by powers of 2 than any other number, because that translates into a simple shift in the array of bits. For instance consider the number $20 = 2^4 + 2^2$ expressed in base 2 with 8 bits: $(20)_{10} = (0001\ 0100)_2$. Then, if we want to multiply $20\cdot 4$ the computer can just shift the array two positions (because $4=2^2$) to the left, namely:
$$(20 \cdot 4)_{10} = (0101\ 0000)_2 = (80)_{10}.$$
It is clear that the other way around also works for division, shifting to the right:
$$(80 / 16)_{10} = (0000\ 1010)_2 = (5)_{10}.$$

This is exactly what scholars do to multiply or divide an integer by a power of $10$; they either add zeros or move the  comma. Computers have had for years logic units that compute this shiftings flawlessly. Thus, we could focus on obtaining a polynomial map that only has powers of 2 as multiplicative factors on its components. Note that the three new maps and the one from the topological proof verify this condition. Indeed, this factor equals 2 for all of them.

\subsubsection{Reduction of multiplications using hash tables and concurrency}

There is an idea that could be implemented when computing the image of a given set of points through a map: relying on parallelism.

Let $f(\x,\y):=(f_1(\x,\y),f_2(\x,\y))$ be any of the maps we were working with in this work. Taking advantage of the number of kernels computers have nowadays, we could use the readers-writers problem from concurrent computing and a data structure like a hash table. There would be one thread for $f_1$ and one for $f_2$, and both threads would be both readers and writers on the hash table. The key of this hash table would be a monomial (or a part of it), for instance $x^2$ or $x^4y^2$. The value associated to that key would be the computation of that monomial given the current point.

Let $p:=(x,y)$ be a point of the set of points we are using as a domain. When the programme starts, we would launch both threads. At each step the computation of $f_1(p)$ involves to calculate a non-scalar multiplication (like the examples we just stated) it would look for it on the hash table. If its there, then there is no need to compute the multiplication, just get the value. If the key is not in the hash table, compute it and add a new entry to the hash table with this computation. The thread for $f_2(p)$ would work in the same way. This way each non-scalar multiplication would be computed only once.

The remarkable fact is that this implementation could easily be generalized for computing $f$ when it would be a composition of other maps, say $f=g\circ h$. The programme would act in the same way, starting computing $h(p):=(h_1(p), h_2(p))$ for every $p$ by updating the hash table with each new point $p$. Then, when this phase would be over, we would have to delete the content in the hash table and proceed in the same way for $g(h(p))= g((h_1(p), h_2(p)))$.

The only inconvenience would be working with symbolic expressions in Java or C++, which is far way easier with Sage (as far as I know). In any case, this implementation would probably mean a improvement in the execution time, because searching for a key in a (relatively small) hash table would be quicker than re-computing the multiplication. Indeed, searching a value on a hash table requires on average constant time $O(1)$, whereas computing the multiplication of two $n$-digits numbers is for example $O(n^{1.585})$ for Karatsuba's algorithm. If for instance for each point we avoid computing two out of ten monomials, an upper bound for the total new time would be 20\% less than the original time.

\end{section}

%Pendiente: Añadir consecuencia ---> El interior y el complementario de un ángulo son imágenes polinómicas de R^2 (Tesis Ueno)

% Paper 2:
%A similar argument applies to prove that the complement in $\R^n$ of an $n$-dimensional convex polyhedron is a polynomial image of $\R^n$ \cite{fu2}, which uses  an inductive process starting with the complement of the open orthant. In order to represent this complement of the orthant as a polynomial image we need first to obtain the complement of the (closed) quadrant in $\R^2$  as a polynomial image, and this is achieved by applying to the open quadrant (considered in $\C$) the polynomial map $z\mapsto z^3$. Thus, the representation of the open quadrant as a polynomial image of $\R^2$ is the seed in many inductive processes that allows us to determine the semialgebraic sets with piecewise linear boundary that are polynomial or regular images of $\R^n$. 

\end{chapter}

\appendix
\begin{chapter}{Auxiliary definitions and results}\label{AA}

\begin{section}{Real algebraic geometry basics}
In this section we give a basic insight into the required concepts, definitions and results from real algebraic geometry. They are mostly used on the first chapter.

We begin with some definitions like \emph{real closed field} and \emph{semialgebraic set}. The \emph{Transfer Principle} allows us to move our results from $\R$ to an arbitrary real closed field $R$. We also give an overview of the \emph{Zariski topology}, in order to talk about concepts like closure or \emph{reducibility} in this topology. Finally, after defining other notions as \emph{proper maps} and \emph{germ Nash half-branch curves}, we finish the section recalling \emph{Puiseux series}, since this is the nature of the solutions of the equation $\Delta_v(x)=0$ in the first proof of Theorem \ref{openQuad}.
\begin{definition}\label{realCField}
	A \em real closed field \em is an ordered field $R$ such that $R(\sqrt{-1})$ is an algebraically closed field. There exist many characterizations of real closed fields. A very enlightening one is the following: $R$ is a real closed field if it is an ordered field that shares with the field $\R$ of real numbers its properties of the first-order language of ordered fields. 
\end{definition}

Indeed, \hyperref[tarskiSeidenberg]{Tarski-Seidenberg Theorem} admits a useful formulation in model theory that explains accurately our last sentence.

\begin{definitions}\label{semialgSet} (i) Let $R$ be a real closed field. A subset $S\subset R^n$ is \em semialgebraic \em if it is defined as a finite union of sets defined by a conjunction of polynomial equalities and inequalities: 
	\begin{equation*}
	\left\{
	\begin{aligned}
		P_1({\tt x}_1,\, .\,&.\,.\,,{\tt x}_n)=0\\
		&\vdots\\
		P_r({\tt x}_1,\, .\,&.\,.\,,{\tt x}_n)=0\\
		Q_1({\tt x}_1,\, .\,&.\,.\,,{\tt x}_n)>0 \\
		&\vdots\\
		Q_{\ell}({\tt x}_1,\, .\,&.\,.\,,{\tt x}_n)>0\\
	\end{aligned}
	\right.
	\end{equation*}
It is easily seen that finite unions and intersections of semialgebraic sets are semialgebraic sets too. In addition, the complementary set of a semialgebraic set is also a semialgebraic set. The easy proof of these facts can be studied in \cite{bcr}, Ch.2.
	
	
(ii) A map $f:S\to T$ between semialgebraic subsets $S\subset R^n$ and $T\subset R^m$ is \em semialgebraic \em if its graph is a semialgebraic subset of $R^{m+n}$.  \end{definitions}


(iii) A \em semialgebraic homeomorphism \em between two semialgebraic subsets $S\subset R^n$ and $T\subset R^m$ is a continuous and bijective semialgebraic map $f:S\to T$. It is easily seen that in such a case its inverse $f^{-1}:T\to S$ is also semialgebraic.

\begin{theorem}[\em Transfer Principle\em]\label{TP} \em Let ${\mathcal L}(R)$ be the first-order language of ordered fields with parameters in the real closed field $R$ and let $\Phi$ be a formula of ${\mathcal L}(R)$. Then, there exists a quantifier-free formula $\Psi$ of ${\mathcal L}(R)$ with the same free variables ${\tt x}_1,\dots,{\tt x}_n$ as $\Phi$ such that, for every real closed field extension $K$ of $R$ and every $x\in K^n$, the sentence $\Phi(x)$ holds true if and only if $\Psi(x)$ holds true.\em

\end{theorem}

\begin{definition}[Zariski topology]\label{zariski} (i) Let $K$ be a field. A subset $X\subset K^n$ is \em algebraic \em if it is the set of common zeros of a finite family of polynomials $f_1,\dots,f_m\in K[{\tt x}_1,\dots,{\tt x}_n]$. 

(ii) The \em Zariski topology \em of an algebraic set $X\subset K^n$ is the topology whose closed sets are the algebraic subsets of $K^n$ contained in $X$. It is indeed a topology, that is, the arbitrary intersection of algebraic sets is also an algebraic set as an straightforward consequence of Hilbert's basis theorem.

(iii) An algebraic subset $X\subset K^n$ is said to be \em reducible \em if there exist algebraic subsets $Y\subsetneq X$ and  $Z\subsetneq X$ such that $X=Y\cup Z$. If $X$ is not reducible it is said to be  \em irreducible. \em 
\end{definition}

\begin{definition}\label{pureDim} (i) Let $S\subset\R^n$ be a semialgebraic set and $p\in S$. The \em local dimension of $S$ at $p$, \em denoted $\dim(S_p)$, is the largest non-negative integer $d$ such that for every open ball $B$ centered at $p$ the intersection $S\cap B$ contains a semialgebraic subset semialgebraically homeomorphic to the cube $[0,1]^d$.

	It is said that $S$ is \em pure dimensional \em if $\dim(S_p)=\dim(S_q)$ for every pair of points $p,q\in S$.
\end{definition}

\begin{definitions}\label{properMap}
	  (i) A continuous map $f:X\to Y$ between topological spaces $X$ and $Y$ is said to be \em proper \em if $f^{-1}(K)$ is a compact subspace of $X$ for every compact subspace $K$ of $Y$. 
	  
	  (ii) A semialgebraic map $f:S\to T$ between semialgebraic sets $S\subset R^n$ and $T\subset R^m$ is said to be \em semialgebraically proper \em if $f^{-1}(K)$ is bounded and closed in $S$ for every bounded and closed in $T$ subset $K$ of $T$.  
\end{definitions}

\begin{definition}\label{dominant}
	A polynomial map $f:X\to Y$ between algebraic sets $X$ and $Y$ is said to be \em dominant \em if its image $f(X)$ is a dense subset of $Y$ in its Zariski topology. 
\end{definition}

\begin{definitions}\label{curveGerms}
	(i) A function $f:U\to\R$ defined in an open semialgebraic subset $U\subset\R^n$ is a \em Nash function \em if it is analytic and semialgebraic. 
	
	(ii) A map $f:=(f_1,\dots,f_m):U\to\R^m$ is a \em Nash map \em if each coordinate $f_i:U\to\R$ is a Nash function. 
	
	(iii) Let $\Gamma\subset\R^n$ be an algebraic curve and $p\in\Gamma$. For every small enough $\eps>0$ the intersection $B_{\eps}\cap\Gamma\setminus\{a\}$, % Aqui no sería p en vez de a?
where $B_{\eps}\subset\R^n$ is the open ball of radius $\eps$ centered at the point $p$, has finitely many connected components $C_1,\dots,C_k$. Each $C_i$ is semialgebraically homeomorphic to the interval $(0,1]$ and in fact for $i=1,\dots,k$ there exists a Nash homeomorphism  $f_i:[0,1]\to C_i\cup\{p\}$, with $f_i(0)=p$.

Indeed, this result is a particular case of the local conic structure theorem of semialgebraic sets, \cite[IX.3.6]{bcr}. 
	
Observe that, by its very definition, it makes sense to define the germs $C_{i,p}$ of $C_i$ at the point $p$ for $i=1,\dots,k$ as they are independent of the radius $\eps$. These germs  $C_{i,p}$ are called the \em germ Nash half-banches \em of the curve $\Gamma$ centered at $p$. For more details see \cite[IX.5.2]{bcr}. 
\end{definitions}

\begin{definition} \label{puiseux} It is proved in \cite[pp. 98-102]{w} that given an algebraically closed field $K$ and an indeterminate ${\tt t}$ over $K$, the field $K\left(\set{{\tt t}^*}\right)$ of \em Puiseux series \em with coefficients in $K$ is algebraically closed. As it is an algebraic extension of the field $K\left({\tt t}\right)$ of rational functions over $K$, the field $K\left(\set{{\tt t}^*}\right)$ is an algebraic closure of the field $F({\tt t})$ for every subfield $F$ of $K$ such that the field extension $K|F$ is algebraic. In particular, for $F:=\R$ it follows that $\C\left(\set{{\tt t}^*}\right)$ is an algebraic closure of $\R({\tt t})$.
\end{definition}
\end{section}

\begin{section}{Root finding algorithms}
The first proof of Theorem \ref{openQuad} requires frequently to check whether a given polynomial $f$ has some root on a certain interval $I$. Sometimes we want to check that $f$ is positive or negative on $I$. To that end it suffices to evaluate it at an arbitrary point $a\in I$ and to check that $f$ has no root on $I$.

Sturm's method is used to compute the number of different real roots of a polynomial in a given interval. Note that it is an algebraic method that doesn't rely on approximations.

\begin{definitions}\label{sturmSeq} (i) Let $R$ be a real closed field and let $f\in\R[{\tt t}]$. The \emph{Sturm sequence} (or \emph{Sturm chain}) of $f$ is the finite sequence of polynomials $(f_0,f_1,\dots,f_k)$ defined as follows: 
\begin{equation*}
\begin{aligned}
f_0&:=f\\
f_1&:=f'\\
&\dots\\
f_i&:=f_{i-1}q_i-f_{i-2}, \text{ with }q_{i}\in R[{\tt x}] \text{ and } \text{deg}(f_{i})<\text{deg}(f_{i-1}) \text{ for } i=2\dots,k.\\
\end{aligned}
\end{equation*}
Then, by Euclid's Algorithm, there is an integer $k$ satisfying $f_k=\text{gcd}(f,f')$.
	
(ii) Given a sequence $(a_0, a_1, \dots, a_k)$ of elements of $R$ with $a_0 \ne 0$, we define the \emph{number of sign changes in the sequence} $(a_0, \dots, a_k)$ as follows: count one sign change every time $a_ia_{\ell} < 0$, with 
\begin{equation*}
\begin{aligned}
&\ell=i+1 \text{, or }\\
&\ell>i+1 \text{ and }a_j=0 \text{ for every } j \text{ satisfying  } i<j<\ell.\\ 
\end{aligned}
\end{equation*}

(iii) If $a\in R$ is not a root of $f$ and $(f_0,\dots,f_k)$ is the Sturm sequence of $f$, we define $v(f;a)$ to be the number of sign changes in $(f_0(a),\dots,f_k(a))$.
\end{definitions}
\begin{proposition}[Sturm's Theorem]\label{sturm} 
Let $R$ be a real closed field and $f\in R[{\tt t}]$. Let $a,b\in R$ be such that $a<b$ and neither $a$ nor $b$ are roots of $f$. Then the number of roots of $f$ in the interval $(a,b)$ equals $v(f;a)-v(f;b)$.

\em The proof of this proposition can be studied in \cite[1.2.10]{bcr}. \em
\end{proposition}

Laguerre's method differs from Sturm's method in that it is a numerical algorithm, rather than algebraic, to decide if a polynomial with real coefficients has a real root. It is remarkable that it converges to a root, with very few exceptions, from any initial value.

\begin{proposition}[Laguerre's method]\label{laguerre}
Let $f\in\R[{\tt x}]$ be a polynomial of degree $n$ and write it as
\begin{equation*}\label{eq:lagPol}
f({\tt x})=\prod_{i=1}^n \left({\tt x}-x_i\right),
\end{equation*}
where $x_i\in\C,\ i=1,\dots, n,$ are its roots. Consider
$$
\ln \abs{f({\tt x})}=\ln\abs[\Big]{\prod_{i=1}^n \left({\tt x}-x_i\right)} = \sum_{i=1}^n \ln\abs{\x - x_i}.
$$
Then, taking its derivative:
$$
\left(\ln \abs{f({\tt x})}\right)'=\left(\sum_{i=1}^n \ln\abs{\x - x_i}\right)'=\sum_{i=1}^n \big(\ln\abs{\x - x_i}\big)' = \sum_{i=1}^n \frac{1}{\x - x_i} = \frac{f'(\x)}{f(\x)}:= g(\x).
$$
Also, consider
$$
-g(\x)'= -\sum_{i=1}^n \left(\frac{1}{\x - x_i}\right)' = \sum_{i=1}^n \frac{1}{(\x - x_i)^2} =g^2({\tt x})-\frac{f''({\tt x})}{f({\tt x})}:= h(\x).
$$
Now, making a ``rather drastic set of assumptions'' \em(\cite[page 187]{a})\em, suppose that the root we are seeking $x_1$ is isolated and that the rest of them $x_i$ are clustered at a certain distance from it, namely: $a = \x - x_1$ and $b = \x -x_i, i=2,\dots, n.$ Then, we can rewrite $g$ and $h$ as: 
$$
g({\tt x})=\frac{1}{{\tt x}-x_1}+\frac{n-1}{{\tt x}-x_i} = \frac{1}{a}+\frac{n-1}{b} \ \text{ and } \ h({\tt x})=\frac{1}{({\tt x}-x_1)^2}+\frac{n-1}{({\tt x}-x_i)^2} = \frac{1}{a^2}+\frac{n-1}{b^2}.
$$
Then, if we solve for $a$, we get a quadratic equation, whose solution is named \em Laguerre's formula\em:
\begin{equation}\label{eq:lagEq}
a=\frac{n}{g({\tt x})\pm\sqrt{(n-1)(nh({\tt x})-g^2({\tt x}))}}.
\end{equation}

Equation \em \ref{eq:lagEq} \em defines an iterative algorithm in the following way:
\em
\begin{enumerate}[(1)]
\item Start with a trial random value $x_0$.
\item Compute $f(x_k)$, and if $\abs{f(x_k)}$ is smaller than a certain threshold, stop the algorithm and return $x_k$. If not, go to step (3).
\item Compute $g(x_k)$ and $h(x_k)$. Compute $a$ using \ref{eq:lagEq}, by choosing the sign that results in the larger magnitude of the denominator. Take the new root to be:
$$
x_{k+1}=x_k-\frac{n}{g(x_k)\pm\sqrt{ (n-1)(nh(x_k)-g^2(x_k))}}.
$$ 
\item Go to step (2).
\end{enumerate}
\em
\end{proposition}

A possible implementation for this algorithm is shown in Appendix \ref{lagSec}, using Python.

%Furthermore, this iterative formula works with any polynomial, not just with the ones described by equation \em \ref{eq:lagPol}. \em 
%{\bf El algoritmo, tal y como se describe, parece fuertemente ligado al hecho de que $f$ tenga una ra\'iz, tal vez compleja, de multiplicidad $n-1$. Por eso no entiendo qu\'e significa que la f\'ormula funciona para polinomios cualesquiera!!!}

\end{section}
\end{chapter}

\begin{chapter}{Python code}\label{BB}
\begin{section}{Laguerre's Method}\label{lagSec}
\pythonexternal{../Laguerre/polyRoots.py}	
\end{section}

\begin{section}{Examples}\label{exLagSec}

\begin{center}\pythonexternal{../Laguerre/polyExample.py}	\end{center}

\vspace{0.4cm}
Output for the given examples:

\begin{itemize}
\item \textbf{Example 1: }
\begin{lstlisting}[frame=tbrl]
x^4 - 5x^3 - 9x^2 + 155x - 250
Roots are:
[(2+0j),
 (4-3j),
 (4+3j),
 (-5+0j)] 
\end{lstlisting}
\item \textbf{Example 2:}
\begin{lstlisting}[frame=tbrl]
x^7 + 2x^4 + x^3 + x
Roots are:
[(0.224542684789-0.690314534559j),
 (-9.29688929465e-14+0j),
 (0.224542684789+0.690314534559j),
 (0.780156137307+1.03569383548j),
 (-1.0046988221+0.345379300925j),
 (0.780156137307-1.03569383548j),
 (-1.0046988221-0.345379300925j)] 
\end{lstlisting}
\item	 \textbf{Example 3:}
\begin{lstlisting}[frame=tbrl]
Delta(x, 0.28^2)
Roots are:
[(0.235691061376+0j),
 (-0.527292033951-0.194675359692j),
 (-0.527292033951+0.194675359692j),
 (-1.7584904885+0.0707240369592j),
 (-1.7584904885-0.0707240369592j),
 (4.33587398352+0j)] 
\end{lstlisting}
\end{itemize}

\end{section}

\end{chapter}

\begin{chapter}{Sage code}\label{CC}
\begin{section}{Computations related to Chapter 1}
Graphs from Example \ref{introExample} (ii).
\begin{sage}
var('x, y')
hyper = region_plot([x*y<1], (x, -10, 10), (y, -10, 10), alpha=0.9, bordercol='blue', incol='lightblue', legend_label='$S_1$')
hyper.axes_labels(['$u$', '$v$'])
hyper.save('ch1_01_S_1.svg')
\end{sage}

\begin{sage}
hyper_other = region_plot([x*y>1, x>0], (x,-2,10), (y,-2,10), alpha=0.9, bordercol='blue', incol='lightblue')
hyper_other.axes_labels(['$u$', '$v$'])
hyper_other.save('ch1_02_S_2.svg')
\end{sage}

\end{section}

\begin{section}{Computations related to Chapter 2}

Define the polynomials $\F_1, \F_2, \G_1, \G_2, \F, \G$ and $\P$ in $\R[\x, \y]$.
\begin{sage}
var('a, b, s, x, y')
F_1(x, y) = 1 - x**3 * y + y - x*y**2
F_2(x, y) = x**2 * y
G_1(x, y) = 1 - x * y + x - x**4 * y
G_2(x, y) = x**2 * y
F(x, y) = F_1**2 + F_2**2; show('F: R^2 -> R'); show(F)
G(x, y) = G_1**2 + G_2**2; show('G: R^2 -> R'); show(G)
P(x, y) = (F, G); show('P = (F, G): R^2 -> R^2'); show(P)
\end{sage}

Graph of $\F(\x,\y)$.
\begin{sage}
F(x, y) = (1 - x**3*y + y - x*y**2)**2 + (x**2*y)**2
plot3d(F, (x, -2.9, 3), (y, -5, 2), adaptive=True, mesh=True, opacity=0.8, color=rainbow(100, 'rgbtuple'))
\end{sage}

Graph of $\G(\x,\y)$.
\begin{sage}
G(x, y) = (1 - x*y + x - x**4*y)**2 + (x**2*y)**2
plot3d(G, (x, -3, 3), (y, -3, 3), adaptive=True, mesh=True, opacity=0.8, color=rainbow(100, 'rgbtuple'))
\end{sage}

Define $\alpha_\lambda (s)$ and $\beta_\mu (s)$.
\begin{sage}
alpha(s) = (s, (1+a*s)/s); show('alpha_lamda: R -> R^2')
show(alpha)
beta(s) = ((1+b*s)/s, s**3); show('beta_mu: R -> R^2')
show(beta)
\end{sage}

$\F$ and $\G$ behave well on those curves. \ref{eq:firstMap}: (a) and (b).
\begin{sage}
show('F_1(alpha) =');    show(F_1(*alpha).simplify_full())
show('F_1(beta) =');     show(F_1(*beta).simplify_full())
show('G_1(alpha) =');    show(G_1(*alpha).simplify_full())
show('G_1(beta) =');     show(G_1(*beta).simplify_full())
\end{sage}

For printing the resulting polynomials in \LaTeX\ style:
\begin{sage}
aux = F(*beta).simplify_full()
print "+".join(map(latex, sorted([f for f in aux.operands()], key=lambda exp: exp.degree(s))))
\end{sage}

\ref{eq:firstMap}: (c).
\begin{sage}
show('F_2(alpha) =')
show(F_2(s, (1+a*s)/s).simplify_full())
show('G_2(alpha) =')
show(G_2(s, (1+a*s)/s).simplify_full())
show('F_2(beta) =')
show(F_2((1+b*s)/s, s**3).simplify_full())
show('G_2(beta) =')
show(G_2((1+b*s)/s, s**3).simplify_full())
\end{sage}

\ref{eq:firstMap}: (iii).
\begin{sage}
show('F(alpha) =');     show(F(*alpha).simplify_full())
show('G(alpha) =');     show(G(*alpha).simplify_full())
show('F(beta) =');      show(F(*beta).simplify_full())
show('G(beta) =');      show(G(*beta).simplify_full())
\end{sage}

Now we proceed with the computations performed in the first proof of Theorem \ref{OpenQuad}.

\textbf{Step 1:}

Roots of $\G = v$ in $y$: $\ y^+(x, v),\ y^-(x, v)$.

We can see that the denominator only cancels in 0. This is checked with Python (Appendix \ref{BB}). {\tt roots} function returns the roots with its multiplicity:
\begin{sage}
var('v')
y_1, y_2 = solve(G-v, y)
show('y+: D_v -> R'); show(y_1)
show('y-: D_v -> R'); show(y_2)
show('The denominator, which is the same, only cancels in 0: ', expand(x * (x**2 + (x**3 + 1)**2)))
show((x * (x**2 + (x**3 + 1)**2)).roots())
#Actual check that it doesn't cancel on the rest of them:
plot(x**2+(x**3+1)**2, xmin=-2, xmax=2, ymin=-1, ymax=10)
\end{sage}

Define $\Delta(x, v) =  v  (x^2 + (x^3 + 1)^2) - x^2(x + 1)^2$:
\begin{sage}
Delta(x, v) = v * (x**2 + (x**3 + 1)**2) - x**2*(x + 1)**2
show('Delta: R^2 -> R'); show(expand(Delta))
\end{sage}

Define $y^+(x, v),\ y^-(x, v)$ as functions in order to manipulate them. Recall that $$D_v = \{x \in R : \Delta(x, v) \ge 0, x \ne 0\}.$$
\begin{sage}
y_1(x, v) = (1 + x + x **3 + x**4 + sqrt(Delta)) / (x * (x**2 + (x**3 + 1)**2)) 
show('y+: D_v -> R'); show(y_1)
y_2(x, v) = (1 + x + x **3 + x**4 - sqrt(Delta)) / (x * (x**2 + (x**3 + 1)**2))
show('y-: D_v -> R'); show(y_2)
\end{sage}

Check of how they look like for instance for $v = 0.8$ (Figure \ref{fig:plotYs_1}).
\begin{sage}
sols = plot(y_1(x, 0.8), xmin=-10, xmax=10, ymin=-10, ymax=10, legend_label='$y^+(x,\ 0.8)$') +\
    plot(y_2(x, 0.8), xmin=-10, xmax=10, ymin=-10, ymax=10, color='green', legend_label='$y^-(x,\ 0.8)$') +\
    text('$y$', (-1,9), fontsize=20, color='black') +\
    text('$x$', (9,-1), fontsize=20, color='black')
sols.save('ch1_06_sols.svg')
\end{sage}

As for $v=1$, it will be useful later on. We see that $y⁻(x, 1) \approx 1$ when $x \to 0$, in red. Thus, we have that $\gamma_1^⁻(x) = F(x, y^-(x, 1)) \approx F(x, 1)$ if $x \to 0$, so we obtain $= (1 + 1) ^2 = 4$.
\begin{sage}
sols_1 = plot(y_1(x, 1), xmin=-10, xmax=10, ymin=-10, ymax=10, legend_label='$y^+(x,\ 1)$') +\
    plot(y_2(x, 1), xmin=-10, xmax=10, ymin=-10, ymax=10, color='red', thickness=2, legend_label='$y^-(x,\ 1)$') +\
    text('$y$', (-1,9), fontsize=20, color='black') +\
    text('$x$', (9,-1), fontsize=20, color='black')
sols_1.save('ch1_07_sols_1.svg')
\end{sage}

\begin{sage}
plot(y_1(x, 0.8), xmin=0, xmax=2, ymin=0, ymax=2) + plot(y_2(x, 0.8), xmin=0, xmax=2, ymin=0, ymax=2, color='green')
\end{sage}

Animated pic of $y^+(x, v),\ y^-(x, v)$ for fixed $x$ and $v$ varying between 0 and 5, step is 0.05.
\begin{sage}
G_sols = [plot(y_1(x, c), xmin=-10, xmax=10, ymin=-10, ymax=10) + plot(y_2(x, c), xmin=-10, xmax=10, ymin=-10, ymax=10, color='green') for c in sxrange(0,5,.05)]
animate(G_sols)
\end{sage}

\textbf{Step 2:}

Define $\gamma^+ _v (x), \ \gamma^- _v (x) : D_v \longrightarrow R$.
\begin{sage}
gamma_1(x) = F(x, y_1).simplify_full(); show('gamma+: D_v -> R, ', gamma_1)
gamma_2(x) = F(x, y_2).simplify_full(); show('gamma-: D_v -> R,', gamma_2)
\end{sage}

Compute the limits from (i) y (ii) in Step 2.
\begin{sage}
show('lim of gamma+ when x -> infty: ',lim(gamma_1,x=oo))
show('lim of gamma- when x -> infty: ',lim(gamma_2,x=oo))
show('lim of gamma+ when x -> -infty: ',lim(gamma_1,x=-oo))
show('lim of gamma- when x -> -infty: ',lim(gamma_2,x=-oo))
show('lim of gamma+ when x -> 0: ',lim(gamma_1,x=0))
show('lim of gamma- when x -> 0: ',lim(gamma_2,x=0))
\end{sage}

But we have to check what happens for $v=1$, namely: $$\lim_{x\rightarrow 0} \gamma^- _ 1 (x).$$
Define $\gamma^+ _ 1$ as {\tt gamma\_1\_aux} and $\gamma^- _ 1$ as {\tt gamma\_2\_aux}.
\begin{sage}
gamma_1_aux(x) = F(x, y_1(x, 1)).simplify_full()
show(gamma_1_aux)
gamma_2_aux(x) = F(x, y_2(x, 1)).simplify_full()
show(gamma_2_aux)
\end{sage}

And the limit is:
\begin{sage}
show('lim de gamma+ cuando x -> 0 es: ', lim(gamma_1_aux, x = 0))
show('lim de gamma- cuando x -> 0 es: ', lim(gamma_2_aux, x = 0))
\end{sage}

Now we are going to see how the numerator looks like for $\gamma^+ _v$ and $\gamma^- _v$ when $x:=0$.
\begin{sage}
gamma_1_num(x, v) = F(x, y_1(x, v)).numerator()
show('Numerator of gamma+ when x = 0: ', gamma_1_num(0, v), ' = ', v*(1+sqrt(v))**2)
gamma_2_num(x, v) = F(x, y_2(x, v)).numerator()
show('Numerator of gamma- when x = 0: ', gamma_2_num(0, v), ' = ', v*(1-sqrt(v))**2)
gamma_den(x, v) = F(x, y_1(x, v)).denominator(); show('Denominators from both of them: ', gamma_den(x, v))
\end{sage}

And we see that for $v>0$, the first numerator is $>0$ (in purple) and the second one $\ge 0$ (in orange).
\begin{sage}
numerators = plot(v*(1+sqrt(v))**2, xmin=0.01, xmax=2, ymin=0, ymax=2, color='purple', legend_label='Numerator of $\gamma_v^+(0)$') +\
    plot(v*(1-sqrt(v))**2, xmin=0.01, xmax=2, ymin=0, ymax=2, color='orange', legend_label='Numerator of $\gamma_v^-(0)$', fontsize=13)
numerators.axes_labels(['$v$', ' '])
numerators.set_legend_options(font_size=15, borderpad=0.35)
numerators.save('ch1_08_numerators.svg')
\end{sage}

Plots of $\gamma_1 ^+$ in blue, and $\gamma_1 ^- $ in green, where we can see the value of the limit in $x=0$ (red point).
\begin{sage}
limit = circle((0,4), 0.12, fill=True, rgbcolor='red')
aux = plot(gamma_1_aux, xmin=-10, xmax=10, ymin=0, ymax=18, aspect_ratio=1, legend_label='$\gamma_1^+(x)$') +\
    plot(gamma_2_aux, xmin=-10, xmax=10, ymin=0, ymax=18, color='green', legend_label='$\gamma_1^-(x)$') +\
    plot(limit, legend_label='Limit')
aux.axes_labels(['$x$', ' '])
aux.save('ch1_09_limit.svg')
\end{sage}

Animation of $\gamma_1^+$ and $\gamma_1^-$.
\begin{sage}
gammas = [plot(gamma_1_num(x, c)/gamma_den(x, c), xmin=-10, xmax=10, ymin=0, ymax=10) + plot(gamma_2_num(x, c)/gamma_den(x, c), xmin=-10, xmax=10, ymin=0, ymax=10, color='green') for c in sxrange(0.01,5,.05)]
animate(gammas)
\end{sage}

We proceed to study know the map
$$v(x) = \frac{{\left(x + 1\right)^2} x^{2}}{{\left(x^{3} + 1\right)}^{2} + x^{2}}.$$
\begin{sage}
uve(x) = (x**2 * (x + 1)**2) / (x**2 + (x**3 + 1)**2)
show('v: R -> R'); show(uve)
uve_plot = plot(uve, (x, -10, 10), color="green", legend_label='$v(x)$') +\
    plot(0.82, (x, -10, 10), color='red', legend_label='$v = 0.82$', figsize=7, fontsize=13)
uve_plot.axes_labels(['$x$', ' '])
uve_plot.set_legend_options(loc=2, font_size=18, borderpad=0.4)
uve_plot.save('ch1_10_uve.svg')
\end{sage}

We estimate that $v(x) < 0.28^2 = 0.0784$ when $x \in (-\infty, 0).$
\begin{sage}
detail_uve = plot(uve, (x, -4, 0), ymin=0.00, ymax=0.08, color="green", legend_label='$v(x)$') +\
    plot(0.28**2, (x, -4, 0), color='red', thickness=1, legend_label='$v = 0.28^2$', figsize=7,fontsize=13)
detail_uve.axes_labels(['$x$', ' '])
detail_uve.set_legend_options(loc=(0.02, 0.765), font_size=18, borderpad=0.4, shadow=False)
detail_uve.save('ch1_11_uve_detail.svg')
\end{sage}

Test of an animated plot for $\Delta(x, y)$ with $y \in (0.0001, 5)$ and step 0.05.
\begin{sage}
Delta_plot = [plot(Delta(x, c), xmin=-1, xmax=1, ymin=0, ymax=10) for c in sxrange(0.0001,5,.05)]
animate(Delta_plot)
\end{sage}

We would like to prove that $\Delta(x, 0.28^2)$ has no roots for $x \in (-\infty, 0)$. Since we didn't achieve it with Sage, we used Laguerre's method with Python (Appendix \ref{BB}).
\begin{sage}
show('Delta(x, 0.28^2) = ', Delta(x, 0.28**2).expand())
plot(Delta(x, 0.28**2), xmin=-3, xmax=0, ymin=0, ymax=0.2)
\end{sage}

Idea of what we want to proof in \textbf{Step 4}.
\begin{sage}
gamma_what(x) = F(x, y_2(x, 0.1)).simplify_full()
idea = plot(gamma_what, (x, -4, 0),ymin=0,ymax=3.5,color='green',legend_label='$\gamma^-(x)$',ticks=[[0],[0]]) +\
    text("]",(-1.16,0), fontsize=20, color='purple') +\
    text("<",(-4,-0.004), fontsize=20, color='purple') +\
    text("$N_v$",(-1.15,-0.25),fontsize=15,color='purple') +\
    line([(-4,-0.004), (-1.15, 0)], thickness=2, color='purple') +\
    line([(-1.14,gamma_what(-1.14)), (-1.14, 0)], thickness=1, color='purple', linestyle='--') +\
    circle((-1.14,gamma_what(-1.14)), 0.03, fill=True, rgbcolor='purple') +\
    line([(-1.14,gamma_what(-1.14)), (0, gamma_what(-1.14))], thickness=1, color='purple', linestyle='--') +\
    text("$\gamma^-(N_v)$",(0.45,gamma_what(-1.14)), fontsize=15, color='purple')+\
    text("[",(-0.7,0), fontsize=20, color='orange') +\
    text(">",(0.8,-0.004), fontsize=20, color='orange') +\
    text("$\delta_v$",(-0.7,-0.25), fontsize=20, color='orange') +\
    line([(-0.7,0), (0.8, 0)], thickness=2, color='orange') +\
    line([(-0.695,gamma_what(-0.695)), (-0.695, 0)], thickness=1, color='orange', linestyle='--') +\
    circle((-0.695,gamma_what(-0.695)), 0.03, fill=True, rgbcolor='orange') +\
    line([(-0.695,gamma_what(-0.695)), (0, gamma_what(-0.695))], thickness=1, color='orange', linestyle='--') +\
    text("$\gamma^-(\delta_v)$",(0.45,gamma_what(-0.695)), fontsize=15, color='orange')
idea.axes_labels(['$x$', '$v$'])
idea.set_legend_options(loc=(0.02, 0.765), font_size=15, borderpad=0.4, shadow=False)
idea.save('ch1_12_idea.svg')
\end{sage}

Define $N_v$ and $\delta_v$.
\begin{sage}
N(v) = -1/v**(1/2) + 1 + v**(1/2) + v
show('N_v: ', N)
delta(v) = - v**(1/2) - v - 5/2 * v**(3/2)
show('delta_v: ', delta)
\end{sage}

And we see that $-\infty < N_v < \delta_v < 0$  for $0 < v < 0.28^2$, with $N_v$ in blue and $\delta_v$ in green.
\begin{sage}
N_delta = plot(N, (x, 0, 0.28**2), ymin=-20, ymax=0, color='blue', legend_label='$N_v$') +\
    plot(delta,(x,0,0.28**2),ymin=-20,ymax=0,color='green',legend_label='$\delta_v$',figsize=7,fontsize=13)
N_delta.axes_labels(['$v$', ' '])
N_delta.set_legend_options(loc=(0.8, 0.1), font_size=18, borderpad=0.4, shadow=False)
N_delta.save('ch1_13_comp.svg')
\end{sage}

Now we check that $\Delta(N_{w^2}, w^2)$ and $\Delta(\delta_{w^2}, w^2)$ are positive for $w \in (0, 0.28)$ (or in $v \in (0, 0.28^2)$).
\begin{sage}
Delta_N_delta = plot(Delta(N, v),(x,0,0.28**2),ymin=0,ymax=15,color='blue',legend_label='$\Delta(N_{v},\ v)$') +\
    plot(Delta(delta, v)/v**(5/2), (x, 0, 0.28**2), ymin=0, ymax=15, color='green', legend_label='$\Delta(\delta_{v},\ v)/v^{5/2}$', figsize=7, fontsize=13)
Delta_N_delta.axes_labels(['$v$', ' '])
Delta_N_delta.set_legend_options(loc=(0.65, 0.5), font_size=18, borderpad=0.4, shadow=False)
Delta_N_delta.save('ch1_14_positive.svg')
\end{sage}

We take advantage of {\tt numpy} library from Python, in order to use {\tt linspace}.
\begin{sage}
import numpy as np
\end{sage}

Compute the graphs of $(N_v, v)$ and $(\delta_v, v)$.
\begin{sage}
vpoints1 = np.linspace(0.008, 0.08, 100)
vpoints2 = np.linspace(0.0001, 0.08, 100)
t_array = np.linspace(-10, 0, 500)
Npoints = [N(vpoints1[i]) for i in range(100)]
deltapoints = [delta(vpoints2[i]) for i in range(100)]
uvepoints = [uve(t_array[i]) for i in range(500)]
Njoin = line(zip(Npoints, vpoints1), rgbcolor=(0,0.6,1), thickness=1.2, legend_label='$(N_v,\ v)$')
deltajoin = line(zip(deltapoints, vpoints2), rgbcolor=(0.196078, 0.803922, 0.196078), thickness=1.2, legend_label='$(\delta_v,\ v)$')
uve_plot = line(zip(t_array, uvepoints), rgbcolor=(1,0.3,0), thickness=2, legend_label='$\Delta = 0$')
\end{sage}

And we draw it alongside the border of $D$, which is $\{\Delta = 0\} \cup \{x=0\}$.
\begin{sage}
Delta_aux(x, y)=y * (x**2 + (x**3+1)**2) - x**2*(x+1)**2
\end{sage}

\begin{sage}
xAxis = line([(0,0), (0,0.08)], color='red', thickness=2, legend_label='$x = 0$')
t_array = np.linspace(-10, 0, 0.01)
nice_plot = plot(uve_plot, marker=4) +\
    plot(xAxis, (x, -10, 0), ymin=0, ymax=0.08) +\
    plot(Njoin)+\
    plot(deltajoin)+\
    region_plot([Delta_aux > 0], (x, -10, 0), (y, 0, 0.08), alpha=0.9, bordercol='white', incol='lightblue', plot_points=1000, aspect_ratio=85)+ \
    text("$D_v$",(-7, 0.06), fontsize=15, color='black')
nice_plot.axes_labels(['$x$', '$v$'])
nice_plot.set_legend_options(loc=(0.01, 0.8), shadow=True, fancybox=True)
nice_plot.save('ch1_15_nice_plot_.svg')
\end{sage}

Now we must check that $\gamma_v^-(N_v) > \gamma_v^-(\delta_v)$. In order to do that, recall the definition of $$\gamma_v^-(x) = \frac{A_2(x, v) + B_2(x, v) \sqrt{\Delta(x, v)}}{C(x)}.$$

\begin{sage}
A_2(x, v) = (v + 2)*x**24 + (v - 4)*x**22 + 2*x**23 + 2*(2*v + 3)*x**21 + (3*v + 20)*x**20 + 2*(5*v - 3)*x**19 + (13*v - 3)*x**18 + 2*(3*v + 23)*x**17 + (30*v + 11)*x**16 + 2*(19*v - 12)*x**15 + (18*v + 49)*x**14 + 2*(16*v + 23)*x**13 + (v**2 + 45*v - 30)*x**12 + 2*(21*v + 2)*x**11 + (28*v + 57)*x**10 + 2*(2*v**2 + v + 10)*x**9 + (2*v**2 + 28*v - 11)*x**8 + 12*(2*v + 1)*x**7 + 2*(3*v**2 - 10*v + 13)*x**6 + 2*(2*v**2 - v + 3)*x**5 + (v**2 + 12*v - 9)*x**4 + 2*(2*v**2 - 3*v - 3)*x**3 + (2*v**2 + v - 1)*x**2 + v**2 + 4*v*x + v

B_2(x, v) = - 2*(x**21 + x**20 - x**19 + 2*x**18 + 8*x**17 + (v - 1)*x**15 + 3*x**16 + 9*x**14 + 3*(v + 1)*x**12 + 13*x**13 + (2*v - 3)*x**11 + 2*(v + 1)*x**10 + (4*v + 7)*x**9 + 2*(v - 4)*x**8 + (7*v - 18)*x**7 + 3*(2*v - 1)*x**6 + (5*v - 11)*x**4 + (5*v - 7)*x**3 + 2*v*x - x**2 + v)

C(x) = x**2*(x**2 + (x**3 + 1)**2)**4

show((A_2 + B_2 * sqrt(Delta))/C)
\end{sage}

In order to simplify $\sqrt{w^2} = w$ we need to tell Sage that $w>0$, which is true because $w^2 = v$ and recall that $v>0$.
\begin{sage}
var('w')
assume(w > 0)
\end{sage}

Define now:
\begin{align*}
&f_1(w) = A_2(N_{w^2}, w^2) \cdot w^{24}, \quad &f_2(w) = A_2(\delta_{w^2}, w^2), \\
&g_1(w) = B_2(N_{w^2}, w^2) \cdot w^{21}, \quad &g_2(w) = B_2(\delta_{w^2}, w^2), \\
&q_1(w) = \Delta(N_{w^2}, w^2), \quad &q_2(w) = \Delta(\delta_{w^2}, w^2), \\
&h_1(w) = C(N_{w^2}) \cdot w^{26}, \quad &h_2(w) = C(\delta_{w^2}).
\end{align*}
\begin{sage}
f_1(w) = (A_2(N(w**2), w**2) * w**24).simplify().expand()
f_2(w) = A_2(delta(w**2), w**2).simplify().expand()
g_1(w) = (B_2(N(w**2), w**2) * w**21).simplify().expand()
g_2(w) = B_2(delta(w**2), w**2).simplify().expand()
q_1(w) = Delta(N(w**2), w**2).simplify().expand()
q_2(w) = Delta(delta(w**2), w**2).simplify().expand()
h_1(w) = (C(N(w**2)) * w**26).simplify().expand()
h_2(w) = C(delta(w**2)).simplify().expand()
\end{sage}

And check that the maps $$L(w) = \frac{w^2h_2f_1 - f_2h_1}{w^2}, \quad g_1(w) , \quad K(w) = \frac{-g_2}{w^3}$$
are positive for $w \in (0, 0.28)$.
\begin{sage}
L(w) = ((w**2 * h_2 * f_1 - f_2 * h_1) / w**4).simplify().expand()
L_plot = plot(L, (x, 0, 0.28), ymin=0, ymax=1, rgbcolor=(0,1,0), legend_label='$L(w)$',fontsize=18,thickness=2)
L_plot.axes_labels(['$w$', ' '])
L_plot.set_legend_options(loc=(0.75, 0.9), font_size=25, borderpad=0.4)
L_plot.save('ch1_16_L.svg')
\end{sage}
\begin{sage}
g_1_plot = plot(g_1, (x, 0, 0.28), ymin=0, ymax=2, rgbcolor=(0.196078, 0.803922, 0.196078), legend_label='$g_1(w)$', fontsize=18, thickness=2)
g_1_plot.axes_labels(['$w$', ' '])
g_1_plot.set_legend_options(loc=(0.75, 0.9), font_size=25, borderpad=0.4)
g_1_plot.save('ch1_17_g_1.svg')
\end{sage}
\begin{sage}
K(w) = (-g_2 / w**3).simplify().expand()
K_plot = plot(K, (x, 0, 0.28), ymin=0, ymax=7, rgbcolor=(0, 0.392157, 0), legend_label='$K(w)$', fontsize=18, thickness=2)
K_plot.axes_labels(['$w$', ' '])
K_plot.set_legend_options(loc=(0.75, 0.9), font_size=25, borderpad=0.4)
K_plot.save('ch1_18_K.svg')
\end{sage}

There are some other ways to check that they have no roots in the given interval:
\begin{sage}
show(find_root(L, 0, 0.28))
show(find_root(K, 0, 0.28))
show(find_root(g_1, 0, 0.28))
\end{sage}

Or:
\begin{sage}
import scipy
from scipy import optimize
scipy.optimize.brentq(K, 0, 0.28)
\end{sage}

\end{section}

\begin{section}{Computations related to Chapter 3}
The following code produces the graphs from Figure \ref{fig:ch2Maps}: $\FF_1, \FF_2, \GG_1, \GG_2, \HH_1$ and $\HH_2$.
\begin{sage}
x, y = var('x, y')
F_1(x, y) = (x*y - 1)**2 + x**2
F_2(x, y) = (x*y - 1)**2 + y**2
G_1(x, y) = x
G_2(x, y) = y * (x*y - 2)**2 + x * (x*y - 1)**2
H_1(x, y) = x * (x*y - 2)**2 + 1/2*x*y**2
H_2(x, y) = y
\end{sage}
\begin{sage}
plot3d(F_1, (x, -10, 10), (y, -10, 10), adaptive=True, mesh=True, opacity=0.8, color=rainbow(100, 'rgbtuple'))
\end{sage}
\begin{sage}
plot3d(F_2, (x, -10, 10), (y, -10, 10), adaptive=True, mesh=True, opacity=0.8, color=rainbow(100, 'rgbtuple'))
\end{sage}
\begin{sage}
plot3d(G_1, (x, -10, 10), (y, -10, 10), adaptive=True, mesh=True, opacity=0.8, color=rainbow(100, 'rgbtuple'))
\end{sage}
\begin{sage}
plot3d(G_2, (x, -10, 10), (y, -10, 10), adaptive=True, mesh=True, opacity=0.8, color=rainbow(100, 'rgbtuple'))
\end{sage}
\begin{sage}
plot3d(H_1, (x, -10, 10), (y, -10, 10), adaptive=True, mesh=True, opacity=0.8, color=rainbow(100, 'rgbtuple'))
\end{sage}
\begin{sage}
plot3d(H_2, (x, -10, 10), (y, -10, 10), adaptive=True, mesh=True, opacity=0.8, color=rainbow(100, 'rgbtuple'))
\end{sage}

Regions from Figure \ref{fig:setA} and \ref{fig:setB}.
\begin{sage}
A = region_plot([x*y >= 1, x > 0], (x, -1, 5), (y, -1, 5), alpha=0.9, bordercol='blue', incol='lightblue')
A.axes_labels(['$x$', '$y$'])
A.show()
A.save('ch2_01_A.pdf')
\end{sage}
\begin{sage}
B = region_plot([x*y >= 1, x > 0], (x, -1, 5), (y, -1, 5), alpha=0.9, bordercol='blue', incol='lightblue',borderstyle='dashed') +\
    region_plot([y >= x, x > 0.03], (x, -1, 5), (y, -1, 5), alpha=0.9, bordercol='blue', incol='lightblue', borderstyle='dashed') +\
    plot(x, (x, 0.03, 1), thickness=1.5) +\
    plot(1/x, (x, 1, 5), thickness=1.5)
B.axes_labels(['$x$', '$y$'])
B.show()
B.save('ch2_02_B.pdf')
\end{sage}

Graph that shows that $1/x$ is ``below'' $2/x$:
\begin{sage}
plot(1/x, (x, 0, 5), ymin=0, ymax=5, aspect_ratio=1) + 
    plot(2/x, (x, 0, 5), ymin=0, ymax=5, color='green') + B
\end{sage}

We use {\tt numpy} as well here. First, generate points where we are going to evaluate:
\begin{sage}
import numpy as np
t_array_0 = np.linspace(0.2, 1, 25)
t_array_1 = np.linspace(0, 1, 30)
t_array_2 = np.linspace(1, 5, 120)
\end{sage}

Then, compute the light blue lines from Figure \ref{fig:Bvert}:
\begin{sage}
slice_vert_B_1 = [line([(x_0, x_0), (x_0, 5)], color='lightblue') for x_0 in t_array_1]
slice_vert_B_2 = [line([(x_0, 1 / x_0), (x_0, 5)], color='lightblue') for x_0 in t_array_2]
\end{sage}

And draw the whole picture:
\begin{sage}
slice_vert_B = sum(slice_vert_B_1) + sum(slice_vert_B_2) +\
    line([(1/3, 1/3), (1/3, 5)], color='green', thickness=1.5) + \
    line([(1/3, 1/3), (1/3, 0)], color='green', linestyle='-.') +\
    line([(3.25, 1/3.25), (3.25, 5)], color='red', thickness=1.5) +\
    line([(3.25, 1/3.25), (3.25, 0)], color='red', linestyle='-.') +\
    line([(0, 0), (1, 1)]) +\
    plot(1/x, (x, 1, 5), aspect_ratio=1) +\
    text('$x_0$', (0.35, -0.2), fontsize=20, color='green') +\
    text('$x_1$', (3.25, -0.2), fontsize=20, color='red')
slice_vert_B.axes_labels(['$x$', '$y$'])
slice_vert_B.save('ch2_09_B_vert.pdf')
show(slice_vert_B)
\end{sage}

Same for Figure \ref{fig:Bhor}:
\begin{sage}
slice_hor_B_0 = [line([(0, y_0), (y_0, y_0)], color='lightblue') for y_0 in t_array_1]
slice_hor_B_1 = [line([(1/y_0, y_0), (5, y_0)], color='lightblue') for y_0 in t_array_0]
slice_hor_B_2 = [line([(0, y_0), (5, y_0)], color='lightblue') for y_0 in t_array_2]
\end{sage}

And the whole picture:
\begin{sage}
slice_hor_B = sum(slice_hor_B_0) + sum(slice_hor_B_1) + sum(slice_hor_B_2) +\
    line([(0, 3.25), (5, 3.25)], color='green', thickness=1.5) + \
    line([(0, 0.6), (0.6, 0.6)], color='red', thickness=1.5) +\
    line([(1/0.6, 0.6), (5, 0.6)], color='red', thickness=1.5) +\
    line([(0, 0), (1, 1)]) +\
    plot(1/x, (x, 1, 5), aspect_ratio=1) +\
    text('$y_0$', (-0.2, 3.3), fontsize=20,color='green')+\
    text('$y_1$', (-0.2, 0.65), fontsize=20,color='red')
slice_hor_B.axes_labels(['$x$', '$y$'])
slice_hor_B.save('ch2_10_B_hor.pdf')
show(slice_hor_B)
\end{sage}

\end{section}

\begin{section}{Computations related to Chapter 5}
We need to import {\tt numpy} and define the polynomials we will be using. 

First we define the polynomial maps from the first proof.
Note that the final map is $P(Q(H(\x, \y)))$, but we obtain it as the expanded composition, defined as {\tt P(G(H))}, and as a fully expanded composition, which is {\tt P\_aux}.
\begin{sage}
Q(x, y) = (x, y - x - 1)
H(x, y) = (x*y + 1, x**2 * (x*y + 1) * (x*y + 2) + y)

F(x, y) = (1 - x**3 * y + y - x*y**2)**2 + (x**2 * y)**2
G(x, y) = (1 - x * y + x - x**4 * y)**2 + (x**2 * y)**2
P(x, y) = (F, G)
P_aux(x, y) =
(expand(F(*Q(*H))).collect(y),expand(G(*Q(*H))).collect(y))

show('P = (F, G): R^2 -> R^2')
show(P)
\end{sage}
Now, the ones from the second one: the short proof.
\begin{sage}
FF_1(x, y) = (x*y - 1)**2 + x**2
FF_2(x, y) = (x*y - 1)**2 + y**2
FF(x, y) = (FF_1, FF_2); show('FF = (FF_1, FF_2): R^2 -> R^2'); show(FF)

GG_1(x, y) = x
GG_2(x, y) = y * (x*y - 2)**2 + x * (x*y - 1)**2
GG(x, y) = (GG_1, GG_2); show('GG = (GG_1, GG_2): R^2 -> R^2'); show(GG)

HH_1(x, y) = x * (x*y - 2)**2 + 1/2*x*y**2
HH_2(x, y) = y
HH(x, y) = (HH_1, HH_2); show('HH = (HH_1, HH_2): R^2 -> R^2'); show(HH)
\end{sage}
And we define {\tt ff} to be the full expansion of the composition, grouping on the $y$ variable:
\begin{sage}
ff_1(x, y) = 1/2*((((x*y - 1)**2 + x**2)*((x*y - 1)**2 + y**2) - 1)**2*((x*y - 1)**2 + x**2) + (((x*y - 1)**2 + x**2)*((x*y - 1)**2 + y**2) - 2)**2*((x*y - 1)**2 + y**2))**2*((x*y - 1)**2 + x**2) + (((((x*y - 1)**2 + x**2)*((x*y - 1)**2 + y**2) - 1)**2*((x*y - 1)**2 + x**2) + (((x*y - 1)**2 + x**2)*((x*y - 1)**2 + y**2) - 2)**2*((x*y - 1)**2 + y**2))*((x*y - 1)**2 + x**2) - 2)**2*((x*y - 1)**2 + x**2)

ff_2(x, y) = (((x*y - 1)**2 + x**2)*((x*y - 1)**2 + y**2) - 1)**2*((x*y - 1)**2 + x**2) + (((x*y - 1)**2 + x**2)*((x*y - 1)**2 + y**2) - 2)**2*((x*y - 1)**2 + y**2)

ff(x,y) = (expand(ff_1).collect(y),expand(ff_2).collect(y))
show('ff = HH(GG(FF)): R^2 -> R^2')#; show(ff)
\end{sage}

And, lastly, the third polynomial map, the one from the topological proof.
\begin{sage}
FFF_1(x, y) = (x**2*y**4 + x**4*y**2 - y**2 - 1)**2 + x**6*y**4
FFF_2(x, y) = (x**6*y**2 + x**2*y**2 - x**2 - 1)**2 + x**6*y**4
FFF(x, y) = (FFF_1, FFF_2); show('FFF = (FFF_1, FFF_2): R^2 -> R^2'); show(FFF)
\end{sage}
\begin{sage}
f_1(x, y) = (x**2, y**2)
f_2(x, y) = ((x*y**2 + x**2*y - y - 1)**2 + x**3*y**2, (x**3*y + x*y - x - 1)**2 + x**3*y**2)
g(x, y) = (x*y**2 + x**2*y - y - 1, x**(3/2)*y, x**3*y + x*y - x - 1) 
h(x, y, z) = (x**2 + y**2, y**2 + z**2)
\end{sage}

Actual check of that $\FFF=f_2\circ f_1$ with $f_2=h\circ g$.
\begin{sage}
show(expand(FFF_1))
show(expand(h(*g(*f_1(x, y)))[0]))

show(expand(FFF_2))
show(expand(h(*g(*f_1(x, y)))[1]))
\end{sage}

\begin{subsection}{The set $\PP_1$}
First, define the set $\PP_1$.
\begin{sage}
smallSq = [(i, j) for i in range(-10,11) for j in range(-10,11)]
point(smallSq)
\end{sage}

For the map $g$:
\begin{sage}
time PQHsmallSq = [P(*Q(*H(*k))) for k in smallSq]
myplot = point(PQHsmallSq, rgbcolor=(1,0.3,0), axes_labels=['$x$', '$y$'])
show(myplot)
myplot.save('ch5_01.pdf')
\end{sage}

For the map $f$:
\begin{sage}
time HHGGFFsmallSq = [HH(*GG(*FF(*k))) for k in smallSq]
myplot = point(HHGGFFsmallSq, rgbcolor=(0,0.5,1), axes_labels=['$x$', '$y$'])
show(myplot)
myplot.save('ch5_02.pdf')
\end{sage}

For the map $\FFF$:
\begin{sage}
time FFFsmallSq = [FFF(*k) for k in smallSq]
myplot = point(FFFsmallSq, rgbcolor=(0.196078,0.803922,0.196078),axes_labels=['$x$','$y$'])
show(myplot)
myplot.save('ch5_03.pdf')
\end{sage}
\end{subsection}

\begin{subsection}{The set $\PP_2$}
First, define the set $\PP_2$.
\begin{sage}
bigSq = [(i, j) for i in range(-100,101) for j in range(-100,101)]
point(bigSq)
\end{sage}

For the map $g$:
\begin{sage}
time PQHbigSq = [P(*Q(*H(*k))) for k in bigSq]
myplot = point(PQHbigSq, rgbcolor=(1,0.3,0), axes_labels=['$x$', '$y$'])
show(myplot)
myplot.save('ch5_04.pdf')
\end{sage}

For the map $f$:
\begin{sage}
time HHGGFFbigSq = [HH(*GG(*FF(*k))) for k in bigSq]
myplot = point(HHGGFFbigSq, rgbcolor=(0,0.5,1), axes_labels=['$x$', '$y$'])
show(myplot)
myplot.save('ch5_05.pdf')
\end{sage}

For the map $\FFF$:
\begin{sage}
time FFFbigSq = [FFF(*k) for k in bigSq]
myplot = point(FFFbigSq, rgbcolor=(0.196078,0.803922,0.196078),axes_labels=['$x$','$y$'])
show(myplot)
myplot.save('ch5_06.pdf')
\end{sage}
\end{subsection}

\begin{subsection}{The set $\PP_3$}
First, define the set $\PP_3$.
\begin{sage}
t_0 = np.linspace(0,1,1000)
zeroOne = [(i, j) for i in t_0 for j in t_0]
\end{sage}

For the map $g$:
\begin{sage}
time PQHzeroOne = [P(*Q(*H(*k))) for k in zeroOne]
myplot = point(PQHzeroOne, rgbcolor=(1,0.3,0), axes_labels=['$x$', '$y$'])
show(myplot)
myplot.save('ch5_07.pdf')
\end{sage}

For the map $f$:
\begin{sage}
time HHGGFFzeroOne = [HH(*GG(*FF(*k))) for k in zeroOne]
myplot = point(HHGGFFzeroOne, rgbcolor=(0,0.5,1), axes_labels=['$x$', '$y$'])
show(myplot)
myplot.save('ch5_08.pdf')
\end{sage}

For the map $\FFF$:
\begin{sage}
time FFFzeroOne = [FFF(*k) for k in zeroOne]
myplot = point(FFFzeroOne, rgbcolor=(0.196078,0.803922,0.196078),axes_labels=['$x$','$y$'])
show(myplot)
myplot.save('ch5_09.pdf')
\end{sage}

\end{subsection}

\begin{subsection}{The set $\PP_4$}
First, define the set $\PP_4$.
\begin{sage}
t_1 = np.linspace(-1,1,1000)
minusOneOne = [(i, j) for i in t_1 for j in t_1]
\end{sage}

For the map $g$:
\begin{sage}
time PQHminusOneOne = [P(*Q(*H(*k))) for k in minusOneOne]
myplot = point(PQHminusOneOne, rgbcolor=(1,0.3,0), axes_labels=['$x$', '$y$'])
show(myplot)
myplot.save('ch5_10.pdf')
\end{sage}

Take a closer look to the graph in $[0,2]\times[0,2]$
\begin{sage}
myplot = point(PQHminusOneOne, rgbcolor=(1,0.3,0), xmin=0, xmax=2, ymin=0, ymax=2, axes_labels=['$x$', '$y$'])
show(myplot)
#myplot.save('ch5_11_prime.pdf')
\end{sage}

For the map $f$:
\begin{sage}
time HHGGFFminusOneOne = [HH(*GG(*FF(*k))) for k in minusOneOne]
myplot = point(HHGGFFminusOneOne, rgbcolor=(0,0.5,1), axes_labels=['$x$', '$y$'])
show(myplot)
myplot.save('ch5_12.pdf')
\end{sage}

Looking closer:
\begin{sage}
myplot = point(HHGGFFminusOneOne, xmin=0, xmax=1, ymin=0, ymax=1, rgbcolor=(0,0.5,1), axes_labels=['$x$', '$y$'])
show(myplot)
myplot.save('ch5_13.pdf')
\end{sage}

For the map $\FFF$:
\begin{sage}
time FFFminusOneOne = [FFF(*k) for k in minusOneOne]
myplot = point(FFFminusOneOne, rgbcolor=(0.196078,0.803922,0.196078),axes_labels=['$x$','$y$'])
show(myplot)
myplot.save('ch5_14.pdf')
\end{sage}

Looking closer:
\begin{sage}
myplot = point(FFFminusOneOne, xmin=0, xmax=1, ymin=0, ymax=1, rgbcolor=(0.196078,0.803922,0.196078), axes_labels=['$x$', '$y$'])
show(myplot)
myplot.save('ch5_15.pdf')
\end{sage}

\end{subsection}

\begin{subsection}{The set $\PP_5$}
First, define the set $\PP_5$.
\begin{sage}
t_2 = np.linspace(-10,10,200)
minusTenTen = [(i, j) for i in t_2 for j in t_2]
\end{sage}

For the map $g$:
\begin{sage}
time PQHminusTenTen = [P(*Q(*H(*k))) for k in minusTenTen]
myplot = point(PQHminusTenTen, rgbcolor=(1,0.3,0), axes_labels=['$x$', '$y$'])
show(myplot)
myplot.save('ch5_16.pdf')
\end{sage}

For the map $f$:
\begin{sage}
time HHGGFFminusTenTen = [HH(*GG(*FF(*k))) for k in minusTenTen]
myplot = point(HHGGFFminusTenTen, rgbcolor=(0,0.5,1), axes_labels=['$x$', '$y$'])
show(myplot)
myplot.save('ch5_17.pdf')
\end{sage}

For the map $\FFF$:
\begin{sage}
time FFFminusTenTen = [FFF(*k) for k in minusTenTen]
myplot = point(FFFminusTenTen, rgbcolor=(0.196078,0.803922,0.196078),axes_labels=['$x$','$y$'])
show(myplot)
myplot.save('ch5_18.pdf')
\end{sage}

\end{subsection}

\begin{subsection}{The set $\PP_6$}
First, define the set $\PP_6$.
\begin{sage}
t_3 = np.linspace(-10,10,2000)
minusTenTen = [(i, j) for i in t_3 for j in t_3]
\end{sage}

For the map $g$:
\begin{sage}
time PQHminusTenTen = [P(*Q(*H(*k))) for k in minusTenTen]
myplot = point(PQHminusTenTen, rgbcolor=(1,0.3,0), axes_labels=['$x$', '$y$'])
show(myplot)
myplot.save('ch5_19.pdf')
\end{sage}

Same graph in $[0,1]\times[0,1]$:
\begin{sage}
myplot = point(PQHminusTenTen, xmin=0, xmax=1, ymin=0, ymax=1, rgbcolor=(1,0.3,0), axes_labels=['$x$', '$y$'])
show(myplot)
myplot.save('ch5_20.pdf')
\end{sage}

And in $[0,0.1]\times[0,0.1]$:
\begin{sage}
myplot = point(PQHminusTenTen, xmin=0, xmax=0.1, ymin=0, ymax=0.1, rgbcolor=(1,0.3,0), axes_labels=['$x$', '$y$'])
show(myplot)
myplot.save('ch5_21.pdf')
\end{sage}

For the map $f$:
\begin{sage}
time HHGGFFminusTenTen = [HH(*GG(*FF(*k))) for k in minusTenTen]
myplot = point(HHGGFFminusTenTen, rgbcolor=(0,0.5,1), axes_labels=['$x$', '$y$'])
show(myplot)
myplot.save('ch5_22.pdf')
\end{sage}

Same graph in $[0,1]\times[0,1]$:
\begin{sage}
myplot = point(HHGGFFminusTenTen, xmin=0, xmax=1, ymin=0, ymax=1, rgbcolor=(0,0.5,1), axes_labels=['$x$', '$y$'])
show(myplot)
myplot.save('ch5_23.pdf')
\end{sage}

For the map $\FFF$:
\begin{sage}
time FFFminusTenTen = [FFF(*k) for k in minusTenTen]
myplot = point(FFFminusTenTen, rgbcolor=(0.196078,0.803922,0.196078),axes_labels=['$x$','$y$'])
show(myplot)
myplot.save('ch5_24.pdf')
\end{sage}


And the same graph in $[0,1]\times[0,1]$:
\begin{sage}
myplot = point(FFFminusTenTen, xmin=0, xmax=1, ymin=0, ymax=1, rgbcolor=(0.196078,0.803922,0.196078), axes_labels=['$x$', '$y$'])
show(myplot)
myplot.save('ch5_25.pdf')
\end{sage}
\end{subsection}

\begin{subsection}{Expanded vs. Composed}
Define the domain. For instance $\PP_6$:
\begin{sage}
t_3 = np.linspace(-10,10,2000)
minusTenTen = [(i, j) for i in t_3 for j in t_3]
\end{sage}

For the first map $g$:
\begin{sage}
time P_auxMinusTenTen = [P_aux(*k) for k in minusTenTen]
myplot = point(P_auxMinusTenTen, rgbcolor=(1,0.3,0), axes_labels=['$x$', '$y$'])
show(myplot)
#myplot.save('ch5_26_prime.pdf')
\end{sage}

For the second one $f$:
\begin{sage}
time ffminusTenTen = [ff(*k) for k in minusTenTen]
myplot = point(ffminusTenTen, rgbcolor=(0,0.5,1), axes_labels=['$x$', '$y$'])
show(myplot)
#myplot.save('ch5_26.pdf')
\end{sage}
\end{subsection}

\begin{subsection}{Using $f_2(\overline{\Qu})$ on the third map.}
First, define $\PP_7$:
\begin{sage}
t_4 = np.linspace(0,10,1000)
zeroTen = [(i, j) for i in t_4 for j in t_4]
\end{sage}

And compute the result:
\begin{sage}
time f_2zeroTen = [f_2(*k) for k in zeroTen]
myplot = point(f_2zeroTen, rgbcolor=(0.196078,0.803922,0.196078),axes_labels=['$x$','$y$'])
show(myplot)
myplot.save('ch5_27.pdf')
\end{sage}
\end{subsection}

\begin{subsection}{Families of curves composed with $g$ and $f_2$.}
Define new variables for the curves, and the curves for the first map as in \ref{quadReasons}.
\begin{sage}
var('s, a, b')
alpha(s, a) = (s, (1+a*s)/s)
show('alpha_lamda: R^2 -> R^2'); show(alpha)
beta(s, b) = ((1+b*s)/s, s**3)
show('beta_mu: R^2 -> R^2'); show(beta)
\end{sage}

Define the domain $\PP_8$ of the curves:
\begin{sage}
t_5 = np.linspace(-10,10,1000)
minusTenTen = [(i, j) for i in t_5 for j in t_5]
\end{sage}

Compute the image of $\PP_8$ through the curves:
\begin{sage}
time alphaminusTenTen = [alpha(*k) for k in minusTenTen]
time betaminusTenTen = [beta(*k) for k in minusTenTen]
\end{sage}

Plots of the curves $\alpha_\lambda$ and $\beta_\mu$ for $(s,a)\in [-10,10]\times[-10,10]$ and 1000 points on each side:
\begin{sage}
myplot = line(alphaminusTenTen, color='purple', axes_labels=['$x$', '$y$']) +\
    line(betaminusTenTen, color='orange', axes_labels=['$x$', '$y$'])
show(myplot, xmin=-15, xmax=15, ymin=-15, ymax=15)
#myplot.save('ch5_28.pdf')
\end{sage}

Compute the images of the curves through $g$:
\begin{sage}
time PQHalpha = [P(*Q(*H(*k))) for k in alphaminusTenTen]
time PQHbeta = [P(*Q(*H(*k))) for k in betaminusTenTen]
\end{sage}

Plots of $\big(\P\circ Q\circ H\big)(\alpha_\lambda)$ and $\big(\P\circ Q\circ H\big)(\beta_\mu)$.
\begin{sage}
myplot = line(PQHalpha, color='purple', axes_labels=['$x$', '$y$']) +\
    line(PQHbeta, color='orange',axes_labels=['$x$','$y$'])
show(myplot, xmin=0, xmax=1, ymin=0,ymax=1,aspect_ratio=1)
#myplot.save('ch5_29.pdf')
\end{sage}

Same in $[0,100]\times[0,100]$:
\begin{sage}
myplot = line(PQHalpha, color='purple', axes_labels=['$x$', '$y$']) +\
    line(PQHbeta, color='orange',axes_labels=['$x$','$y$'])
show(myplot, xmin=0, xmax=100, ymin=0, ymax=100, aspect_ratio=1)
\end{sage}

Same in $[0,0.1]\times[0,0.1]$:
\begin{sage}
myplot = line(PQHalpha, color='purple', axes_labels=['$x$', '$y$']) +\
    line(PQHbeta, color='orange',axes_labels=['$x$','$y$'])
show(myplot, xmin=0, xmax=0.1, ymin=0, ymax=0.1, aspect_ratio=1)
\end{sage}

Now, we define the family of curves for the third map:
\begin{sage}
gamma(s, a) = ((1+a*s)/s, s**2)
show('gamma: R^2 -> R^2'); show(gamma)
delta(s, b) = (s, (1+b*s)/s)
show('delta: R^2 -> R^2'); show(delta)
\end{sage}

The domain $\PP_8$:
\begin{sage}
t_5 = np.linspace(0.001,10,1000)
zeroTen = [(i, j) for i in t_5 for j in t_5]
\end{sage}

The image through the curves:
\begin{sage}
time gammazeroTen = [gamma(*k) for k in zeroTen]
time deltazeroTen = [delta(*k) for k in zeroTen]
\end{sage}

The image through $f_2$:
\begin{sage}
time f_2gamma = [f_2(*k) for k in gammazeroTen]
time f_2delta = [f_2(*k) for k in deltazeroTen]
\end{sage}

Plots of $F(\gamma)$ and $F(\delta)$:
\begin{sage}
myplot = line(f_2gamma, color='purple', axes_labels=['$x$', '$y$']) +\
    line(f_2delta,color='orange',axes_labels=['$x$','$y$'])
show(myplot, xmin=0, xmax=100, ymin=0, ymax=100, aspect_ratio=1)
#myplot.save('ch5_31.pdf')
\end{sage}

Same in $[0,4]\times[0, 4]$:
\begin{sage}
myplot = line(f_2gamma, color='purple', axes_labels=['$x$', '$y$']) +\
    line(f_2delta,color='orange',axes_labels=['$x$','$y$'])
show(myplot, xmin=0, xmax=4, ymin=0, ymax=4, aspect_ratio=1)
\end{sage}

In $[0,1]\times[0, 1]$:
\begin{sage}
myplot = line(f_2gamma, color='purple', axes_labels=['$x$', '$y$']) +\
    line(f_2delta,color='orange',axes_labels=['$x$','$y$'])
show(myplot, xmin=0, xmax=1, ymin=0, ymax=1, aspect_ratio=1)
\end{sage}

And in $[0,0.1]\times[0,0.1]$:
\begin{sage}
myplot = line(f_2gamma, color='purple', axes_labels=['$x$', '$y$']) +\
    line(f_2delta,color='orange',axes_labels=['$x$','$y$'])
show(myplot, xmin=0, xmax=0.1, ymin=0, ymax=0.1, aspect_ratio=1)
\end{sage}
\end{subsection}

\begin{subsection}{Randomly distributed points contained in a disc}
Generate the random points in the unit disc:
\begin{sage}
circle_cloud = []
circle_list = []
for i in range(0,100000):
    rho = RealField().random_element(0,1)
    theta = RealField().random_element(0,2*pi)
    circle_cloud = circle_cloud + [point((rho*cos(theta), rho*sin(theta)))]
    circle_list = circle_list + [(rho*cos(theta), rho*sin(theta))]
\end{sage}

Plot it:
\begin{sage}
plot(circle_cloud, aspect_ratio=1)
\end{sage}

Images through $g$:
\begin{sage}
time PQHcircle_list = [P(*Q(*H(*k))) for k in circle_list]
myplot = point(PQHcircle_list, rgbcolor=(1,0.3,0), axes_labels=['$x$', '$y$'])
show(myplot)
\end{sage}

Looking closer:
\begin{sage}
show(myplot, xmin=0, xmax=10, ymin=0, ymax=10)
\end{sage}

Images through $f$:
\begin{sage}
time HHGGFFcircle_list = [HH(*GG(*FF(*k))) for k in circle_list]
myplot = point(HHGGFFcircle_list, rgbcolor=(0,0.5,1), axes_labels=['$x$', '$y$'])
show(myplot)
\end{sage}

Looking closer:
\begin{sage}
show(myplot, xmin=0, xmax=5, ymin=0, ymax=5)
\end{sage}

Images through $\FFF$:
\begin{sage}
time FFFcircle_list = [FFF(*k) for k in circle_list]
myplot = point(FFFcircle_list, rgbcolor=(0.196078,0.803922,0.196078),axes_labels=['$x$','$y$'])
show(myplot)
\end{sage}

A closer look:
\begin{sage}
show(myplot, xmin=0, xmax=2, ymin=0, ymax=2)
\end{sage}

Do the exact same thing for a disc with radius equals to 100:
\begin{sage}
circle_cloud = []
circle_list = []
for i in range(0,100000):
    rho = RealField().random_element(0,100)
    theta = RealField().random_element(0,2*pi)
    circle_cloud = circle_cloud + [point((rho*cos(theta), rho*sin(theta)))]
    circle_list = circle_list + [(rho*cos(theta), rho*sin(theta))]
\end{sage}

Image through $g$:
\begin{sage}
time PQHcircle_list = [P(*Q(*H(*k))) for k in circle_list]
myplot = point(PQHcircle_list, rgbcolor=(1,0.3,0), axes_labels=['$x$', '$y$'])
show(myplot)
\end{sage}

Looking closer:
\begin{sage}
show(myplot, xmin=0, xmax=10, ymin=0, ymax=10)
\end{sage}

Images through $f$:
\begin{sage}
time HHGGFFcircle_list = [HH(*GG(*FF(*k))) for k in circle_list]
myplot = point(HHGGFFcircle_list, rgbcolor=(0,0.5,1), axes_labels=['$x$', '$y$'])
show(myplot)
\end{sage}

Looking closer:
\begin{sage}
show(myplot, xmin=0, xmax=5, ymin=0, ymax=5)
\end{sage}

Images through $\FFF$:
\begin{sage}
time FFFcircle_list = [FFF(*k) for k in circle_list]
myplot = point(FFFcircle_list, rgbcolor=(0.196078,0.803922,0.196078),axes_labels=['$x$','$y$'])
show(myplot)
\end{sage}

Looking closer:
\begin{sage}
show(myplot, xmin=0, xmax=10, ymin=0, ymax=10)
\end{sage}
\end{subsection}

\begin{subsection}{Families of curves composed with the new maps: $\mathcal{N}_1$ and $\mathcal{N}_2$}

We begin by defining the first new polynomial map $\mathcal{N}_1$:
\begin{sage}
newMap_1(x,y)=(x**4*y**4 + (x**2*y + x*y**2 - 1)**2*(y**2 + 1), x**4*y**4 + (x**2*y + x*y**2 - 1)**2*(x**2 + 1))
show('newMap_1: R^2 -> R^2'); show(newMap_1)
\end{sage}

And the new family of curves:
\begin{sage}
sigma(s, a) = (s**2 + a*s**3, 1/s)
show('sigma: R^2 -> R^2'); show(sigma)
tau(s, b) = (1/s, s**2 + b*s**3)
show('tau: R^2 -> R^2'); show(tau)
\end{sage}

The domain:
\begin{sage}
t_5 = np.linspace(-10,10,1000)
minusTenTen = [(i, j) for i in t_5 for j in t_5]
\end{sage}

The image through the curves:
\begin{sage}
time sigmaminusTenTen = [sigma(*k) for k in minusTenTen]
time tauminusTenTen = [tau(*k) for k in minusTenTen]
\end{sage}

Plots of the curves $\sigma$ and $\tau$ for $(s,a)\in [-10,10]\times[-10,10]$ and 1000 points on each side:
\begin{sage}
myplot = line(sigmaminusTenTen, rgbcolor=(0,0.8,0.2), axes_labels=['$x$', '$y$']) +\
    line(tauminusTenTen, rgbcolor=(0,0.4,1), axes_labels=['$x$', '$y$'])
show(myplot, xmin=-15, xmax=15, ymin=-15, ymax=15)
#myplot.save('ch5_32.pdf')
\end{sage}

Image through $\mathcal{N}_1$:
\begin{sage}
time newMap_1sigma = [newMap_1(*k) for k in sigmaminusTenTen]
time newMap_1tau = [newMap_1(*k) for k in tauminusTenTen]
\end{sage}

Plots of $\mathcal{N}_1(\sigma)$ and $\mathcal{N}_1(\tau)$:
\begin{sage}
myplot = line(newMap_1sigma, rgbcolor=(0,0.8,0.2), axes_labels=['$x$', '$y$']) +\
    line(newMap_1tau, rgbcolor=(0,0.4,1), axes_labels=['$x$', '$y$'])
show(myplot, xmin=0, xmax=0.1, ymin=0, ymax=0.1, aspect_ratio=1)
#myplot.save('ch5_33.pdf')
\end{sage}

As for $\mathcal{N}_2$:
\begin{sage}
newMap_2(x,y)=(x**2*y**2 + (x**2*y + x*y**2 - 1)**2*(y**2 + 1), x**2*y**2 + (x**2*y + x*y**2 - 1)**2*(x**2 + 1))
show('newMap_2: R^2 -> R^2'); show(newMap_2)
\end{sage}

We use the exact same curves we just did. Compute the image:
\begin{sage}
time newMap_2sigma = [newMap_2(*k) for k in sigmaminusTenTen]
time newMap_2tau = [newMap_2(*k) for k in tauminusTenTen]
\end{sage}

Plots of $\mathcal{N}_2(\sigma)$ and $\mathcal{N}_2(\tau)$:
\begin{sage}
myplot = line(newMap_2sigma, rgbcolor=(0,0.8,0.2), axes_labels=['$x$', '$y$']) +\
    line(newMap_2tau, rgbcolor=(0,0.4,1), axes_labels=['$x$', '$y$'])
show(myplot, xmin=0, xmax=0.1, ymin=0, ymax=0.1, aspect_ratio=1)
#myplot.save('ch5_33.pdf')
\end{sage}

The third map $\mathcal{N}_3$ is:
\begin{sage}
newMap_3(x,y)=(x**6*y**4 + (x**2*y + x*y**2 - 1)**2*(y**2 + 1), x**4*y**6 + (x**2*y + x*y**2 - 1)**2*(x**2 + 1))
show('newMap_3: R^2 -> R^2'); show(newMap_3)
\end{sage}
\end{subsection}

\begin{subsection}{Expansion and grouping of the given polynomial maps}
Computing the total degree and the total number of monomials.

First paper $g$:
\begin{itemize}
\item Total degree: 56.
\item Total number of monomials: 167 (101 + 67).
\end{itemize}
\begin{sage}
show(expand(F(*Q(*H))).collect(y))
show(expand(G(*Q(*H))).collect(y))
\end{sage}

Second map $f$:
\begin{itemize}
\item Total degree: 72.
\item Total number of monomials: 350.
\end{itemize}
\begin{sage}
show(expand(ff[0]).collect(y))
show(expand(ff[1]).collect(y))
\end{sage}

Third map $\FFF$:
\begin{itemize}
\item Total degree: 28.
\item Total number of monomials: 22. 
\end{itemize}
\begin{sage}
show(expand(FFF[0]).collect(y))
show(expand(FFF[1]).collect(y))
\end{sage}

First new map $\mathcal{N}_1$:
\begin{itemize}
\item Total degree: 16.
\item Total number of monomials: 24 .
\end{itemize}
\begin{sage}
show(expand(newMap_1[0]).collect(y))
show(expand(newMap_1[1]).collect(y))
\end{sage}

Second new map $\mathcal{N}_2$:
\begin{itemize}
\item Total degree: 16.
\item Total number of monomials: 26.
\end{itemize}
\begin{sage}
show(expand(newMap_2[0]).collect(y))
show(expand(newMap_2[1]).collect(y))
\end{sage}

Third new map $\mathcal{N}_3$:
\begin{itemize}
\item Total degree: 20.
\item Total number of monomials: 26.
\end{itemize}
\begin{sage}
show(expand(newMap_3[0]).collect(y))
show(expand(newMap_3[1]).collect(y))
\end{sage}
\end{subsection}
\end{section}

\end{chapter}

\begin{thebibliography}{ABR}

\bibitem[ABR]{abr} C. Andradas, L. Br\"ocker, J.M. Ruiz: Constructible 
sets in real geometry. \em Ergeb. Math. \em{\bf 33}. Berlin, Heidelberg, 
New York: Springer Verlag, (1996).

\bibitem[BCR]{bcr} J. Bochnak, M. Coste, M.-F. Roy: G\'eom\'etrie
alg\'ebrique r\'eelle. \em Ergeb. Math. \em {\bf 12}, Springer-Verlag,
Berlin, Heidelberg, New York (1987).

\bibitem[B]{b} M. Berger: Geometry. I. \em Universitext\em. Springer-Verlag, Berlin: 1987.

\bibitem[F]{fe} J.F. Fernando: Polynomial images of $\R^n$. {\em Reelle algebraische und analytische Geometrie}, March, 17$^{\rm th}$ -- 23$^{\rm rd}$ (2002), Oberwolfach.

\bibitem[F1]{f1} J.F. Fernando: On Nash images of Euclidean spaces. Submitted, arXiv:1503.07567.

\bibitem[FG]{fg} J.F. Fernando, J.M. Gamboa: Polynomial images of $\R^n$. {\em J. Pure Appl. Algebra}, {\bf179} (2003), 241--254.


\bibitem[FGU]{fgu} J.F. Fernando, J.M. Gamboa, C. Ueno: The open quadrant problem:
A topological proof.  A mathematical tribute to Professor Jos\'e Mar\'ia Montesinos. Departamento de Geometr\'ia y Topolog\'ia. Facultad de CC. Matem\'aticas UCM, pp. 337-350, (2016).

\bibitem[FU]{fu} J.F. Fernando, C. Ueno: A short proof for the open quadrant problem.
\textit{Preprint RAAG} (2014, submitted to MEGA 2015), 8 pages.

\bibitem[G]{g} J.M. Gamboa: Algebraic images of the real plane. \textit{Reelle algebraische Geometrie}, June,
$10^{\text{th}}-16^{\text{th}}$ (1990), Oberwolfach.

\bibitem[H]{h} A. Harnack: \"Uber die Vielheiligkeit der ebenen algebraischen Kurven. {\em Math. Ann.} {\bf10} (1876), 189--198.

\bibitem[P]{p} S. Pinchuk: A counterexample to the real Jacobian Conjecture, \em Math. Z.
\em {\bf 217} (1994), 1--4.

\bibitem[T]{ta} A. Tarski: A decisi\'on method for elementary algebra and geometry. Prepared for publication by J.C.C. Mac Kinsey, Berkeley: 1951.

\bibitem[U]{u} C. Ueno: Im\'agenes polin\'omicas y regulares de espacios eucl\'\i deos. {\em Ph.D. Thesis UCM} (2012).

\bibitem[W]{w} R.J. Walker: \em Algebraic curves. \em Berlin, Heidelberg, 
New York: Springer Verlag, (1978).

\bibitem[M]{m} W. Massey: A Basic Course in Algebraic Topology, \emph{Graduate Texts in Mathematics}, \textbf{\text{127}}.
Springer-Verlag, New York: 1991.

\bibitem[FU1]{fu1} J.F. Fernando, C. Ueno: On the open quadrant as a polynomial image of $\R^2$ (revisited).

\bibitem[A]{a} F. S. Acton: \textit{Numerical Methods That Work}, 2\textsuperscript{nd} printing. Washington, DC: Math. Assoc. Amer., 1990. 


\end{thebibliography}


\end{document}